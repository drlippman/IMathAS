const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./Videocued-yT-FEOMd.js","./i18n-Ci_ELIQ7.js","./Livepoll-B_jXTfak.js"])))=>i.map(i=>d[i]);
import{s as Xt,d as qt,u as ke,a as Zt,c as te,p as Ne,r as es,w as ts,h as It,n as Ke,b as At,i as Ie,_ as x,I as B,e as c,F as H,f as U,g as v,o as l,j as h,k,l as w,m as z,t as d,q,v as X,x as ie,y as ss,P as Pt,z as T,A as pe,B as se,C as L,T as Tt,D as Pe,E as St,G as ae,S as ns,M as ze,H as is,J as Je,K as Ot,L as rs,N as as,O as os,Q as ls,R as us,U as cs,V as ds}from"./i18n-Ci_ELIQ7.js";function Ku(){import.meta.url,import("_").catch(()=>1),(async function*(){})().next()}const fe=typeof document<"u";function xt(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function hs(e){return e.__esModule||e[Symbol.toStringTag]==="Module"||e.default&&xt(e.default)}const Q=Object.assign;function je(e,t){const i={};for(const r in t){const a=t[r];i[r]=ne(a)?a.map(e):e(a)}return i}const qe=()=>{},ne=Array.isArray;function ot(e,t){const i={};for(const r in e)i[r]=r in t?t[r]:e[r];return i}const $t=/#/g,fs=/&/g,ps=/\//g,ms=/=/g,_s=/\?/g,Et=/\+/g,ws=/%5B/g,gs=/%5D/g,Ct=/%5E/g,ys=/%60/g,Dt=/%7B/g,bs=/%7C/g,Rt=/%7D/g,vs=/%20/g;function Ye(e){return e==null?"":encodeURI(""+e).replace(bs,"|").replace(ws,"[").replace(gs,"]")}function ks(e){return Ye(e).replace(Dt,"{").replace(Rt,"}").replace(Ct,"^")}function Ge(e){return Ye(e).replace(Et,"%2B").replace(vs,"+").replace($t,"%23").replace(fs,"%26").replace(ys,"`").replace(Dt,"{").replace(Rt,"}").replace(Ct,"^")}function qs(e){return Ge(e).replace(ms,"%3D")}function Is(e){return Ye(e).replace($t,"%23").replace(_s,"%3F")}function As(e){return Is(e).replace(ps,"%2F")}function Ae(e){if(e==null)return null;try{return decodeURIComponent(""+e)}catch(t){}return""+e}const Ps=/\/$/,Ts=e=>e.replace(Ps,"");function Ve(e,t,i="/"){let r,a={},s="",o="";const u=t.indexOf("#");let f=t.indexOf("?");return f=u>=0&&f>u?-1:f,f>=0&&(r=t.slice(0,f),s=t.slice(f,u>0?u:t.length),a=e(s.slice(1))),u>=0&&(r=r||t.slice(0,u),o=t.slice(u,t.length)),r=$s(r!=null?r:t,i),{fullPath:r+s+o,path:r,query:a,hash:Ae(o)}}function Ss(e,t){const i=t.query?e(t.query):"";return t.path+(i&&"?")+i+(t.hash||"")}function lt(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function Os(e,t,i){const r=t.matched.length-1,a=i.matched.length-1;return r>-1&&r===a&&me(t.matched[r],i.matched[a])&&Qt(t.params,i.params)&&e(t.query)===e(i.query)&&t.hash===i.hash}function me(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function Qt(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var i in e)if(!xs(e[i],t[i]))return!1;return!0}function xs(e,t){return ne(e)?ut(e,t):ne(t)?ut(t,e):(e==null?void 0:e.valueOf())===(t==null?void 0:t.valueOf())}function ut(e,t){return ne(t)?e.length===t.length&&e.every((i,r)=>i===t[r]):e.length===1&&e[0]===t}function $s(e,t){if(e.startsWith("/"))return e;if(!e)return t;const i=t.split("/"),r=e.split("/"),a=r[r.length-1];(a===".."||a===".")&&r.push("");let s=i.length-1,o,u;for(o=0;o<r.length;o++)if(u=r[o],u!==".")if(u==="..")s>1&&s--;else break;return i.slice(0,s).join("/")+"/"+r.slice(o).join("/")}const le={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};let He=(function(e){return e.pop="pop",e.push="push",e})({}),Be=(function(e){return e.back="back",e.forward="forward",e.unknown="",e})({});function Es(e){if(!e)if(fe){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),Ts(e)}const Cs=/^[^#]+#/;function Ds(e,t){return e.replace(Cs,"#")+t}function Rs(e,t){const i=document.documentElement.getBoundingClientRect(),r=e.getBoundingClientRect();return{behavior:t.behavior,left:r.left-i.left-(t.left||0),top:r.top-i.top-(t.top||0)}}const xe=()=>({left:window.scrollX,top:window.scrollY});function Qs(e){let t;if("el"in e){const i=e.el,r=typeof i=="string"&&i.startsWith("#"),a=typeof i=="string"?r?document.getElementById(i.slice(1)):document.querySelector(i):i;if(!a)return;t=Rs(a,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function ct(e,t){return(history.state?history.state.position-t:-1)+e}const Ue=new Map;function Ls(e,t){Ue.set(e,t)}function Ms(e){const t=Ue.get(e);return Ue.delete(e),t}function Ns(e){return typeof e=="string"||e&&typeof e=="object"}function Lt(e){return typeof e=="string"||typeof e=="symbol"}let V=(function(e){return e[e.MATCHER_NOT_FOUND=1]="MATCHER_NOT_FOUND",e[e.NAVIGATION_GUARD_REDIRECT=2]="NAVIGATION_GUARD_REDIRECT",e[e.NAVIGATION_ABORTED=4]="NAVIGATION_ABORTED",e[e.NAVIGATION_CANCELLED=8]="NAVIGATION_CANCELLED",e[e.NAVIGATION_DUPLICATED=16]="NAVIGATION_DUPLICATED",e})({});const Mt=Symbol("");V.MATCHER_NOT_FOUND+"",V.NAVIGATION_GUARD_REDIRECT+"",V.NAVIGATION_ABORTED+"",V.NAVIGATION_CANCELLED+"",V.NAVIGATION_DUPLICATED+"";function _e(e,t){return Q(new Error,{type:e,[Mt]:!0},t)}function re(e,t){return e instanceof Error&&Mt in e&&(t==null||!!(e.type&t))}const js=["params","query","hash"];function Vs(e){if(typeof e=="string")return e;if(e.path!=null)return e.path;const t={};for(const i of js)i in e&&(t[i]=e[i]);return JSON.stringify(t,null,2)}function Bs(e){const t={};if(e===""||e==="?")return t;const i=(e[0]==="?"?e.slice(1):e).split("&");for(let r=0;r<i.length;++r){const a=i[r].replace(Et," "),s=a.indexOf("="),o=Ae(s<0?a:a.slice(0,s)),u=s<0?null:Ae(a.slice(s+1));if(o in t){let f=t[o];ne(f)||(f=t[o]=[f]),f.push(u)}else t[o]=u}return t}function dt(e){let t="";for(let i in e){const r=e[i];if(i=qs(i),r==null){r!==void 0&&(t+=(t.length?"&":"")+i);continue}(ne(r)?r.map(a=>a&&Ge(a)):[r&&Ge(r)]).forEach(a=>{a!==void 0&&(t+=(t.length?"&":"")+i,a!=null&&(t+="="+a))})}return t}function Fs(e){const t={};for(const i in e){const r=e[i];r!==void 0&&(t[i]=ne(r)?r.map(a=>a==null?null:""+a):r==null?r:""+r)}return t}const Gs=Symbol(""),ht=Symbol(""),Xe=Symbol(""),Nt=Symbol(""),We=Symbol("");function ve(){let e=[];function t(r){return e.push(r),()=>{const a=e.indexOf(r);a>-1&&e.splice(a,1)}}function i(){e=[]}return{add:t,list:()=>e.slice(),reset:i}}function ue(e,t,i,r,a,s=o=>o()){const o=r&&(r.enterCallbacks[a]=r.enterCallbacks[a]||[]);return()=>new Promise((u,f)=>{const _=g=>{g===!1?f(_e(V.NAVIGATION_ABORTED,{from:i,to:t})):g instanceof Error?f(g):Ns(g)?f(_e(V.NAVIGATION_GUARD_REDIRECT,{from:t,to:g})):(o&&r.enterCallbacks[a]===o&&typeof g=="function"&&o.push(g),u())},m=s(()=>e.call(r&&r.instances[a],t,i,_));let p=Promise.resolve(m);e.length<3&&(p=p.then(_)),p.catch(g=>f(g))})}function Fe(e,t,i,r,a=s=>s()){const s=[];for(const o of e)for(const u in o.components){let f=o.components[u];if(!(t!=="beforeRouteEnter"&&!o.instances[u]))if(xt(f)){const _=(f.__vccOpts||f)[t];_&&s.push(ue(_,i,r,o,u,a))}else{let _=f();s.push(()=>_.then(m=>{if(!m)throw new Error("Couldn't resolve component \"".concat(u,'" at "').concat(o.path,'"'));const p=hs(m)?m.default:m;o.mods[u]=m,o.components[u]=p;const g=(p.__vccOpts||p)[t];return g&&ue(g,i,r,o,u,a)()}))}}return s}function Hs(e,t){const i=[],r=[],a=[],s=Math.max(t.matched.length,e.matched.length);for(let o=0;o<s;o++){const u=t.matched[o];u&&(e.matched.find(_=>me(_,u))?r.push(u):i.push(u));const f=e.matched[o];f&&(t.matched.find(_=>me(_,f))||a.push(f))}return[i,r,a]}let Us=()=>location.protocol+"//"+location.host;function jt(e,t){const{pathname:i,search:r,hash:a}=t,s=e.indexOf("#");if(s>-1){let o=a.includes(e.slice(s))?e.slice(s).length:1,u=a.slice(o);return u[0]!=="/"&&(u="/"+u),lt(u,"")}return lt(i,e)+r+a}function Ws(e,t,i,r){let a=[],s=[],o=null;const u=({state:g})=>{const y=jt(e,location),O=i.value,E=t.value;let M=0;if(g){if(i.value=y,t.value=g,o&&o===O){o=null;return}M=E?g.position-E.position:0}else r(y);a.forEach(j=>{j(i.value,O,{delta:M,type:He.pop,direction:M?M>0?Be.forward:Be.back:Be.unknown})})};function f(){o=i.value}function _(g){a.push(g);const y=()=>{const O=a.indexOf(g);O>-1&&a.splice(O,1)};return s.push(y),y}function m(){if(document.visibilityState==="hidden"){const{history:g}=window;if(!g.state)return;g.replaceState(Q({},g.state,{scroll:xe()}),"")}}function p(){for(const g of s)g();s=[],window.removeEventListener("popstate",u),window.removeEventListener("pagehide",m),document.removeEventListener("visibilitychange",m)}return window.addEventListener("popstate",u),window.addEventListener("pagehide",m),document.addEventListener("visibilitychange",m),{pauseListeners:f,listen:_,destroy:p}}function ft(e,t,i,r=!1,a=!1){return{back:e,current:t,forward:i,replaced:r,position:window.history.length,scroll:a?xe():null}}function Ks(e){const{history:t,location:i}=window,r={value:jt(e,i)},a={value:t.state};a.value||s(r.value,{back:null,current:r.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function s(f,_,m){const p=e.indexOf("#"),g=p>-1?(i.host&&document.querySelector("base")?e:e.slice(p))+f:Us()+e+f;try{t[m?"replaceState":"pushState"](_,"",g),a.value=_}catch(y){console.error(y),i[m?"replace":"assign"](g)}}function o(f,_){s(f,Q({},t.state,ft(a.value.back,f,a.value.forward,!0),_,{position:a.value.position}),!0),r.value=f}function u(f,_){const m=Q({},a.value,t.state,{forward:f,scroll:xe()});s(m.current,m,!0),s(f,Q({},ft(r.value,f,null),{position:m.position+1},_),!1),r.value=f}return{location:r,state:a,push:u,replace:o}}function zs(e){e=Es(e);const t=Ks(e),i=Ws(e,t.state,t.location,t.replace);function r(s,o=!0){o||i.pauseListeners(),history.go(s)}const a=Q({location:"",base:e,go:r,createHref:Ds.bind(null,e)},t,i);return Object.defineProperty(a,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(a,"state",{enumerable:!0,get:()=>t.state.value}),a}function Js(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),zs(e)}let de=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.Group=2]="Group",e})({});var K=(function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.ParamRegExp=2]="ParamRegExp",e[e.ParamRegExpEnd=3]="ParamRegExpEnd",e[e.EscapeNext=4]="EscapeNext",e})(K||{});const Ys={type:de.Static,value:""},Xs=/[a-zA-Z0-9_]/;function Zs(e){if(!e)return[[]];if(e==="/")return[[Ys]];if(!e.startsWith("/"))throw new Error('Invalid path "'.concat(e,'"'));function t(y){throw new Error("ERR (".concat(i,')/"').concat(_,'": ').concat(y))}let i=K.Static,r=i;const a=[];let s;function o(){s&&a.push(s),s=[]}let u=0,f,_="",m="";function p(){_&&(i===K.Static?s.push({type:de.Static,value:_}):i===K.Param||i===K.ParamRegExp||i===K.ParamRegExpEnd?(s.length>1&&(f==="*"||f==="+")&&t("A repeatable param (".concat(_,") must be alone in its segment. eg: '/:ids+.")),s.push({type:de.Param,value:_,regexp:m,repeatable:f==="*"||f==="+",optional:f==="*"||f==="?"})):t("Invalid state to consume buffer"),_="")}function g(){_+=f}for(;u<e.length;){if(f=e[u++],f==="\\"&&i!==K.ParamRegExp){r=i,i=K.EscapeNext;continue}switch(i){case K.Static:f==="/"?(_&&p(),o()):f===":"?(p(),i=K.Param):g();break;case K.EscapeNext:g(),i=r;break;case K.Param:f==="("?i=K.ParamRegExp:Xs.test(f)?g():(p(),i=K.Static,f!=="*"&&f!=="?"&&f!=="+"&&u--);break;case K.ParamRegExp:f===")"?m[m.length-1]=="\\"?m=m.slice(0,-1)+f:i=K.ParamRegExpEnd:m+=f;break;case K.ParamRegExpEnd:p(),i=K.Static,f!=="*"&&f!=="?"&&f!=="+"&&u--,m="";break;default:t("Unknown state");break}}return i===K.ParamRegExp&&t('Unfinished custom RegExp for param "'.concat(_,'"')),p(),o(),a}const pt="[^/]+?",en={sensitive:!1,strict:!1,start:!0,end:!0};var J=(function(e){return e[e._multiplier=10]="_multiplier",e[e.Root=90]="Root",e[e.Segment=40]="Segment",e[e.SubSegment=30]="SubSegment",e[e.Static=40]="Static",e[e.Dynamic=20]="Dynamic",e[e.BonusCustomRegExp=10]="BonusCustomRegExp",e[e.BonusWildcard=-50]="BonusWildcard",e[e.BonusRepeatable=-20]="BonusRepeatable",e[e.BonusOptional=-8]="BonusOptional",e[e.BonusStrict=.7000000000000001]="BonusStrict",e[e.BonusCaseSensitive=.25]="BonusCaseSensitive",e})(J||{});const tn=/[.+*?^${}()[\]/\\]/g;function sn(e,t){const i=Q({},en,t),r=[];let a=i.start?"^":"";const s=[];for(const _ of e){const m=_.length?[]:[J.Root];i.strict&&!_.length&&(a+="/");for(let p=0;p<_.length;p++){const g=_[p];let y=J.Segment+(i.sensitive?J.BonusCaseSensitive:0);if(g.type===de.Static)p||(a+="/"),a+=g.value.replace(tn,"\\$&"),y+=J.Static;else if(g.type===de.Param){const{value:O,repeatable:E,optional:M,regexp:j}=g;s.push({name:O,repeatable:E,optional:M});const R=j||pt;if(R!==pt){y+=J.BonusCustomRegExp;try{"".concat(R)}catch(ee){throw new Error('Invalid custom RegExp for param "'.concat(O,'" (').concat(R,"): ")+ee.message)}}let N=E?"((?:".concat(R,")(?:/(?:").concat(R,"))*)"):"(".concat(R,")");p||(N=M&&_.length<2?"(?:/".concat(N,")"):"/"+N),M&&(N+="?"),a+=N,y+=J.Dynamic,M&&(y+=J.BonusOptional),E&&(y+=J.BonusRepeatable),R===".*"&&(y+=J.BonusWildcard)}m.push(y)}r.push(m)}if(i.strict&&i.end){const _=r.length-1;r[_][r[_].length-1]+=J.BonusStrict}i.strict||(a+="/?"),i.end?a+="$":i.strict&&!a.endsWith("/")&&(a+="(?:/|$)");const o=new RegExp(a,i.sensitive?"":"i");function u(_){const m=_.match(o),p={};if(!m)return null;for(let g=1;g<m.length;g++){const y=m[g]||"",O=s[g-1];p[O.name]=y&&O.repeatable?y.split("/"):y}return p}function f(_){let m="",p=!1;for(const g of e){(!p||!m.endsWith("/"))&&(m+="/"),p=!1;for(const y of g)if(y.type===de.Static)m+=y.value;else if(y.type===de.Param){const{value:O,repeatable:E,optional:M}=y,j=O in _?_[O]:"";if(ne(j)&&!E)throw new Error('Provided param "'.concat(O,'" is an array but it is not repeatable (* or + modifiers)'));const R=ne(j)?j.join("/"):j;if(!R)if(M)g.length<2&&(m.endsWith("/")?m=m.slice(0,-1):p=!0);else throw new Error('Missing required param "'.concat(O,'"'));m+=R}}return m||"/"}return{re:o,score:r,keys:s,parse:u,stringify:f}}function nn(e,t){let i=0;for(;i<e.length&&i<t.length;){const r=t[i]-e[i];if(r)return r;i++}return e.length<t.length?e.length===1&&e[0]===J.Static+J.Segment?-1:1:e.length>t.length?t.length===1&&t[0]===J.Static+J.Segment?1:-1:0}function Vt(e,t){let i=0;const r=e.score,a=t.score;for(;i<r.length&&i<a.length;){const s=nn(r[i],a[i]);if(s)return s;i++}if(Math.abs(a.length-r.length)===1){if(mt(r))return 1;if(mt(a))return-1}return a.length-r.length}function mt(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const rn={strict:!1,end:!0,sensitive:!1};function an(e,t,i){const r=sn(Zs(e.path),i),a=Q(r,{record:e,parent:t,children:[],alias:[]});return t&&!a.record.aliasOf==!t.record.aliasOf&&t.children.push(a),a}function on(e,t){const i=[],r=new Map;t=ot(rn,t);function a(p){return r.get(p)}function s(p,g,y){const O=!y,E=wt(p);E.aliasOf=y&&y.record;const M=ot(t,p),j=[E];if("alias"in p){const ee=typeof p.alias=="string"?[p.alias]:p.alias;for(const ce of ee)j.push(wt(Q({},E,{components:y?y.record.components:E.components,path:ce,aliasOf:y?y.record:E})))}let R,N;for(const ee of j){const{path:ce}=ee;if(g&&ce[0]!=="/"){const oe=g.record.path,Z=oe[oe.length-1]==="/"?"":"/";ee.path=g.record.path+(ce&&Z+ce)}if(R=an(ee,g,M),y?y.alias.push(R):(N=N||R,N!==R&&N.alias.push(R),O&&p.name&&!gt(R)&&o(p.name)),Bt(R)&&f(R),E.children){const oe=E.children;for(let Z=0;Z<oe.length;Z++)s(oe[Z],R,y&&y.children[Z])}y=y||R}return N?()=>{o(N)}:qe}function o(p){if(Lt(p)){const g=r.get(p);g&&(r.delete(p),i.splice(i.indexOf(g),1),g.children.forEach(o),g.alias.forEach(o))}else{const g=i.indexOf(p);g>-1&&(i.splice(g,1),p.record.name&&r.delete(p.record.name),p.children.forEach(o),p.alias.forEach(o))}}function u(){return i}function f(p){const g=cn(p,i);i.splice(g,0,p),p.record.name&&!gt(p)&&r.set(p.record.name,p)}function _(p,g){let y,O={},E,M;if("name"in p&&p.name){if(y=r.get(p.name),!y)throw _e(V.MATCHER_NOT_FOUND,{location:p});M=y.record.name,O=Q(_t(g.params,y.keys.filter(N=>!N.optional).concat(y.parent?y.parent.keys.filter(N=>N.optional):[]).map(N=>N.name)),p.params&&_t(p.params,y.keys.map(N=>N.name))),E=y.stringify(O)}else if(p.path!=null)E=p.path,y=i.find(N=>N.re.test(E)),y&&(O=y.parse(E),M=y.record.name);else{if(y=g.name?r.get(g.name):i.find(N=>N.re.test(g.path)),!y)throw _e(V.MATCHER_NOT_FOUND,{location:p,currentLocation:g});M=y.record.name,O=Q({},g.params,p.params),E=y.stringify(O)}const j=[];let R=y;for(;R;)j.unshift(R.record),R=R.parent;return{name:M,path:E,params:O,matched:j,meta:un(j)}}e.forEach(p=>s(p));function m(){i.length=0,r.clear()}return{addRoute:s,resolve:_,removeRoute:o,clearRoutes:m,getRoutes:u,getRecordMatcher:a}}function _t(e,t){const i={};for(const r of t)r in e&&(i[r]=e[r]);return i}function wt(e){const t={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:ln(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function ln(e){const t={},i=e.props||!1;if("component"in e)t.default=i;else for(const r in e.components)t[r]=typeof i=="object"?i[r]:i;return t}function gt(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function un(e){return e.reduce((t,i)=>Q(t,i.meta),{})}function cn(e,t){let i=0,r=t.length;for(;i!==r;){const s=i+r>>1;Vt(e,t[s])<0?r=s:i=s+1}const a=dn(e);return a&&(r=t.lastIndexOf(a,r-1)),r}function dn(e){let t=e;for(;t=t.parent;)if(Bt(t)&&Vt(e,t)===0)return t}function Bt({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function yt(e){const t=Ie(Xe),i=Ie(Nt),r=te(()=>{const f=ke(e.to);return t.resolve(f)}),a=te(()=>{const{matched:f}=r.value,{length:_}=f,m=f[_-1],p=i.matched;if(!m||!p.length)return-1;const g=p.findIndex(me.bind(null,m));if(g>-1)return g;const y=bt(f[_-2]);return _>1&&bt(m)===y&&p[p.length-1].path!==y?p.findIndex(me.bind(null,f[_-2])):g}),s=te(()=>a.value>-1&&_n(i.params,r.value.params)),o=te(()=>a.value>-1&&a.value===i.matched.length-1&&Qt(i.params,r.value.params));function u(f={}){if(mn(f)){const _=t[ke(e.replace)?"replace":"push"](ke(e.to)).catch(qe);return e.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>_),_}return Promise.resolve()}return{route:r,href:te(()=>r.value.href),isActive:s,isExactActive:o,navigate:u}}function hn(e){return e.length===1?e[0]:e}const fn=qt({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:yt,setup(e,{slots:t}){const i=At(yt(e)),{options:r}=Ie(Xe),a=te(()=>({[vt(e.activeClass,r.linkActiveClass,"router-link-active")]:i.isActive,[vt(e.exactActiveClass,r.linkExactActiveClass,"router-link-exact-active")]:i.isExactActive}));return()=>{const s=t.default&&hn(t.default(i));return e.custom?s:It("a",{"aria-current":i.isExactActive?e.ariaCurrentValue:null,href:i.href,onClick:i.navigate,class:a.value},s)}}}),pn=fn;function mn(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function _n(e,t){for(const i in t){const r=t[i],a=e[i];if(typeof r=="string"){if(r!==a)return!1}else if(!ne(a)||a.length!==r.length||r.some((s,o)=>s.valueOf()!==a[o].valueOf()))return!1}return!0}function bt(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const vt=(e,t,i)=>e!=null?e:t!=null?t:i,wn=qt({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:i}){const r=Ie(We),a=te(()=>e.route||r.value),s=Ie(ht,0),o=te(()=>{let _=ke(s);const{matched:m}=a.value;let p;for(;(p=m[_])&&!p.components;)_++;return _}),u=te(()=>a.value.matched[o.value]);Ne(ht,te(()=>o.value+1)),Ne(Gs,u),Ne(We,a);const f=es();return ts(()=>[f.value,u.value,e.name],([_,m,p],[g,y,O])=>{m&&(m.instances[p]=_,y&&y!==m&&_&&_===g&&(m.leaveGuards.size||(m.leaveGuards=y.leaveGuards),m.updateGuards.size||(m.updateGuards=y.updateGuards))),_&&m&&(!y||!me(m,y)||!g)&&(m.enterCallbacks[p]||[]).forEach(E=>E(_))},{flush:"post"}),()=>{const _=a.value,m=e.name,p=u.value,g=p&&p.components[m];if(!g)return kt(i.default,{Component:g,route:_});const y=p.props[m],O=y?y===!0?_.params:typeof y=="function"?y(_):y:null,M=It(g,Q({},O,t,{onVnodeUnmounted:j=>{j.component.isUnmounted&&(p.instances[m]=null)},ref:f}));return kt(i.default,{Component:M,route:_})||M}}});function kt(e,t){if(!e)return null;const i=e(t);return i.length===1?i[0]:i}const gn=wn;function yn(e){const t=on(e.routes,e),i=e.parseQuery||Bs,r=e.stringifyQuery||dt,a=e.history,s=ve(),o=ve(),u=ve(),f=Xt(le);let _=le;fe&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const m=je.bind(null,b=>""+b),p=je.bind(null,As),g=je.bind(null,Ae);function y(b,P){let I,S;return Lt(b)?(I=t.getRecordMatcher(b),S=P):S=b,t.addRoute(S,I)}function O(b){const P=t.getRecordMatcher(b);P&&t.removeRoute(P)}function E(){return t.getRoutes().map(b=>b.record)}function M(b){return!!t.getRecordMatcher(b)}function j(b,P){if(P=Q({},P||f.value),typeof b=="string"){const $=Ve(i,b,P.path),W=t.resolve({path:$.path},P),be=a.createHref($.fullPath);return Q($,W,{params:g(W.params),hash:Ae($.hash),redirectedFrom:void 0,href:be})}let I;if(b.path!=null)I=Q({},b,{path:Ve(i,b.path,P.path).path});else{const $=Q({},b.params);for(const W in $)$[W]==null&&delete $[W];I=Q({},b,{params:p($)}),P.params=p(P.params)}const S=t.resolve(I,P),D=b.hash||"";S.params=m(g(S.params));const F=Ss(r,Q({},b,{hash:ks(D),path:S.path})),C=a.createHref(F);return Q({fullPath:F,hash:D,query:r===dt?Fs(b.query):b.query||{}},S,{redirectedFrom:void 0,href:C})}function R(b){return typeof b=="string"?Ve(i,b,f.value.path):Q({},b)}function N(b,P){if(_!==b)return _e(V.NAVIGATION_CANCELLED,{from:P,to:b})}function ee(b){return Z(b)}function ce(b){return ee(Q(R(b),{replace:!0}))}function oe(b,P){const I=b.matched[b.matched.length-1];if(I&&I.redirect){const{redirect:S}=I;let D=typeof S=="function"?S(b,P):S;return typeof D=="string"&&(D=D.includes("?")||D.includes("#")?D=R(D):{path:D},D.params={}),Q({query:b.query,hash:b.hash,params:D.path!=null?{}:b.params},D)}}function Z(b,P){const I=_=j(b),S=f.value,D=b.state,F=b.force,C=b.replace===!0,$=oe(I,S);if($)return Z(Q(R($),{state:typeof $=="object"?Q({},D,$.state):D,force:F,replace:C}),P||I);const W=I;W.redirectedFrom=P;let be;return!F&&Os(r,S,I)&&(be=_e(V.NAVIGATION_DUPLICATED,{to:W,from:S}),at(S,S,!0,!1)),(be?Promise.resolve(be):st(W,S)).catch(Y=>re(Y)?re(Y,V.NAVIGATION_GUARD_REDIRECT)?Y:Qe(Y):Re(Y,W,S)).then(Y=>{if(Y){if(re(Y,V.NAVIGATION_GUARD_REDIRECT))return Z(Q({replace:C},R(Y.to),{state:typeof Y.to=="object"?Q({},D,Y.to.state):D,force:F}),P||W)}else Y=it(W,S,!0,C,D);return nt(W,S,Y),Y})}function zt(b,P){const I=N(b,P);return I?Promise.reject(I):Promise.resolve()}function Ce(b){const P=Oe.values().next().value;return P&&typeof P.runWithContext=="function"?P.runWithContext(b):b()}function st(b,P){let I;const[S,D,F]=Hs(b,P);I=Fe(S.reverse(),"beforeRouteLeave",b,P);for(const $ of S)$.leaveGuards.forEach(W=>{I.push(ue(W,b,P))});const C=zt.bind(null,b,P);return I.push(C),he(I).then(()=>{I=[];for(const $ of s.list())I.push(ue($,b,P));return I.push(C),he(I)}).then(()=>{I=Fe(D,"beforeRouteUpdate",b,P);for(const $ of D)$.updateGuards.forEach(W=>{I.push(ue(W,b,P))});return I.push(C),he(I)}).then(()=>{I=[];for(const $ of F)if($.beforeEnter)if(ne($.beforeEnter))for(const W of $.beforeEnter)I.push(ue(W,b,P));else I.push(ue($.beforeEnter,b,P));return I.push(C),he(I)}).then(()=>(b.matched.forEach($=>$.enterCallbacks={}),I=Fe(F,"beforeRouteEnter",b,P,Ce),I.push(C),he(I))).then(()=>{I=[];for(const $ of o.list())I.push(ue($,b,P));return I.push(C),he(I)}).catch($=>re($,V.NAVIGATION_CANCELLED)?$:Promise.reject($))}function nt(b,P,I){u.list().forEach(S=>Ce(()=>S(b,P,I)))}function it(b,P,I,S,D){const F=N(b,P);if(F)return F;const C=P===le,$=fe?history.state:{};I&&(S||C?a.replace(b.fullPath,Q({scroll:C&&$&&$.scroll},D)):a.push(b.fullPath,D)),f.value=b,at(b,P,I,C),Qe()}let ge;function Jt(){ge||(ge=a.listen((b,P,I)=>{if(!ye.listening)return;const S=j(b),D=oe(S,ye.currentRoute.value);if(D){Z(Q(D,{replace:!0,force:!0}),S).catch(qe);return}_=S;const F=f.value;fe&&Ls(ct(F.fullPath,I.delta),xe()),st(S,F).catch(C=>re(C,V.NAVIGATION_ABORTED|V.NAVIGATION_CANCELLED)?C:re(C,V.NAVIGATION_GUARD_REDIRECT)?(Z(Q(R(C.to),{force:!0}),S).then($=>{re($,V.NAVIGATION_ABORTED|V.NAVIGATION_DUPLICATED)&&!I.delta&&I.type===He.pop&&a.go(-1,!1)}).catch(qe),Promise.reject()):(I.delta&&a.go(-I.delta,!1),Re(C,S,F))).then(C=>{C=C||it(S,F,!1),C&&(I.delta&&!re(C,V.NAVIGATION_CANCELLED)?a.go(-I.delta,!1):I.type===He.pop&&re(C,V.NAVIGATION_ABORTED|V.NAVIGATION_DUPLICATED)&&a.go(-1,!1)),nt(S,F,C)}).catch(qe)}))}let De=ve(),rt=ve(),Se;function Re(b,P,I){Qe(b);const S=rt.list();return S.length?S.forEach(D=>D(b,P,I)):console.error(b),Promise.reject(b)}function Yt(){return Se&&f.value!==le?Promise.resolve():new Promise((b,P)=>{De.add([b,P])})}function Qe(b){return Se||(Se=!b,Jt(),De.list().forEach(([P,I])=>b?I(b):P()),De.reset()),b}function at(b,P,I,S){const{scrollBehavior:D}=e;if(!fe||!D)return Promise.resolve();const F=!I&&Ms(ct(b.fullPath,0))||(S||!I)&&history.state&&history.state.scroll||null;return Ke().then(()=>D(b,P,F)).then(C=>C&&Qs(C)).catch(C=>Re(C,b,P))}const Le=b=>a.go(b);let Me;const Oe=new Set,ye={currentRoute:f,listening:!0,addRoute:y,removeRoute:O,clearRoutes:t.clearRoutes,hasRoute:M,getRoutes:E,resolve:j,options:e,push:ee,replace:ce,go:Le,back:()=>Le(-1),forward:()=>Le(1),beforeEach:s.add,beforeResolve:o.add,afterEach:u.add,onError:rt.add,isReady:Yt,install(b){b.component("RouterLink",pn),b.component("RouterView",gn),b.config.globalProperties.$router=ye,Object.defineProperty(b.config.globalProperties,"$route",{enumerable:!0,get:()=>ke(f)}),fe&&!Me&&f.value===le&&(Me=!0,ee(a.location).catch(S=>{}));const P={};for(const S in le)Object.defineProperty(P,S,{get:()=>f.value[S],enumerable:!0});b.provide(Xe,ye),b.provide(Nt,Zt(P)),b.provide(We,f);const I=b.unmount;Oe.add(b),b.unmount=function(){Oe.delete(b),Oe.size<1&&(_=le,ge&&ge(),ge=null,f.value=le,Me=!1,Se=!1),I()}}};function he(b){return b.reduce((P,I)=>P.then(()=>Ce(I)),Promise.resolve())}return ye}const bn={name:"SettingsList",components:{Icons:B},data:function(){return{now:new Date}},computed:{settingRows(){var e=[],t=n.assessInfo;return t.in_practice?e.push({icon:"alert",str:this.$t("setlist.practice")}):(e.push(this.getPointsObj()),t.enddate<2e9&&e.push(this.getDateObj()),t.submitby==="by_assessment"&&t.allowed_attempts>1&&e.push(this.getAttemptsObj()),t.timelimit>0&&e.push(this.getTimelimitObj())),e}},methods:{getPointsObj(){var e=n.assessInfo,t={icon:"square-check",str:this.$t("setlist.points_possible",{pts:e.points_possible})};return n.assessInfo.hasOwnProperty("excused")&&(t.alert=this.$t("setlist.excused")),t},getDateObj(){var e=n.assessInfo,t=e.enddate_disp,i={icon:"calendar",str:this.$t("setlist.due_at",{date:t})};if(e.hasOwnProperty("original_enddate")){var r=e.original_enddate_disp;if(i.sub=this.$t("setlist.originally_due",{date:r}),e.extended_with.type==="latepass"?i.sub+=" "+this.$t("setlist.latepass_used",e.extended_with.n):i.sub+=" "+this.$t("setlist.extension"),e.exceptionpenalty>0){const a=new Date().getTime();e.original_enddate*1e3>a?i.alert2=this.$t("setlist.penalty_after",{p:e.exceptionpenalty,date:e.original_enddate_disp}):i.alert2=this.$t("setlist.penalty",{p:e.exceptionpenalty})}}return e.hasOwnProperty("earlybonusends")&&(i.alert=this.$t("setlist.earlybonus",{p:e.earlybonus[0],date:e.earlybonusends_disp})),e.can_use_latepass>0&&(i.latepass=this.$t("setlist.latepass_needed",e.can_use_latepass,{n:e.can_use_latepass,date:e.latepass_extendto_disp}),i.latepass_label=this.$t("closed.use_latepass",e.can_use_latepass)),i},getAttemptsObj(){var e=n.assessInfo,t,i,r,a,s=e.allowed_attempts-e.prev_attempts.length;let o="";e.hasOwnProperty("attemptext")&&(e.prev_attempts.length===0?o=this.$t("setlist.take",s):o=this.$t("setlist.take_more",s),s=Math.max(0,s-e.attemptext)),e.prev_attempts.length===0?i=this.$t("setlist.take",s):i=this.$t("setlist.take_more",s),e.has_active_attempt?(t=this.$t("setlist.attempt_inprogress"),r=this.$t("setlist.cur_attempt_n_of",{n:e.prev_attempts.length+1,nmax:e.allowed_attempts})):(t=i,r=""),e.keepscore==="best"?r+=this.$t("setlist.keep_highest"):e.keepscore==="average"?r+=this.$t("setlist.keep_average"):e.keepscore==="last"&&(r+=this.$t("setlist.keep_last"));const u=e.prev_attempts.length+1;if(u>e.retake_penalty.n&&e.retake_penalty.penalty>0){const f=e.retake_penalty.penalty*(u-e.retake_penalty.n);a=this.$t("setlist.retake_penalty",{p:f})}return{icon:"retake",str:t,altstr:o,sub:r,alert:a}},getTimelimitObj(){var e=n.assessInfo,t={icon:"timer"};if(e.has_active_attempt&&e.timelimit_ext&&e.timelimit_ext<0)t.str=this.$t("setlist.timelimit_ext_used",{n:Math.abs(e.timelimit_ext)});else{var i=e.timelimit*e.timelimit_multiplier;e.overtime_grace>0?t.str=this.$t(e.overtime_penalty>0?"setlist.timelimit_wgrace_penalty":"setlist.timelimit_wgrace",{time:this.formatTimeLimit(i),grace:this.formatTimeLimit(e.overtime_grace*e.timelimit_multiplier),penalty:e.overtime_penalty}):t.str=this.$t("setlist.timelimit",{time:this.formatTimeLimit(i)}),n.timelimit_restricted===1?t.altstr=this.$t("setlist.timelimit_restricted",{due:e.enddate_disp}):n.timelimit_restricted===2&&(t.altstr=this.$t(e.overtime_penalty>0?"setlist.timelimit_wgrace_restricted_penalty":"setlist.timelimit_wgrace_restricted",{time:this.formatTimeLimit(i),due:e.enddate_disp,penalty:e.overtime_penalty})),e.timelimit_multiplier>1&&(t.sub=this.$t("setlist.timelimit_extend",{time:this.formatTimeLimit(e.timelimit)}))}if(e.has_active_attempt)if(n.timelimit_expired)n.timelimit_grace_expired?e.timelimit_ext&&e.timelimit_ext>0&&(t.str=this.$t("setlist.timelimit_ext",{n:e.timelimit_ext})):t.alert=this.$t("setlist.time_grace_expires",{date:e.timelimit_expires_disp,grace:e.timelimit_grace_disp});else{const r=e.timelimit_expires_disp;e.overtime_grace>0&&e.timelimit_grace>e.timelimit_expires?t.alert=this.$t("setlist.time_expires_wgrace",{date:r,grace:e.timelimit_grace_disp}):t.alert=this.$t("setlist.time_expires",{date:r})}else e.timelimit_ext&&e.timelimit_ext>0&&(t.alert=this.$t("setlist.timelimit_ext",{n:e.timelimit_ext}));return t},formatTimeLimit(e){const t=Math.floor(e/3600),i=Math.floor(e/60)-t*60,r=e-60*i-3600*t;let a="";return t>0&&(a+=this.$t("hours",t)),i>0&&(a!==""&&(a+=" "),a+=this.$t("minutes",i)),r>0&&(a!==""&&(a+=" "),a+=this.$t("seconds",r)),a},redeemLatePass(){var e=n.assessInfo;n.confirmObj={body:this.$t("closed.latepassn",e.latepasses_avail)+" "+this.$t("setlist.latepass_needed",e.can_use_latepass,{n:e.can_use_latepass,date:e.latepass_extendto_disp}),ok:this.$t("closed.use_latepass",e.can_use_latepass),action:()=>A.redeemLatePass()}}}},vn={class:"settings-list"},kn={key:0,class:"noticetext"},qn={key:1,class:"small subdued"},In={key:2,class:"small subdued"},An={key:3,class:"small subdued"},Pn={key:4,class:"small subdued"};function Tn(e,t,i,r,a,s){const o=v("icons");return l(),c("div",vn,[(l(!0),c(H,null,U(s.settingRows,(u,f)=>(l(),c("div",{class:"flexrow",key:f},[h("div",null,[k(o,{name:u.icon,size:"small"},null,8,["name"])]),h("div",null,[h("div",{class:z({strikethrough:!!u.altstr})},d(u.str),3),u.altstr?(l(),c("div",kn,d(u.altstr),1)):w("",!0),u.sub?(l(),c("div",qn,d(u.sub),1)):w("",!0),u.alert?(l(),c("div",In,[k(o,{name:"alert",size:"micro"}),q(" "+d(u.alert),1)])):w("",!0),u.alert2?(l(),c("div",An,[k(o,{name:"alert",size:"micro"}),q(" "+d(u.alert2),1)])):w("",!0),u.latepass?(l(),c("div",Pn,[q(d(u.latepass)+" ",1),h("button",{onClick:t[0]||(t[0]=(..._)=>s.redeemLatePass&&s.redeemLatePass(..._)),class:"slim secondary"},d(u.latepass_label),1)])):w("",!0)])]))),128))])}const Sn=x(bn,[["render",Tn]]),On={name:"PasswordEntry",props:["modelValue"],methods:{handleInput(e){this.$emit("update:modelValue",e.target.value)},handleEnter(e){e.preventDefault(),e.stopPropagation(),this.$emit("onenter")}}},xn={for:"password"},$n=["value"];function En(e,t,i,r,a,s){return l(),c("div",null,[h("label",xn,d(e.$t("password.label")),1),h("input",{value:i.modelValue,id:"password",name:"password",type:"password",autocomplete:"off",onInput:t[0]||(t[0]=(...o)=>s.handleInput&&s.handleInput(...o)),onKeydown:t[1]||(t[1]=X((...o)=>s.handleEnter&&s.handleEnter(...o),["enter"]))},null,40,$n)])}const Cn=x(On,[["render",En]]),Dn={name:"GroupEntry",data:function(){return{newMember:0,newGroupMembers:[]}},computed:{groupMax(){return n.assessInfo.groupmax},groupMembers(){var e=[];if(!n.assessInfo.hasOwnProperty("group_members"))return e;for(let t=0;t<n.assessInfo.group_members.length;t++)e.push({name:n.assessInfo.group_members[t],new:!1});for(let t=0;t<this.newGroupMembers.length;t++)e.push({name:n.assessInfo.group_avail[this.newGroupMembers[t]],new:!0,index:t});return e},availableUsers(){var e=[];for(const t in n.assessInfo.group_avail)this.newGroupMembers.indexOf(t)===-1&&e.push({id:t,name:n.assessInfo.group_avail[t]});return e},showMax(){return n.assessInfo.isgroup===2},canAddMembers(){return!this.canViewAll&&n.assessInfo.isgroup===2&&this.groupMembers.length<n.assessInfo.groupmax},isPresetGroups(){return n.assessInfo.isgroup===3},canViewAll(){return n.assessInfo.can_view_all},teacherNote(){return this.isPresetGroups?this.$t("group.teacher_preset"):this.$t("group.teacher_auto",{n:n.assessInfo.groupmax})}},methods:{removeMember(e){this.newGroupMembers.splice(e,1),this.handleChange()},addMember(){this.newMember>0&&(this.newGroupMembers.push(this.newMember),this.newMember=0,this.handleChange())},handleChange(){this.$emit("update-new-group",this.newGroupMembers)}}},Rn={key:0},Qn={key:1},Ln={key:0},Mn={class:"no-margin-top"},Nn=["onClick"],jn={key:2},Vn={key:3},Bn={for:"addtogroup"},Fn={value:"0"},Gn=["value"];function Hn(e,t,i,r,a,s){return l(),c("div",null,[h("div",null,d(e.$t("group.isgroup")),1),s.canViewAll?(l(),c("div",Rn,d(s.teacherNote),1)):s.groupMembers.length>0?(l(),c("div",Qn,[q(d(e.$t("group.members"))+" ",1),s.showMax?(l(),c("span",Ln," ("+d(e.$t("group.max",{n:s.groupMax}))+") ",1)):w("",!0),h("ul",Mn,[(l(!0),c(H,null,U(s.groupMembers,(o,u)=>(l(),c("li",{key:u},[q(d(o.name)+" ",1),o.new?(l(),c("button",{key:0,class:"plain slim subdued",tabindex:"0",onClick:f=>s.removeMember(o.index)},d(e.$t("group.remove")),9,Nn)):w("",!0)]))),128))])])):s.isPresetGroups?(l(),c("div",jn,d(e.$t("group.needpreset")),1)):w("",!0),s.canAddMembers?(l(),c("div",Vn,[h("label",Bn,d(e.$t("group.add")),1),ie(h("select",{"onUpdate:modelValue":t[0]||(t[0]=o=>e.newMember=o),id:"addtogroup"},[h("option",Fn,d(e.$t("group.select")),1),(l(!0),c(H,null,U(s.availableUsers,o=>(l(),c("option",{value:o.id,key:o.id},d(o.name),9,Gn))),128))],512),[[ss,e.newMember]]),h("button",{class:"slim",onClick:t[1]||(t[1]=(...o)=>s.addMember&&s.addMember(...o))},d(e.$t("group.addbutton")),1)])):w("",!0)])}const Un=x(Dn,[["render",Hn]]),Wn={name:"PreviousAttempts",props:["caption"],computed:{prevAttempts(){return n.assessInfo.prev_attempts},totPoss(){return n.assessInfo.points_possible},ainfo(){return n.assessInfo},showGbLink(){const e=n.assessInfo.viewingb;return(e==="immediately"||e==="after_take")&&this.prevAttempts.length>0&&!n.assessInfo.can_view_all},gbUrl(){let e="gbviewassess.php?";return e+="cid="+n.cid,e+="&aid="+n.aid,e+="&uid="+n.uid,e}}},Kn={class:"pane-body"},zn={class:"scorelist med-below"},Jn={key:0},Yn={key:0,class:"med-left"},Xn={key:0},Zn=["href"];function ei(e,t,i,r,a,s){return l(),c("div",Kn,[h("table",zn,[h("caption",null,d(i.caption),1),h("thead",null,[h("tr",null,[h("th",null,d(e.$t("prev.date")),1),s.prevAttempts[0].hasOwnProperty("score")?(l(),c("th",Jn,d(e.$t("prev.score")),1)):w("",!0)])]),h("tbody",null,[(l(!0),c(H,null,U(s.prevAttempts,(o,u)=>(l(),c("tr",{key:u},[h("td",null,d(o.date),1),o.hasOwnProperty("score")?(l(),c("td",Yn,d(Math.round(1e3*o.score/s.totPoss)/10)+"% ",1)):w("",!0)]))),128))])]),s.showGbLink?(l(),c("p",Xn,[h("a",{href:s.gbUrl},d(e.$t("prev.viewingb")),9,Zn)])):w("",!0)])}const Ze=x(Wn,[["render",ei]]),ti={name:"SummaryGbScore",computed:{ainfo(){return n.assessInfo},scoreUsed(){return this.ainfo.scored_attempt.kept==="override"?this.$t("summary.use_override"):this.ainfo.keepscore==="best"&&this.ainfo.submitby==="by_assessment"?this.$t("setlist.keep_highest"):this.ainfo.keepscore==="best"&&this.ainfo.submitby==="by_question"?this.$t("setlist.keep_highest_q"):this.ainfo.keepscore==="average"?this.$t("setlist.keep_average"):this.ainfo.keepscore==="last"?this.$t("setlist.keep_last"):""},showGBScore(){return this.ainfo.hasOwnProperty("scored_attempt")&&this.ainfo.scored_attempt.hasOwnProperty("score")&&this.ainfo.showscores!=="none"},gbScore(){return Math.round(1e3*this.ainfo.scored_attempt.score/this.ainfo.points_possible)/10}}},si={key:0,class:"pane-header"},ni={class:"small subdued"};function ii(e,t,i,r,a,s){return s.showGBScore?(l(),c("div",si,[h("strong",null,d(e.$t("summary.recordedscore"))+": "+d(s.gbScore)+"%",1),t[0]||(t[0]=h("br",null,null,-1)),h("span",ni,d(s.scoreUsed),1)])):w("",!0)}const et=x(ti,[["render",ii]]),ri={name:"Launch",components:{SettingsList:Sn,PasswordEntry:Cn,GroupEntry:Un,SummaryGbScore:et,PreviousAttempts:Ze,Icons:B},data:function(){return{password:"",newGroupMembers:[]}},computed:{aInfo(){return n.assessInfo},errorMsg(){return n.errorMsg===null?null:this.$t("error."+n.errorMsg)},startLabel(){return this.aInfo.has_active_attempt?this.$t("launch.continue_assess"):this.aInfo.submitby==="by_assessment"&&this.aInfo.prev_attempts.length>0?this.$t("launch.retake_assess"):this.$t("launch.start_assess")},timeLimitExpired(){if(n.timelimit_expired&&n.timelimit_grace_expired&&this.aInfo.has_active_attempt){const e=this.aInfo.timelimit_expires_disp;return this.$t("setlist.time_expired",{date:e})}else return""},timeLimitExt(){return this.aInfo.timelimit_ext&&this.aInfo.timelimit_ext>0&&this.aInfo.has_active_attempt?this.$t("setlist.timelimit_ext",{n:this.aInfo.timelimit_ext}):""},okToLaunch(){return!(!this.showPreviewAll&&this.aInfo.isgroup===3&&this.aInfo.group_members.length===0||this.aInfo.timelimit>0&&this.aInfo.has_active_attempt&&(n.timelimit_expired&&this.aInfo.timelimit_type==="kick_out"||n.timelimit_grace_expired&&this.aInfo.timelimit_type==="allow_overtime")&&this.timeLimitExt==="")},showPreviewAll(){return n.assessInfo.can_view_all&&!this.aInfo.view_as_stu},showReset(){return this.aInfo.is_teacher&&!this.aInfo.view_as_stu&&(this.aInfo.has_active_attempt||this.aInfo.prev_attempts.length>0||this.aInfo.has_unsubmitted_scored)},hasExit(){return window.exiturl&&window.exiturl!==""},canAddWork(){return(!this.aInfo.has_active_attempt||this.aInfo.submitby==="by_question")&&this.aInfo.showwork_after&&(this.aInfo.showwork_cutoff===0||this.aInfo.showwork_cutoff_in>0)},showTutorLinks(){return this.aInfo.hasOwnProperty("tutor_gblinks")},showGbLink(){return this.aInfo.is_lti&&this.aInfo.viewingb==="immediately"&&this.aInfo.has_active_attempt&&!n.assessInfo.can_view_all},gbUrl(){let e="gbviewassess.php?";return e+="cid="+n.cid,e+="&aid="+n.aid,e+="&uid="+n.uid,e}},methods:{startAssess(){if(!this.okToLaunch)return;const e=this.aInfo.timelimit;if(this.aInfo.has_password){const t=document.getElementById("password");t&&t.value!==this.password&&(this.password=t.value)}e===0?this.reallyStartAssess():n.confirmObj={body:"launch.timewarning",ok:"launch.start_assess",action:()=>this.reallyStartAssess()}},teacherPreviewAll(){A.startAssess(!1,"",[],null,!0)},reallyStartAssess(){const e=this.password;this.password="",A.startAssess(!1,e,this.newGroupMembers)},endAssess(){A.endAssess()},doReset(){A.loadAssessData(null,!0)},updateNewGroup(e){this.newGroupMembers=e},exitAssess(){window.location=window.exiturl}},mounted(){if(this.aInfo.displaymethod==="livepoll"){var e=document.createElement("script");e.src="https://"+this.aInfo.livepoll_server+":3000/socket.io/socket.io.js",document.getElementsByTagName("head")[0].appendChild(e)}else if(this.aInfo.displaymethod==="video_cued"&&!window.YT){const t=document.createElement("script");t.id="yt_player_api",t.src="https://www.youtube.com/player_api",document.head.appendChild(t)}setTimeout(window.drawPics,50),window.rendermathnode(this.$refs.summary),window.initlinkmarkup(this.$refs.summary)}},ai={class:"home flexpanes"},oi={style:{"flex-grow":"1"}},li=["innerHTML"],ui={class:"settings-list"},ci={key:0,class:"flexrow"},di={key:1,class:"flexrow"},hi={key:0,class:"noticetext"},fi={key:1,class:"noticetext"},pi={key:0},mi={key:1},_i={key:2,class:"noticetext"},wi={key:3},gi={key:4},yi={key:5},bi=["href"],vi=["href"],ki={key:6,class:"noticetext"},qi={key:0},Ii={key:1,class:"pane-body"},Ai=["href"];function Pi(e,t,i,r,a,s){const o=v("settings-list"),u=v("icons"),f=v("password-entry"),_=v("group-entry"),m=v("summary-gb-score"),p=v("previous-attempts");return l(),c("div",ai,[h("div",oi,[h("h1",null,d(s.aInfo.name),1),h("div",{class:"med-below",innerHTML:s.aInfo.summary,ref:"summary"},null,8,li),k(o),h("div",ui,[s.aInfo.has_password?(l(),c("div",ci,[h("div",null,[k(u,{name:"lock",size:"small"})]),k(f,{modelValue:e.password,"onUpdate:modelValue":t[0]||(t[0]=g=>e.password=g),onOnenter:s.startAssess},null,8,["modelValue","onOnenter"])])):w("",!0),s.aInfo.isgroup>0?(l(),c("div",di,[h("div",null,[k(u,{name:"group",size:"small"})]),k(_,{onUpdateNewGroup:s.updateNewGroup},null,8,["onUpdateNewGroup"])])):w("",!0)]),s.errorMsg!==null?(l(),c("p",hi,d(s.errorMsg),1)):w("",!0),s.timeLimitExpired!==""?(l(),c("p",fi,[k(u,{name:"alert"}),q(" "+d(s.timeLimitExpired)+" ",1),t[8]||(t[8]=h("br",null,null,-1)),s.timeLimitExt!==""?(l(),c("span",pi,[k(u,{name:"alert"}),q(" "+d(s.timeLimitExt),1)])):(l(),c("span",mi,[h("button",{type:"button",class:"primary",onClick:t[1]||(t[1]=(...g)=>s.endAssess&&s.endAssess(...g))},d(e.$t("closed.submit_now")),1)]))])):s.timeLimitExt!==""?(l(),c("p",_i,[k(u,{name:"alert"}),q(" "+d(s.timeLimitExt),1)])):w("",!0),s.canAddWork?(l(),c("p",wi,[q(d(e.$t("work.add_prev")),1),t[9]||(t[9]=h("br",null,null,-1)),h("button",{type:"button",class:"secondary",onClick:t[2]||(t[2]=g=>e.$router.push("/showwork"))},d(e.$t("work.add")),1)])):w("",!0),s.showReset?(l(),c("p",gi,[q(d(e.$t("launch.resetmsg"))+" ",1),t[10]||(t[10]=h("br",null,null,-1)),h("button",{type:"button",class:"secondary",onClick:t[3]||(t[3]=(...g)=>s.doReset&&s.doReset(...g))},d(e.$t("launch.doreset")),1)])):w("",!0),s.showTutorLinks?(l(),c("p",yi,[q(d(e.$t("launch.gblinks"))+": ",1),h("a",{href:s.aInfo.tutor_gblinks[0],target:"_blank"},d(e.$t("launch.scorelist")),9,bi),t[11]||(t[11]=q("   ",-1)),h("a",{href:s.aInfo.tutor_gblinks[1],target:"_blank"},d(e.$t("launch.itemanalysis")),9,vi)])):w("",!0),s.aInfo.view_as_stu?(l(),c("p",ki,d(e.$t("launch.view_as_stu",{name:s.aInfo.stu_fullname})),1)):w("",!0),h("p",null,[s.okToLaunch?(l(),c("button",{key:0,type:"button",class:"primary",onClick:t[4]||(t[4]=(...g)=>s.startAssess&&s.startAssess(...g))},d(s.startLabel),1)):w("",!0),h("input",{type:"submit",style:{display:"none"},onClick:t[5]||(t[5]=(...g)=>s.startAssess&&s.startAssess(...g)),value:"Submit"}),s.showPreviewAll?(l(),c("button",{key:1,class:"secondary",onClick:t[6]||(t[6]=(...g)=>s.teacherPreviewAll&&s.teacherPreviewAll(...g))},d(e.$t("closed.teacher_previewall_button")),1)):w("",!0),s.hasExit?(l(),c("button",{key:2,type:"button",class:"secondary",onClick:t[7]||(t[7]=(...g)=>s.exitAssess&&s.exitAssess(...g))},d(e.$t("closed.exit")),1)):w("",!0)])]),s.aInfo.hasOwnProperty("prev_attempts")&&s.aInfo.prev_attempts.length>0?(l(),c("div",qi,[k(m),k(p,{caption:e.$t("prev.previous_attempts")},null,8,["caption"])])):s.showGbLink?(l(),c("div",Ii,[h("p",null,[h("a",{href:s.gbUrl},d(e.$t("prev.viewingb")),9,Ai)])])):w("",!0)])}const Ti=x(ri,[["render",Pi]]),Si={name:"Closed",components:{Icons:B,PreviousAttempts:Ze,SummaryGbScore:et},computed:{settings(){return n.assessInfo},closedMessage(){return this.settings.available==="hidden"?this.$t("closed.hidden"):this.settings.available==="notyet"?this.$t("closed.notyet",{sd:this.settings.startdate_disp,ed:this.settings.enddate_disp}):this.settings.available==="practice"||this.settings.available==="pastdue"?this.$t("closed.pastdue",{ed:this.settings.enddate_disp}):this.settings.available==="needprereq"?this.$t("closed.needprereq")+" "+this.$t("closed.prereqreq",{score:this.settings.reqscorevalue,name:this.settings.reqscorename}):this.settings.hasOwnProperty("pasttime")?this.$t("closed.pasttime"):this.settings.has_active_attempt===!1&&this.settings.can_retake===!1?this.$t("closed.no_attempts"):""},hasActive(){return this.settings.submitby==="by_assessment"&&(this.settings.available==="yes"&&this.settings.has_active_attempt||this.settings.available!=="yes"&&this.settings.has_unsubmitted_scored)},hasActiveMsg(){return this.settings.hasOwnProperty("timelimit_expiresin")?this.settings.timelimit_expiresin*1e3<0?this.$t("closed.unsubmitted_overtime"):this.$t("closed.unsubmitted_pastdue"):this.$t("closed.unsubmitted_pastdue")},showLatePassOffer(){return this.settings.available!=="needprereq"&&!this.settings.hasOwnProperty("pasttime")},latepassExtendMsg(){return this.$t("closed.latepass_needed",this.settings.can_use_latepass,{n:this.settings.can_use_latepass,date:this.settings.latepass_extendto_disp})},primaryAction(){return this.settings.can_use_latepass>0&&this.showLatePassOffer?"latepass":this.settings.available==="practice"?"practice":window.exiturl&&window.exiturl!==""?"exit":""},primaryButton(){return this.primaryAction==="latepass"?this.$t("closed.use_latepass",this.settings.can_use_latepass):this.primaryAction==="practice"?this.$t("closed.do_practice"):this.primaryAction==="exit"?this.$t("closed.exit"):""},secondaryAction(){return this.primaryAction!=="practice"&&this.settings.available==="practice"?"practice":window.exiturl&&window.exiturl!==""&&this.primaryAction!=="exit"?"exit":""},secondaryButton(){return this.secondaryAction==="practice"?this.$t("closed.do_practice"):this.secondaryAction==="exit"?this.$t("closed.exit"):""},canViewScored(){return!this.canViewAll&&this.settings.can_viewingb===1&&this.settings.prev_attempts.length>0&&(this.settings.available==="practice"||this.settings.available==="pastdue")},canViewAll(){return n.assessInfo.can_view_all},showReset(){return n.assessInfo.hasOwnProperty("show_reset")||n.assessInfo.is_teacher&&!n.assessInfo.view_as_stu&&(n.assessInfo.has_active_attempt||n.assessInfo.prev_attempts.length>0||n.assessInfo.has_unsubmitted_scored)},canAddWork(){return n.assessInfo.showwork_after&&!n.showwork_expired&&(!n.assessInfo.has_active_attempt||n.assessInfo.submitby==="by_question")},showTutorLinks(){return n.assessInfo.hasOwnProperty("tutor_gblinks")}},methods:{handleViewScored(){this.settings.can_use_latepass===0?window.location=n.APIbase+"gbviewassess.php?cid="+n.cid+"&aid="+n.aid+"&uid="+n.uid:n.confirmObj={body:"closed.confirm",action:()=>{window.location=n.APIbase+"gbviewassess.php?cid="+n.cid+"&aid="+n.aid+"&uid="+n.uid}}},handlePrimary(){this.primaryAction==="latepass"?A.redeemLatePass():this.primaryAction==="practice"?A.startAssess(!0,"",[]):this.primaryAction==="exit"&&(window.location=window.exiturl)},handleSecondary(){this.secondaryAction==="practice"&&this.settings.can_use_latepass===0?A.startAssess(!0,"",[]):this.secondaryAction==="practice"?n.confirmObj={body:"closed.confirm",action:()=>{A.startAssess(!0,"",[])}}:this.secondaryAction==="exit"&&(window.location=window.exiturl)},teacherPreview(){A.startAssess(!1,"",[])},teacherPreviewAll(){A.startAssess(!1,"",[],null,!0)},doReset(){A.loadAssessData(null,!0)},endAssess(){A.endAssess()}}},Oi={class:"home flexpanes"},xi={style:{"flex-grow":"1"}},$i={key:0},Ei=["href"],Ci=["href"],Di={key:1},Ri={key:2},Qi={key:3},Li={key:4},Mi={key:0},Ni={key:5},ji={key:6},Vi={key:0},Bi={key:7},Fi={key:0},Gi={key:8},Hi={key:9},Ui={key:0};function Wi(e,t,i,r,a,s){const o=v("icons"),u=v("summary-gb-score"),f=v("previous-attempts");return l(),c("div",Oi,[h("div",xi,[h("h1",null,d(s.settings.name),1),h("p",null,d(s.closedMessage),1),s.showTutorLinks?(l(),c("p",$i,[q(d(e.$t("launch.gblinks"))+": ",1),h("a",{href:s.settings.tutor_gblinks[0],target:"_blank"},d(e.$t("launch.scorelist")),9,Ei),t[8]||(t[8]=q("   ",-1)),h("a",{href:s.settings.tutor_gblinks[1],target:"_blank"},d(e.$t("launch.itemanalysis")),9,Ci)])):w("",!0),s.hasActive?(l(),c("p",Di,[q(d(s.hasActiveMsg)+" ",1),t[9]||(t[9]=h("br",null,null,-1)),h("button",{type:"button",class:"primary",onClick:t[0]||(t[0]=(..._)=>s.endAssess&&s.endAssess(..._))},d(e.$t("closed.submit_now")),1)])):s.canAddWork?(l(),c("p",Ri,[q(d(e.$t("work.add_prev")),1),t[10]||(t[10]=h("br",null,null,-1)),h("button",{type:"button",class:"secondary",onClick:t[1]||(t[1]=_=>e.$router.push("/showwork"))},d(e.$t("work.add")),1)])):w("",!0),s.settings.can_use_latepass>0&&s.showLatePassOffer?(l(),c("p",Qi,[q(d(e.$t("closed.latepassn",s.settings.latepasses_avail))+" ",1),t[11]||(t[11]=h("br",null,null,-1)),q(" "+d(s.latepassExtendMsg),1)])):w("",!0),s.settings.can_use_latepass==0&&s.settings.latepass_reason>1&&s.showLatePassOffer?(l(),c("p",Li,[q(d(e.$t("latepass.reason"+s.settings.latepass_reason))+" ",1),s.settings.latepass_reason==6?(l(),c("span",Mi,d(e.$t("closed.latepassn",s.settings.latepasses_avail)),1)):w("",!0)])):w("",!0),s.settings.available==="practice"&&s.settings.can_use_latepass===0?(l(),c("p",Ni,d(e.$t("closed.practice_no_latepass")),1)):s.settings.available==="practice"&&s.settings.can_use_latepass>0?(l(),c("p",ji,[q(d(e.$t("closed.practice_w_latepass"))+" ",1),t[13]||(t[13]=h("br",null,null,-1)),k(o,{name:"alert",size:"micro"}),q(" "+d(e.$t("closed.will_block_latepass"))+" ",1),s.settings.hasOwnProperty("excused")?(l(),c("span",Vi,[t[12]||(t[12]=h("br",null,null,-1)),k(o,{name:"alert",size:"micro"}),q(" "+d(e.$t("setlist.excused")),1)])):w("",!0)])):w("",!0),s.canViewScored?(l(),c("p",Bi,[q(d(e.$t("closed.can_view_scored"))+" ",1),s.settings.can_use_latepass>0?(l(),c("span",Fi,[t[14]||(t[14]=h("br",null,null,-1)),k(o,{name:"alert",size:"micro"}),q(" "+d(e.$t("closed.will_block_latepass")),1)])):w("",!0)])):w("",!0),h("p",null,[s.primaryButton!=""?(l(),c("button",{key:0,class:"primary",onClick:t[2]||(t[2]=(..._)=>s.handlePrimary&&s.handlePrimary(..._))},d(s.primaryButton),1)):w("",!0),s.canViewScored?(l(),c("button",{key:1,class:"secondarybtn",onClick:t[3]||(t[3]=(..._)=>s.handleViewScored&&s.handleViewScored(..._))},d(e.$t("closed.view_scored")),1)):w("",!0),s.secondaryButton!=""?(l(),c("button",{key:2,class:"secondarybtn",onClick:t[4]||(t[4]=(..._)=>s.handleSecondary&&s.handleSecondary(..._))},d(s.secondaryButton),1)):w("",!0)]),s.canViewAll&&s.showReset?(l(),c("p",Gi,[q(d(e.$t("launch.resetmsg"))+" ",1),t[15]||(t[15]=h("br",null,null,-1)),h("button",{type:"button",class:"primary",onClick:t[5]||(t[5]=(..._)=>s.doReset&&s.doReset(..._))},d(e.$t("launch.doreset")),1)])):w("",!0),s.canViewAll?(l(),c("p",Hi,[q(d(e.$t("closed.teacher_preview"))+" ",1),t[16]||(t[16]=h("br",null,null,-1)),h("button",{class:"primary",onClick:t[6]||(t[6]=(..._)=>s.teacherPreview&&s.teacherPreview(..._))},d(e.$t("closed.teacher_preview_button")),1),h("button",{class:"secondary",onClick:t[7]||(t[7]=(..._)=>s.teacherPreviewAll&&s.teacherPreviewAll(..._))},d(e.$t("closed.teacher_previewall_button")),1)])):w("",!0)]),s.settings.hasOwnProperty("prev_attempts")&&s.settings.prev_attempts.length>0?(l(),c("div",Ui,[k(u),k(f,{caption:e.$t("prev.scored_attempts")},null,8,["caption"])])):w("",!0)])}const Ki=x(Si,[["render",Wi]]),zi={name:"SummaryHeader",computed:{ainfo(){return n.assessInfo},retakeLabel(){return this.ainfo.submitby==="by_assessment"&&this.ainfo.prev_attempts.length<this.ainfo.allowed_attempts?this.$t("launch.retake_assess"):this.ainfo.submitby==="by_question"&&n.inAssess&&this.ainfo.has_active_attempt?this.$t("launch.continue_assess"):""},hasExit(){return window.exiturl&&window.exiturl!==""&&!this.ainfo.is_lti}},methods:{exit(){window.location=window.exiturl},retake(){n.assessInfo=null,this.$router.push("/")}}},Ji={class:"assess-header headerpane"},Yi={style:{"flex-grow":"1"}};function Xi(e,t,i,r,a,s){return l(),c("div",Ji,[h("div",Yi,[h("h1",null,d(s.ainfo.name),1)]),h("div",null,[s.retakeLabel!=""?(l(),c("button",{key:0,onClick:t[0]||(t[0]=(...o)=>s.retake&&s.retake(...o))},d(s.retakeLabel),1)):w("",!0),s.hasExit?(l(),c("button",{key:1,onClick:t[1]||(t[1]=(...o)=>s.exit&&s.exit(...o))},d(e.$t("closed.exit")),1)):w("",!0)])])}const Zi=x(zi,[["render",Xi]]),er={name:"SummaryScoreTotal",components:{},computed:{ainfo(){return n.assessInfo},showTotal(){return this.ainfo.showscores!=="none"},scoreTotal(){if(this.ainfo.hasOwnProperty("score"))return this.ainfo.score;{let e=0;for(const t in this.ainfo.questions)e+=this.ainfo.questions[t].score;return e}},retakePenalty(){if(this.ainfo.submitby==="by_question")return 0;const e=this.ainfo.prev_attempts.length;return e>this.ainfo.retake_penalty.n?this.ainfo.retake_penalty.penalty*(e-this.ainfo.retake_penalty.n):0},latePenalty(){if(this.ainfo.submitby==="by_question")return 0;let e=0;for(const t in this.ainfo.questions){const i=this.ainfo.questions[t].parts;for(let r=0;r<i.length;r++)if(i[r].hasOwnProperty("penalties")&&i[r].penalties.hasOwnProperty("late"))e+=i[r].penalties.late;else if(e>0)return 0}return e},scoreTotalPercent(){return Math.round(1e3*this.scoreTotal/this.ainfo.points_possible)/10},viewWorkType(){return this.ainfo.viewingb==="never"?"never":this.ainfo.viewingb==="after_due"?this.ainfo.scoresingb==="never"||this.ainfo.scoresingb==="manual"?"work_after":"after_due":this.ainfo.viewingb==="after_lp"?this.ainfo.scoresingb==="never"||this.ainfo.scoresingb==="manual"?"work_after_lp":"after_lp":this.ainfo.scoresingb==="never"||this.ainfo.scoresingb==="manual"?"work":this.ainfo.scoresingb==="after_due"?"work_scores_after":"immediately"}}},tr={key:0},sr={class:"larger"},nr={key:0},ir={key:1},rr={key:1};function ar(e,t,i,r,a,s){return l(),c("div",null,[s.showTotal?(l(),c("p",tr,[h("strong",sr,d(e.$t("summary.score"))+": "+d(s.scoreTotalPercent)+"% ",1),t[2]||(t[2]=h("br",null,null,-1)),q(" "+d(e.$t("summary.scorepts",s.ainfo.points_possible,{pts:s.scoreTotal,poss:s.ainfo.points_possible}))+" ",1),s.retakePenalty>0?(l(),c("span",nr,[t[0]||(t[0]=h("br",null,null,-1)),q(" "+d(e.$t("summary.retake_penalty",{n:s.retakePenalty})),1)])):w("",!0),s.latePenalty>0?(l(),c("span",ir,[t[1]||(t[1]=h("br",null,null,-1)),q(" "+d(e.$t("summary.late_penalty",{n:s.latePenalty})),1)])):w("",!0)])):(l(),c("p",rr,d(e.$t("summary.no_total"))+" "+d(e.$t("summary.viewwork_"+s.viewWorkType)),1))])}const or=x(er,[["render",ar]]),lr={name:"QuestionDetailsTable",props:["qinfo","caption","showtries","submitby"],components:{Icons:B,PenaltiesApplied:Pt},computed:{parts(){return this.qinfo.parts},doShowTries(){return this.showtries!==!1},partHasPenalties(){const e=[];for(let t=0;t<this.parts.length;t++)this.parts[t].hasOwnProperty("penalties")&&this.parts[t].penalties.length>0&&e.push(t);return e},triesRemaining(){const e=[];for(let t=0;t<this.parts.length;t++)this.parts[t].points_possible===0?e[t]="":this.qinfo.hasOwnProperty("did_jump_to_ans")?e[t]=0:e[t]=this.qinfo.tries_max-this.parts[t].try;return e},hasPenalty(){return this.partHasPenalties.length>0},showScore(){return this.qinfo.hasOwnProperty("score")},partIcons(){const e=[];for(let t=0;t<this.parts.length;t++)this.parts[t].try===0?e[t]="unattempted":this.parts[t].hasOwnProperty("rawscore")?this.parts[t].rawscore>.99?e[t]="correct":this.parts[t].rawscore<.01?e[t]="incorrect":e[t]="partial":e[t]="attempted";return e}}},ur={class:"qdetails"},cr={key:0},dr={key:0},hr={key:1},fr={key:2},pr={key:0},mr={key:1},_r={key:2};function wr(e,t,i,r,a,s){const o=v("icons"),u=v("penalties-applied");return l(),c("table",ur,[i.caption?(l(),c("caption",cr,d(i.caption),1)):w("",!0),h("thead",null,[h("tr",null,[h("th",null,d(e.$t("qdetails.part")),1),s.showScore?(l(),c("th",dr,d(e.$t("qdetails.score")),1)):w("",!0),s.doShowTries?(l(),c("th",hr,d(e.$t("qdetails.try")),1)):w("",!0),s.hasPenalty?(l(),c("th",fr,d(e.$t("qdetails.penalties")),1)):w("",!0)])]),h("tbody",null,[(l(!0),c(H,null,U(s.parts,(f,_)=>(l(),c("tr",{key:_},[h("td",null,[k(o,{name:s.partIcons[_]},null,8,["name"]),q(" "+d(_+1),1)]),s.showScore?(l(),c("td",pr,d(f.score)+"/"+d(f.points_possible),1)):w("",!0),s.doShowTries?(l(),c("td",mr,d(s.triesRemaining[_]),1)):w("",!0),s.hasPenalty?(l(),c("td",_r,[s.partHasPenalties.indexOf(_)!=-1?(l(),T(u,{key:0,part:f,submitby:i.submitby},null,8,["part","submitby"])):w("",!0)])):w("",!0)]))),128))])])}const Ft=x(lr,[["render",wr]]),gr={name:"ClickToShow",props:["id"],data:function(){return{open:!1,closetimer:null}},methods:{triggerOpen(e){typeof e=="boolean"?this.open=e:this.open=!this.open,this.open||this.$refs.button.focus()}}},yr=["id","aria-controls","aria-expanded"],br=["id"];function vr(e,t,i,r,a,s){return l(),c("span",null,[h("span",{id:i.id,ref:"button",role:"button",tabindex:"0",onClick:t[0]||(t[0]=(...o)=>s.triggerOpen&&s.triggerOpen(...o)),onKeydown:[t[1]||(t[1]=X(se((...o)=>s.triggerOpen&&s.triggerOpen(...o),["prevent"]),["enter"])),t[2]||(t[2]=X(se((...o)=>s.triggerOpen&&s.triggerOpen(...o),["prevent"]),["space"]))],class:"dropdown-button","aria-controls":i.id+"_pane","aria-expanded":e.open?"true":"false"},[pe(e.$slots,"button")],40,yr),e.open?(l(),c("div",{key:0,id:i.id+"_pane"},[pe(e.$slots,"default")],8,br)):w("",!0)])}const kr=x(gr,[["render",vr]]),qr={name:"SummaryScoreList",components:{Icons:B,QuestionDetailsTable:Ft,ClickToShow:kr},computed:{questions(){return n.assessInfo.questions},noTries(){var e={};for(const t in this.questions)if(!this.questions[t].hasOwnProperty("parts"))e[t]=!0;else{let i=!0;for(const r in this.questions[t].parts)if(this.questions[t].parts[r].try>0){i=!1;break}e[t]=i}return e}}},Ir={class:"scorelist"},Ar={key:0,class:"small subdued"},Pr={key:0},Tr={key:1};function Sr(e,t,i,r,a,s){const o=v("icons"),u=v("question-details-table"),f=v("click-to-show");return l(),c("table",Ir,[t[0]||(t[0]=h("caption",{class:"sr-only"},"Scores",-1)),h("thead",null,[h("tr",null,[h("th",null,d(e.$t("scorelist.question")),1),h("th",null,d(e.$t("scorelist.score")),1)])]),h("tbody",null,[(l(!0),c(H,null,U(s.questions,(_,m)=>(l(),c("tr",{key:m},[h("td",null,[k(o,{name:_.status},null,8,["name"]),q(" "+d(e.$t("question_n",{n:m+1}))+" ",1),_.extracredit?(l(),c("em",Ar,d(e.$t("extracredit")),1)):w("",!0)]),s.noTries[m]?(l(),c("td",Pr,d(e.$t("scorelist.unattempted")),1)):(l(),c("td",Tr,[q(d(e.$t("scorelist.pts",_.points_possible,{pts:_.gbscore,poss:_.points_possible}))+"    ",1),_.has_details?(l(),T(f,{key:0,class:"question-details",id:"qd_"+m},{button:L(()=>[k(o,{name:"info",size:"small"}),q(" "+d(e.$t("header.details")),1)]),default:L(()=>[k(u,{qinfo:_,showtries:!1},null,8,["qinfo"])]),_:2},1032,["id"])):w("",!0)]))]))),128))])])}const Or=x(qr,[["render",Sr]]),xr={name:"SummaryDiagInfo",computed:{showDiagInfo(){return n.assessInfo.is_diag},diagUserName(){return n.assessInfo.userfullname+": "+n.assessInfo.diag_userid}}},$r={key:0},Er={class:"big"},Cr={class:"pii-full-name"};function Dr(e,t,i,r,a,s){return s.showDiagInfo?(l(),c("div",$r,[h("p",Er,[h("span",Cr,d(s.diagUserName),1)]),h("p",null,d(e.$d(new Date,"long")),1)])):w("",!0)}const Rr=x(xr,[["render",Dr]]),Qr={name:"ScoreResult",props:["qdata","qn"],data:function(){return{expanded:!0}},watch:{qdata:function(e){this.expanded=!0}},components:{Icons:B},computed:{showScores(){return this.qdata.hasOwnProperty("parts")&&this.qdata.parts.length===1&&this.qdata.parts[0].req_manual?!1:n.assessInfo.showscores==="during"},status(){let e=-1,t=-2,i=0,r=0;this.qdata.hasOwnProperty("parts")&&(r=this.qdata.parts.length);let a;if(!this.showScores||!this.qdata.hasOwnProperty("parts")||this.qdata.parts.length===1&&this.qdata.parts[0].req_manual)a="neutral";else{let s=0,o=0,u=0;for(let f=0;f<this.qdata.parts.length;f++)parseFloat(this.qdata.answeights[f])===0?u++:this.qdata.parts[f].hasOwnProperty("rawscore")?this.qdata.parts[f].rawscore>.99?(e=f,s++):(e=f,this.qdata.parts[f].rawscore<.01&&o++,t<0&&!this.qdata.parts[f].req_manual&&(this.qdata.parts[f].try<this.qdata.tries_max?t=f:t=-1)):i++;this.qdata.singlescore?this.qdata.rawscore>.99?a="correct":this.qdata.rawscore<.01?a="incorrect":a="partial":(a="partial",s===this.qdata.parts.length-u?a="correct":o===this.qdata.parts.length-u&&(a="incorrect"))}return{general:a,firstincorrect:t,lasttried:e,untried:i,partcount:r}},partStatusMessage(){return this.status.partcount>1&&this.status.general!=="neutral"?this.status.firstincorrect===-2?this.$t("scoreresult.allpartscorrect"):this.$t("scoreresult.onepartincorrect"):""},hasManualScore(){if(n.assessInfo.showscores!=="during"||!this.qdata.hasOwnProperty("parts"))return!1;for(let e=0;e<this.qdata.parts.length;e++)if(this.qdata.parts[e].hasOwnProperty("req_manual")&&this.qdata.parts[e].req_manual)return!0;return!1},showRetryButtons(){return n.assessInfo.displaymethod!=="livepoll"},showNext(){return n.assessInfo.displaymethod==="skip"&&this.qn<n.assessInfo.questions.length-1},showSubmit(){return n.assessInfo.submitby==="by_assessment"&&this.qn===n.assessInfo.questions.length-1}},methods:{trySimilar(){A.loadQuestion(this.qn,!0)},submitAssess(){A.submitAssessment()},jumpToIncorrect(e){this.focusOnPart(this.status.firstincorrect,!1)},jumpToLastTried(e){this.focusOnPart(this.status.lasttried,!0)},getQuestionEl(e){const t=(parseInt(this.qn)+1)*1e3+e,i=window.$("#qnwrap"+t);if(i.length>0)return[i.attr("tabindex","-1")[0],!1];const r=window.$("[id^=mqinput-qn"+t+"]");if(window.MQ&&r.length>0)return[r[0],!0];const a=window.$("input[name^=qn"+t+"],select[name^=qn"+t+"],textarea[name^=qn"+t+"]");if(a.length>0)return[a[0],!1]},focusOnPart(e,t){const i=this.getQuestionEl(e);t?window.$(i[0]).nextAll(".afterquestion").first().attr("tabindex","-1")[0].focus():i[1]?window.MQ(i[0]).focus():i[0].focus()}}},Lr={key:0},Mr={key:1},Nr={key:2},jr={key:3},Vr={key:4},Br=["onClick","onKeypress"],Fr={key:3};function Gr(e,t,i,r,a,s){const o=v("icons"),u=v("router-link");return l(),T(Tt,{name:"fade"},{default:L(()=>[e.expanded?(l(),c("div",{key:0,class:z(["scoreresult",s.status.general]),tabindex:"-1"},[s.showScores?(l(),c("p",Lr,[q(d(e.$t("scoreresult.scorelast"))+" ",1),h("strong",null,d(e.$t("scoreresult.scorepts",i.qdata.points_possible,{pts:i.qdata.score,poss:i.qdata.points_possible}))+". ",1),q(" "+d(e.$t("scoreresult.see_details")),1)])):(l(),c("p",Mr,d(e.$t("scoreresult.submitted")),1)),s.hasManualScore?(l(),c("p",Nr,[k(o,{name:"info"}),q(" "+d(e.$t("scoreresult.manual_grade")),1)])):w("",!0),s.showScores&&s.status.general!=="correct"&&s.status.partcount>1&&(s.status.firstincorrect>-1||s.status.untried>0)?(l(),c("p",jr,[q(d(s.partStatusMessage)+" ",1),s.status.firstincorrect>-1?(l(),c("a",{key:0,href:"#",onClick:t[0]||(t[0]=se((...f)=>s.jumpToIncorrect&&s.jumpToIncorrect(...f),["prevent"]))},d(e.$t("scoreresult.jumptoincorrect"))+". ",1)):w("",!0),s.status.untried>0?(l(),c("a",{key:1,href:"#",onClick:t[1]||(t[1]=se((...f)=>s.jumpToLastTried&&s.jumpToLastTried(...f),["prevent"]))},d(e.$t("scoreresult.jumptolast"))+". ",1)):w("",!0)])):w("",!0),s.showRetryButtons?(l(),c("p",Vr,[s.showNext?(l(),T(u,{key:0,to:"/skip/"+(this.qn+2),custom:""},{default:L(({navigate:f})=>[h("button",{type:"button",onClick:f,onKeypress:X(f,["enter"]),role:"link"},[k(o,{name:"right",alt:""}),q(" "+d(e.$t("scoreresult.next")),1)],40,Br)]),_:1},8,["to"])):w("",!0),s.showSubmit?(l(),c("button",{key:1,type:"button",class:"primary",onClick:t[2]||(t[2]=(...f)=>s.submitAssess&&s.submitAssess(...f))},d(e.$t("header.assess_submit")),1)):w("",!0),i.qdata.canregen?(l(),c("button",{key:2,type:"button",onClick:t[3]||(t[3]=(...f)=>s.trySimilar&&s.trySimilar(...f))},[k(o,{name:"retake",alt:""}),q(" "+d(e.$t("scoreresult.trysimilar")),1)])):w("",!0),i.qdata.canretry_primary?(l(),c("span",Fr,d(e.$t("scoreresult.retryq")),1)):w("",!0)])):w("",!0)],2)):w("",!0)]),_:1})}const Hr=x(Qr,[["render",Gr]]),Ur={name:"QuestionHelps",props:["qn"],components:{Icons:B,TooltipSpan:Pe},computed:{showMessage(){return n.assessInfo.hasOwnProperty("help_features")&&n.assessInfo.help_features.message===!0},postToForum(){return n.assessInfo.hasOwnProperty("help_features")&&n.assessInfo.help_features.forum},qHelps(){const e={};if(n.assessInfo.questions[this.qn].jsparams){const t=n.assessInfo.questions[this.qn].jsparams.helps;for(const i in t)e.hasOwnProperty(t[i].label)?e[t[i].label]++:e[t[i].label]=1,t[i].label==="video"?(t[i].icon="video",t[i].title=this.$t("helps.video")):t[i].label==="read"?(t[i].icon="file",t[i].title=this.$t("helps.read")):t[i].label==="ex"?(t[i].icon="file",t[i].title=this.$t("helps.written_example")):(t[i].icon="file",t[i].title=t[i].label),t[i].cnt=e[t[i].label];return t}else return[]},showCnts(){return this.qHelps.filter(e=>e.cnt>1).length>0},quoteQ(){const e=n.assessInfo.questions[this.qn].questionsetid,t=n.assessInfo.questions[this.qn].seed;return this.qn+"-"+e+"-"+t+"-"+n.aid+"-"+2},messageHref(){let e=window.imasroot+"/msgs/msglist.php?";return e+=window.$.param({cid:n.cid,add:"new",quoteq:this.quoteQ,to:"instr"}),e},forumHref(){let e=window.imasroot+"/forums/thread.php?";return e+=window.$.param({cid:n.cid,forum:n.assessInfo.help_features.forum,modify:"new",quoteq:this.quoteQ}),e}},methods:{loadHelp(e){if(e.ref){const i="Q"+e.ref.split(/-/)[1]+": ";if(e.url.match(/watchvid\.php/)){const r=e.url.split(/url=/);window.recclick("extref",e.ref,i+decodeURIComponent(r[1]))}else window.recclick("extref",e.ref,i+e.url)}window.popupwindow("help",e.url,e.w,e.h,!0)}}},Wr=["id"],Kr={class:"sr-only"},zr=["aria-labelledby"],Jr=["onClick","aria-describedby"],Yr={key:0},Xr=["href"],Zr={key:1},ea=["href"];function ta(e,t,i,r,a,s){const o=v("icons"),u=v("tooltip-span");return l(),c("div",null,[h("span",{id:"qhelp"+i.qn},[q(d(e.$t("helps.help")),1),h("span",Kr,d(e.$t("question_n",{n:i.qn+1})),1),t[0]||(t[0]=q(": ",-1))],8,Wr),h("ul",{class:"helplist","aria-labelledby":"qhelp"+i.qn},[(l(!0),c(H,null,U(s.qHelps,(f,_)=>(l(),c("li",{key:_},[k(u,{tip:f.descr,tipid:"qhtip"+i.qn+"-"+_},{default:L(()=>[h("a",{href:"#",onClick:se(m=>s.loadHelp(f),["prevent"]),"aria-describedby":f.descr?"qhtip"+i.qn+"-"+_:void 0},[k(o,{name:f.icon,alt:""},null,8,["name"]),q(" "+d(f.title)+" ",1),h("span",{class:z({"sr-only":!s.showCnts})},d(f.cnt),3)],8,Jr)]),_:2},1032,["tip","tipid"])]))),128)),s.showMessage?(l(),c("li",Yr,[h("a",{href:s.messageHref,target:"help"},[k(o,{name:"message"}),q(" "+d(e.$t("helps.message_instructor")),1)],8,Xr)])):w("",!0),s.postToForum>0?(l(),c("li",Zr,[h("a",{href:s.forumHref,target:"help"},[k(o,{name:"forum"}),q(" "+d(e.$t("helps.post_to_forum")),1)],8,ea)])):w("",!0)],8,zr)])}const sa=x(Ur,[["render",ta]]),na={name:"ShowworkInput",props:{id:{default:null},qn:{default:null},value:{default:""},rows:{default:2},active:{default:!0}},data:function(){return{objTinymce:null,filelist:[],uploading:!1}},computed:{computedId:function(){return this.id==="editor"||this.id===""||this.id===null?"editor-"+this.guidGenerator():this.id},worktype:function(){return n.assessInfo.showworktype===4?1:0}},mounted:function(){this.worktype===0&&(this.$refs.inbox.innerHTML=this.value),this.active&&this.initEditor()},updated:function(){this.active&&this.worktype===0&&this.objTinymce===null&&this.initEditor()},methods:{guidGenerator:function(){function e(){return Math.random().toString(36).substr(2,9)}return"ed-"+e()+"-"+e()},initEditor(){var e=this;this.worktype===1?(window.$(this.$refs.fileinput).on("focus",function(t){e.$emit("focus",!0)}),this.updateFilelist(this.value),this.objTinymce={value:this.value}):window.tinymce?window.initeditor("exact",this.computedId,null,!1,function(t){t.on("input change keyup undo redo",function(i){e.updateValue(t.getContent())}).on("blur",function(i){e.$emit("blur",!0)}).on("focus",function(i){e.$emit("focus",!0)}),e.objTinymce=t}):(window.$(this.$refs.inbox).on("focus",function(t){e.$emit("focus",!0)}).on("blur",function(t){e.$emit("blur",!0)}).on("input change keyup undo redo",function(t){e.updateValue(t.target.value)}),e.objTinymce=this.$refs.inbox)},updateFilelist:function(e){const t=[],i=e.match(/<(a[^>]*href|img[^>]*src)="(.*?)"/g);if(i!==null)for(let r=0;r<i.length;r++)t.push(i[r].replace(/^.*?(href|src)="(.*?)"/,"$2"));this.filelist=t},updateValue:function(e){e.length>3e4&&(e=e.substr(0,3e4)),this.$emit("input",e)},focus:function(){this.objTinymce.focus()},uploadFile:function(){window.doImageUploadResize(this.$refs.fileinput,e=>{if(!e.files||e.files.length===0){A.handleError("file_error_cant_read"),this.$refs.fileinput.value="";return}if(e.files[0].size>15e3*1024){A.handleError("file_toolarge"),this.$refs.fileinput.value="";return}const t=new FormData;t.append("type","attach"),t.append("file",e.files[0]),this.uploading=!0,window.$.ajax({url:n.APIbase.replace(/\/\w+\/$/,"")+"/tinymce8/upload_handler.php",type:"POST",dataType:"json",data:t,processData:!1,contentType:!1,xhrFields:{withCredentials:!0},crossDomain:!0}).done(i=>{i.location?(this.filelist.push(i.location),this.updateValueFromFilelist()):A.handleError("file_upload_error")}).fail(i=>{A.handleError("file_upload_error")}).always(()=>{this.$refs.fileinput.value=null,this.uploading=!1})})},removeFile:function(e){n.confirmObj={body:"work.remove",action:()=>{const t=this.filelist[e];this.filelist.splice(e,1),this.updateValueFromFilelist(),window.$.ajax({url:n.APIbase+"../tinymce8/upload_handler.php",type:"POST",dataType:"json",data:{remove:t},xhrFields:{withCredentials:!0},crossDomain:!0})}}},updateValueFromFilelist:function(){let e="";if(this.filelist.length>0){e+='<ul class="nomark">';for(let t=0;t<this.filelist.length;t++)e+='<li><a href="'+this.filelist[t]+'" class="attach" target="_blank">'+this.filelist[t].split("/").pop()+"</a></li>";e+="</ul>"}this.objTinymce.value=e,this.$emit("input",e),this.$emit("blur",e)}},watch:{active:function(e,t){e===!0&&this.objTinymce===null&&this.initEditor()},value:function(e,t){typeof e!="string"&&(e=""),this.worktype===1?e!==this.objTinymce.value&&this.updateFilelist(e):window.tinymce?e!==this.objTinymce.getContent()&&this.objTinymce.setContent(e):e!==this.objTinymce.value&&(this.objTinymce.value=e)}}},ia={class:"showworkwrap"},ra={key:0},aa=["id","rows","aria-label"],oa={key:1,class:"feedbackwrap"},la={class:"nomark"},ua=["href"],ca=["onClick"],da={key:0,class:"noticetext"};function ha(e,t,i,r,a,s){return l(),c("div",ia,[s.worktype===0?(l(),c("div",ra,[q(d(e.$t("question.showwork"))+" ",1),h("textarea",{id:s.computedId,ref:"inbox",class:"fbbox swbox",rows:i.rows,"aria-label":e.$t("question.showwork_n",{n:i.qn+1})},null,8,aa)])):(l(),c("div",oa,[q(d(e.$t("question.uploadwork"))+" ",1),h("ul",la,[(l(!0),c(H,null,U(e.filelist,(o,u)=>(l(),c("li",{key:u},[h("a",{href:o,class:"attach",target:"_blank"},d(o.split("/").pop()),9,ua),h("button",{onClick:f=>s.removeFile(u)},d(e.$t("group.remove")),9,ca)]))),128)),h("li",null,[h("input",{type:"file",ref:"fileinput",onChange:t[0]||(t[0]=(...o)=>s.uploadFile&&s.uploadFile(...o))},null,544),e.uploading?(l(),c("span",da,d(e.$t("question.uploading")),1)):w("",!0)])]),t[1]||(t[1]=h("div",null,null,-1))]))])}const Gt=x(na,[["render",ha]]),fa={name:"Question",props:["qn","active","state","seed","disabled","getwork"],components:{ScoreResult:Hr,QuestionHelps:sa,ShowworkInput:Gt,Icons:B},data:function(){return{work:"",lastWorkVal:"",showWorkInput:!1,loadingAttempted:!1}},computed:{questionData(){return n.assessInfo.questions[this.qn]},canSubmit(){return!n.inTransit},canJumpToAnswer(){return this.questionData.jump_to_answer},questionContentLoaded(){return this.questionData.html!==null},hasSeqNext(){return this.questionData.jsparams&&this.questionData.jsparams.hasseqnext},hasSubmitAll(){return this.questionData.jsparams&&this.questionData.jsparams.submitall===1},buttonsOk(){return n.inProgress&&this.questionContentLoaded&&!n.inPrintView&&!this.disabled&&this.questionData.withdrawn===0&&this.questionData.canretry},showSubmit(){return this.buttonsOk&&(n.assessInfo.submitby==="by_question"||n.assessInfo.showscores==="during"||this.hasSeqNext)&&(n.assessInfo.displaymethod!=="livepoll"||this.state===2)},showNext(){return this.buttonsOk&&!this.showSubmit&&n.assessInfo.displaymethod==="skip"&&this.qn<n.assessInfo.questions.length-1},submitClass(){return n.assessInfo.submitby==="by_assessment"||!this.questionData.canretry_primary?"secondary":"primary"},showScore(){return n.inProgress&&!n.inPrintView&&!this.disabled&&this.questionData.hadSeqNext!==!0&&(this.questionData.hasOwnProperty("score")||this.questionData.status==="attempted")&&(this.questionData.try>0||this.questionData.hasOwnProperty("tries_remaining_range"))&&this.questionData.withdrawn===0},showResults(){return n.assessInfo.show_results},submitLabel(){let e="question.";return n.assessInfo.submitby==="by_question"?e+="submit":n.assessInfo.showscores==="during"?e+="checkans":e+="saveans",this.hasSeqNext?e+="_seqnext":this.hasSubmitAll&&(e+="_submitall"),this.$t(e)},showHelps(){return n.assessInfo.hasOwnProperty("help_features")&&(n.assessInfo.help_features.message===!0||n.assessInfo.help_features.forum>0)||this.questionData.jsparams&&this.questionData.jsparams.helps.length>0},errorsToShow(){let e=[];return n.assessInfo.hasOwnProperty("scoreerrors")&&n.assessInfo.scoreerrors.hasOwnProperty(this.qn)&&(e=e.concat(n.assessInfo.scoreerrors[this.qn])),this.questionData.hasOwnProperty("errors")&&(e=e.concat(this.questionData.errors)),e},showWork(){return this.getwork===1&&n.assessInfo.questions[this.qn].showwork&1||this.getwork===2&&n.assessInfo.questions[this.qn].showwork&2}},methods:{loadQuestionIfNeeded(e){this.questionContentLoaded&&!this.loadingAttempted&&(this.loadingAttempted=this.questionContentLoaded),!this.questionContentLoaded&&!this.loadingAttempted&&this.active&&n.errorMsg===null?(this.loadingAttempted=!0,A.loadQuestion(this.qn,!1,!1)):this.questionContentLoaded&&this.active&&!this.questionData.rendered&&e!==!0&&this.renderAndTrack()},submitQuestion(){A.submitQuestion(this.qn,!1),n.timeActive[this.qn]=0,n.timeActivated[this.qn]=new Date},jumpToAnswer(){n.confirmObj={body:"question.jump_warn",action:()=>A.loadQuestion(this.qn,!1,!0)}},updateTime(e){if(!n.timeActivated.hasOwnProperty(this.qn)||e)n.timeActivated[this.qn]=new Date;else if(n.timeActivated.hasOwnProperty(this.qn)){const t=new Date;n.timeActive[this.qn]+=t-n.timeActivated[this.qn],delete n.timeActivated[this.qn]}},addDirtyTrackers(){window.$("#questionwrap"+this.qn).find("input[name],select[name],textarea[name]").off("focus.dirtytrack").off("change.dirtytrack").off("input.dirtytrack").on("focus.dirtytrack",function(){this.type==="radio"||this.type==="checkbox"||window.$(this).attr("data-lastval",window.$(this).val())}).on("input.dirtytrack",function(){n.somethingDirty=!0}).on("change.dirtytrack",function(){const e=window.$(this).val().trim();let t=!1;if((this.type==="radio"||this.type==="checkbox"||e!==window.$(this).attr("data-lastval")&&(e!==""||window.$(this).attr("data-lastval").trim()!==""))&&(t=!0),t){n.somethingDirty=!0;const s=window.$(this).attr("name").match(/^(qs|qn|tc)(\d+)/);if(s!==null){var i=s[2]*1,r=0;i>=1e3&&(r=i%1e3,i=Math.floor(i/1e3+.001)-1);const o=new Date,u=n.timeActive[i]+(o-n.timeActivated[i]);A.doAutosave(i,r,u)}}})},disableOutOfTries(){const e=this.questionData.tries_max;let t=0;for(const r in this.questionData.jsparams)r.match(/^\d+$/)&&t++;for(const r in this.questionData.parts){var i;this.questionData.parts[r].try>=e&&this.questionData.answeights[r]>0&&(Object.keys(this.questionData.parts).length===1&&t>1?i=new RegExp("^(qn|tc|qs)("+this.qn+"\\b|"+(this.qn+1)+"\\d{3}\\b)"):parseInt(r)===0?i=new RegExp("^(qn|tc|qs)("+this.qn+"\\b|"+((this.qn+1)*1e3+r*1)+"\\b)"):i=new RegExp("^(qn|tc|qs)"+((this.qn+1)*1e3+r*1)+"\\b"),window.$("#questionwrap"+this.qn).find("input,select,textarea").each(function(a,s){s.name.match(i)&&(s.disabled=!0)}))}},renderAndTrack(){this.questionData.rendered||!this.active||(setTimeout(window.drawPics,100),window.initlinkmarkup(this.$refs.thisqwrap),window.rendermathnode(this.$refs.thisqwrap),window.initSageCell(this.$refs.thisqwrap),window.setupSeqPartToggles(this.$refs.thisqwrap),this.updateTime(!0),this.setInitValues(),n.timeActive[this.qn]+=A.getInitTimeactive(this.qn),this.addDirtyTrackers(),this.work=this.questionData.work,window.$("#questionwrap"+this.qn).find(".seqsep").attr("aria-level",n.assessInfo.displaymethod==="full"?3:2),this.disabled&&window.$("#questionwrap"+this.qn).find("input,select,textarea").each(function(e,t){t.name.match(/^(qn|tc|qs)\d/)&&(t.disabled=!0)}),window.imathasAssess.init(this.questionData.jsparams,n.enableMQ,this.$refs.thisqwrap),setTimeout(window.sendLTIresizemsg,100),A.setRendered(this.qn,!0))},setInitValues(){var e=/^(qn|tc|qs)\d/,t=this.qn;window.$("#questionwrap"+this.qn).find("input,select,textarea").each(function(i,r){r.name.match(e)&&(r.type==="radio"||r.type==="checkbox"?r.checked&&A.setInitValue(t,r.name,r.value):A.setInitValue(t,r.name,window.$(r).val()))}),this.showWork&&(A.setInitValue(t,"sw"+this.qn,this.questionData.work),this.work=this.questionData.work)},updateWork(e){this.work=e},workChanged(){if(this.work!==this.lastWorkVal)if(n.work[this.qn]=this.work,this.getwork===1){const e=new Date,t=n.timeActive[this.qn]+(e-n.timeActivated[this.qn]);A.doAutosave(this.qn,"sw",t)}else this.getwork===2&&this.$emit("workchanged",this.work)},workFocused(){this.lastWorkVal=this.work},trySimilar(){A.loadQuestion(this.qn,!0)}},updated(){this.questionContentLoaded?(this.disableOutOfTries(),this.renderAndTrack()):this.loadQuestionIfNeeded()},created(){this.loadQuestionIfNeeded(!0),n.timeActive.hasOwnProperty(this.qn)||(n.timeActive[this.qn]=0)},mounted(){this.questionContentLoaded&&(this.disableOutOfTries(),this.renderAndTrack())},beforeUnmount(){A.setRendered(this.qn,!1)},watch:{active:function(e,t){this.loadQuestionIfNeeded(),this.updateTime(e),e===!1&&St(this.$refs.main)},state:function(e,t){(e>1&&t<=1||e===4&&t<4||e===3&&t===4)&&A.loadQuestion(this.qn,!1,!1)},qn:function(e,t){A.setRendered(t,!1)},seed:function(e,t){A.loadQuestion(this.qn,!1,!1)}}},pa={class:"questionwrap questionpane",ref:"main"},ma={key:0},_a={key:2,class:"scoreresult neutral",tabindex:"-1"},wa={key:3,class:"noticetext"},ga={key:4,class:"small"},ya=["innerHTML","id"],ba={key:7},va={key:8,class:"submitbtnwrap"},ka=["disabled"],qa={class:"sr-only"},Ia=["disabled"],Aa={key:9,class:"submitbtnwrap"},Pa=["onClick","onKeypress","disabled"];function Ta(e,t,i,r,a,s){const o=v("score-result"),u=v("icons"),f=v("question-helps"),_=v("showwork-input"),m=v("router-link");return l(),c("div",pa,[s.questionContentLoaded?w("",!0):(l(),c("div",ma,d(e.$t("loading")),1)),s.showScore&&s.showResults?(l(),T(o,{key:1,qdata:s.questionData,qn:i.qn},null,8,["qdata","qn"])):s.showScore&&s.questionData.canregen?(l(),c("div",_a,[h("button",{type:"button",onClick:t[0]||(t[0]=(...p)=>s.trySimilar&&s.trySimilar(...p))},[k(u,{name:"retake",alt:""}),q(" "+d(e.$t("scoreresult.trysimilar")),1)])])):w("",!0),s.questionData.withdrawn!==0?(l(),c("p",wa,[k(u,{name:"alert",color:"warn",size:"medium"}),q(" "+d(e.$t("question.withdrawn")),1)])):w("",!0),s.errorsToShow.length>0?(l(),c("div",ga,[h("ul",null,[(l(!0),c(H,null,U(s.errorsToShow,(p,g)=>(l(),c("li",{key:g},d(p),1))),128))])])):w("",!0),s.questionContentLoaded?(l(),c("div",{key:5,innerHTML:s.questionData.html,class:"question",id:"questionwrap"+i.qn,ref:"thisqwrap"},null,8,ya)):w("",!0),s.showHelps?(l(),T(f,{key:6,qn:i.qn},null,8,["qn"])):w("",!0),s.showWork&&s.questionContentLoaded?(l(),c("div",ba,[i.getwork!==2?(l(),c("button",{key:0,onClick:t[1]||(t[1]=p=>e.showWorkInput=!e.showWorkInput)},d(e.showWorkInput?e.$t("work.hide"):e.$t("work.add")),1)):w("",!0),ie(h("div",null,[k(_,{id:"sw"+i.qn,qn:i.qn,value:s.questionData.work,rows:"3",active:i.getwork===2||e.showWorkInput,onInput:s.updateWork,onBlur:s.workChanged,onFocus:s.workFocused},null,8,["id","qn","value","active","onInput","onBlur","onFocus"])],512),[[ae,i.getwork===2||e.showWorkInput]])])):w("",!0),s.showSubmit?(l(),c("div",va,[h("button",{type:"button",onClick:t[2]||(t[2]=(...p)=>s.submitQuestion&&s.submitQuestion(...p)),class:z(s.submitClass),disabled:!s.canSubmit},[q(d(s.submitLabel)+" ",1),h("span",qa,d(e.$t("question_n",{n:i.qn+1})),1)],10,ka),s.canJumpToAnswer?(l(),c("button",{key:0,type:"button",onClick:t[3]||(t[3]=(...p)=>s.jumpToAnswer&&s.jumpToAnswer(...p)),class:"secondary",disabled:!s.canSubmit},d(e.$t("question.jump_to_answer")),9,Ia)):w("",!0)])):s.showNext?(l(),c("div",Aa,[k(m,{to:"/skip/"+(this.qn+2),custom:""},{default:L(({navigate:p})=>[h("button",{type:"button",onClick:p,onKeypress:X(p,["enter"]),role:"link",class:"secondarybtn",disabled:!s.canSubmit},[k(u,{name:"right"}),q(" "+d(e.$t("question.next")),1)],40,Pa)]),_:1},8,["to"])])):w("",!0)],512)}const we=x(fa,[["render",Ta]]),Sa={name:"QuestionDetailPane",props:["qn","className","id"],components:{QuestionDetailsTable:Ft,PenaltiesApplied:Pt},computed:{qinfo(){return n.assessInfo.questions[this.qn]},hasParts(){return this.qinfo.hasOwnProperty("parts")&&this.qinfo.parts.length>1&&this.qinfo.withdrawn===0&&this.qinfo.parts[0].hasOwnProperty("points_possible")&&!this.qinfo.singlescore},hasOnePartPenalties(){return this.qinfo.hasOwnProperty("parts")&&this.qinfo.parts.length===1&&this.qinfo.parts[0].hasOwnProperty("penalties")&&this.qinfo.parts[0].penalties.length>0},showScore(){return this.qinfo.hasOwnProperty("score")},showGBScore(){return this.qinfo.hasOwnProperty("gbscore")},gbScoreString(){return n.assessInfo.in_practice?this.$t("qdetails.bestpractice"):this.$t("qdetails.gbscore")},hasCategory(){return n.assessInfo.showcat===1&&this.qinfo.hasOwnProperty("category")&&this.qinfo.category!==""&&this.qinfo.category!==null},submitby(){return n.assessInfo.submitby},licenseUrl(){return window.imasroot+"/course/showlicense.php?id="+this.qinfo.questionsetid}}},Oa={class:"pane-header nowrap"},xa={class:"pane-body"},$a={key:0},Ea={key:1},Ca={class:"nowrap"},Da={key:2},Ra={class:"nowrap"},Qa={key:4},La={key:5},Ma={class:"small subdued",style:{"text-align":"right"}},Na=["href"];function ja(e,t,i,r,a,s){const o=v("question-details-table"),u=v("penalties-applied");return l(),c("div",null,[h("div",Oa,d(e.$t("qdetails.question_details")),1),h("div",xa,[s.qinfo.extracredit===1?(l(),c("p",$a,d(e.$t("qdetails.extracredit")),1)):w("",!0),s.showGBScore?(l(),c("p",Ea,[q(d(s.gbScoreString)+": ",1),h("span",Ca,d(e.$t("scoreresult.scorepts",s.qinfo.points_possible,{pts:s.qinfo.gbscore,poss:s.qinfo.points_possible})),1)])):w("",!0),s.showScore?(l(),c("p",Da,[q(d(e.$t("qdetails.lastscore"))+": ",1),h("span",Ra,d(e.$t("scoreresult.scorepts",s.qinfo.points_possible,{pts:s.qinfo.score,poss:s.qinfo.points_possible})),1)])):w("",!0),s.hasParts?(l(),T(o,{key:3,caption:e.$t("qdetails.lasttry"),qinfo:s.qinfo,submitby:s.submitby},null,8,["caption","qinfo","submitby"])):w("",!0),s.hasOnePartPenalties?(l(),c("div",Qa,[h("p",null,d(e.$t("penalties.applied"))+":",1),k(u,{class:"med-left",part:s.qinfo.parts[0],submitby:s.submitby},null,8,["part","submitby"])])):w("",!0),s.hasCategory?(l(),c("p",La,[h("strong",null,d(e.$t("qdetails.category"))+":",1),q(" "+d(s.qinfo.category),1)])):w("",!0),h("p",Ma,[h("a",{target:"license",href:s.licenseUrl},d(e.$t("qdetails.license")),9,Na)])])])}const Va=x(Sa,[["render",ja]]),Ba={name:"Dropdown",props:["id","position","tip"],components:{TooltipSpan:Pe},data:function(){return{open:!1,closetimer:null}},methods:{triggerOpen(e){typeof e=="boolean"?this.open=e:this.open=!this.open,this.open?this.$nextTick(()=>{this.$refs.pane.style.right="",this.$refs.pane.style.left="";const t=this.$refs.pane.getBoundingClientRect(),i=document.documentElement.clientWidth;t.right>i?this.$refs.pane.style.right="12px":t.left<0&&(this.$refs.pane.style.left="12px")}):this.$refs.button.focus()},handleFocusout(){this.closetimer=setTimeout(()=>{this.open=!1},50)},handleFocusin(){clearTimeout(this.closetimer)}}},Fa=["id","aria-controls","aria-expanded"],Ga=["id"];function Ha(e,t,i,r,a,s){const o=v("tooltip-span");return l(),c("span",{onKeydown:t[3]||(t[3]=X(u=>s.triggerOpen(!1),["esc"])),class:"dropdown-wrap",onFocusin:t[4]||(t[4]=(...u)=>s.handleFocusin&&s.handleFocusin(...u)),onFocusout:t[5]||(t[5]=(...u)=>s.handleFocusout&&s.handleFocusout(...u))},[k(o,{show:!e.open&&i.tip,tip:i.tip},{default:L(()=>[h("span",{id:i.id,ref:"button",role:"button",tabindex:"0",onClick:t[0]||(t[0]=(...u)=>s.triggerOpen&&s.triggerOpen(...u)),onKeydown:[t[1]||(t[1]=X(se((...u)=>s.triggerOpen&&s.triggerOpen(...u),["prevent"]),["enter"])),t[2]||(t[2]=X(se((...u)=>s.triggerOpen&&s.triggerOpen(...u),["prevent"]),["space"]))],class:"dropdown-button noselect","aria-controls":i.id+"_pane","aria-expanded":e.open?"true":"false"},[pe(e.$slots,"button")],40,Fa)]),_:3},8,["show","tip"]),k(Tt,{name:"fade"},{default:L(()=>[e.open?(l(),c("div",{key:0,class:"dropdown-pane",id:i.id+"_pane",ref:"pane"},[pe(e.$slots,"default")],8,Ga)):w("",!0)]),_:3})],32)}const Ht=x(Ba,[["render",Ha]]),Ua={name:"QuestionHeaderIcons",props:["showscore","curQData","qn","showretry"],components:{Dropdown:Ht,Icons:B,QuestionDetailsPane:Va,TooltipSpan:Pe},computed:{dispqn(){return parseInt(this.qn)+1},scoreDisplay(){return this.dispqn===0?"":this.showscore&&this.curQData.hasOwnProperty("gbscore")&&this.curQData.tries_max>1?this.curQData.gbscore+"/"+this.$t("header.pts",this.curQData.points_possible):this.$t("header.pts",this.curQData.points_possible)},scoreTip(){return this.showscore&&this.curQData.hasOwnProperty("gbscore")&&this.curQData.tries_max>1?this.$t("qdetails.gbscore"):this.$t("header.possible",this.curQData.points_possible)},retryInfo(){if(this.qn<0)return{};let e,t;if(this.curQData.hasOwnProperty("tries_remaining_range")){const i=this.curQData.tries_remaining_range;e=this.$t("qinfo.tries_remaining_range",{min:i[0],max:i[1]}),t=i[0]+"-"+i[1]}else e=this.$t("qinfo.tries_remaining",this.curQData.tries_remaining),t=this.curQData.tries_remaining;return{msg:e,cnt:t}},showDetails(){if(this.qn<0)return!1;const e=this.curQData.hasOwnProperty("category")&&this.curQData.category!=="";return this.curQData.has_details||e||this.curQData.hasOwnProperty("gbscore")}}},Wa={class:"headericons"};function Ka(e,t,i,r,a,s){const o=v("icons"),u=v("tooltip-span"),f=v("question-details-pane"),_=v("dropdown");return l(),c("div",Wa,[s.scoreDisplay!==""?(l(),T(u,{key:0,tip:s.scoreTip,tabindex:"0"},{default:L(()=>[k(o,{name:"square-check",alt:"qdetails.gbscore"}),q(" "+d(s.scoreDisplay),1)]),_:1},8,["tip"])):w("",!0),i.qn>=0&&i.curQData.canretry&&i.showretry!==!1?(l(),T(u,{key:1,tip:s.retryInfo.msg,tabindex:"0"},{default:L(()=>[k(o,{name:"retry"}),q(" "+d(s.retryInfo.cnt),1)]),_:1},8,["tip"])):w("",!0),i.qn>=0&&i.curQData.canregen&&i.showretry!==!1?(l(),T(u,{key:2,tip:e.$t("qinfo.regens_remaining",i.curQData.regens_remaining),tabindex:"0"},{default:L(()=>[k(o,{name:"retake"}),q(" "+d(i.curQData.regens_remaining),1)]),_:1},8,["tip"])):w("",!0),s.showDetails?(l(),T(_,{key:3,id:"qd-dd-"+i.qn,class:"question-details"},{button:L(()=>[k(o,{name:"info",size:"medium"}),q(" "+d(e.$t("header.details")),1)]),default:L(()=>[k(f,{qn:i.qn},null,8,["qn"])]),_:1},8,["id"])):w("",!0)])}const Ut=x(Ua,[["render",Ka]]),$e={computed:{qsAttempted(){const e=[];for(const t in n.assessInfo.questions)e[t]=0,n.assessInfo.submitby==="by_assessment"&&n.assessInfo.questions[t].tries_max===1&&n.assessInfo.questions[t].hasOwnProperty("parts_entered")&&n.assessInfo.questions[t].hasOwnProperty("answeights")?n.assessInfo.questions[t].parts_entered.length>=n.assessInfo.questions[t].answeights.length?e[t]=1:n.assessInfo.questions[t].parts_entered.length>0&&(e[t]=.5):n.assessInfo.questions[t].try>0&&(e[t]=1);return e}}},za={name:"SkipQuestionHeader",props:["qn","showretry"],components:{QuestionHeaderIcons:Ut,Icons:B},mixins:[$e],data:function(){return{}},computed:{ainfo(){return n.assessInfo},curQData(){return n.assessInfo.questions[this.qn]},dispqn(){return parseInt(this.qn)+1},statusIcon(){if(this.dispqn===0)return"none";if(this.curQData.status==="unattempted"){if(this.qsAttempted[this.qn]===1)return"attempted";if(this.qsAttempted[this.qn]>0)return"partattempted"}return this.curQData.status},nameHover(){return this.curQData.withdrawn!==0?this.$t("header.withdrawn"):""}}},Ja={class:"full-question-header"},Ya={style:{"flex-grow":"1"}},Xa={key:0,class:"small subdued"};function Za(e,t,i,r,a,s){const o=v("icons"),u=v("question-header-icons");return l(),c("div",Ja,[h("div",Ya,[k(o,{name:s.statusIcon,class:"qstatusicon"},null,8,["name"]),h("h2",{class:z({inlineheader:!0,greystrike:s.curQData.withdrawn!==0})},[q(d(e.$t("question_n",{n:s.dispqn}))+" ",1),s.curQData.extracredit?(l(),c("em",Xa,d(e.$t("extracredit")),1)):w("",!0)],2)]),k(u,{showscore:!0,curQData:s.curQData,qn:i.qn,showretry:i.showretry},null,8,["curQData","qn","showretry"])])}const Te=x(za,[["render",Za]]),eo={name:"SummaryReshowQuestions",props:["active"],components:{Question:we,FullQuestionHeader:Te},computed:{questions(){return n.assessInfo.questions}}};function to(e,t,i,r,a,s){const o=v("full-question-header"),u=v("question");return l(),c("div",null,[(l(!0),c(H,null,U(s.questions,(f,_)=>(l(),c("div",{key:_},[k(o,{qn:_,showretry:!1},null,8,["qn"]),(l(),T(u,{qn:_,key:"sq"+_,active:i.active,disabled:!0},null,8,["qn","active"]))]))),128))])}const so=x(eo,[["render",to]]),no={name:"VueTabs",props:["id"],data:function(){return{activeTabHash:"",tabs:[]}},provide(){return{addTab:e=>{this.tabs.push(e)===1&&(this.activeTabHash=e.hash)},activeTabHash:te(()=>this.activeTabHash)}},methods:{setActive(e){this.activeTabHash=this.tabs[e].hash,this.$nextTick(()=>{document.getElementById(this.tabs[e].hash).focus()})},setFocus(e){this.$refs.tab[e].focus()},handleKey(e,t){const i=this.tabs.length,r=e.key.toLowerCase();let a=!1;r==="enter"||r===" "?(this.setActive(t),a=!0):r==="arrowleft"?(this.setFocus((t-1+i)%i),a=!0):r==="arrowright"?(this.setFocus((t+1)%i),a=!0):r==="home"?(this.setFocus(0),a=!0):r==="end"&&(this.setFocus(i-1),a=!0),a&&(e.preventDefault(),e.stopPropagation())}}},io=["id"],ro=["aria-selected","onClick","onKeydown","aria-controls","id"];function ao(e,t,i,r,a,s){return l(),c("div",null,[h("ul",{class:"vuetablist",id:i.id},[(l(!0),c(H,null,U(e.tabs,(o,u)=>(l(),c("li",{key:u,class:z({active:o.hash===e.activeTabHash}),"aria-selected":o.hash===e.activeTabHash,ref_for:!0,ref:"tab",tabindex:"0",onClick:f=>s.setActive(u),onKeydown:f=>s.handleKey(f,u),"aria-controls":o.hash,id:o.hash+"_tab"},d(o.name),43,ro))),128))],8,io),pe(e.$slots,"default",{ref:"slot"})])}const oo=x(no,[["render",ao]]),lo={name:"VueTab",data:function(){return{active:!1,delayedactive:!1,hash:""}},props:["name"],inject:["addTab","activeTabHash"],created(){this.hash="vuetab_"+this.name.toLowerCase().replace(/ /g,"-"),this.addTab({name:this.name,hash:this.hash})},watch:{activeTabHash(){this.active=this.activeTabHash===this.hash,this.active?this.$nextTick(()=>{this.delayedactive=!0}):this.delayedactive=!1}}},uo=["id","aria-labelledby"];function co(e,t,i,r,a,s){return ie((l(),c("div",{tabindex:"0",id:e.hash,"aria-labelledby":e.hash+"_tab",class:"vuetabpanel"},[pe(e.$slots,"default",{active:e.delayedactive})],8,uo)),[[ae,e.active]])}const ho=x(lo,[["render",co]]),fo={name:"Summary",components:{SummaryHeader:Zi,SummaryScoreTotal:or,SummaryGbScore:et,SummaryScoreList:Or,SummaryCategories:ns,SummaryReshowQuestions:so,SummaryDiagInfo:Rr,PreviousAttempts:Ze,VueTabs:oo,VueTab:ho},data:function(){return{activeTab:0}},computed:{ainfo(){return n.assessInfo},hasScore(){return n.assessInfo.hasOwnProperty("score")},showTotal(){return this.ainfo.showscores!=="none"},showScores(){return this.ainfo.showscores==="during"||this.ainfo.showscores==="at_end"},showReviewQ(){return this.ainfo.questions&&this.ainfo.questions[0].html!==null},hasCategories(){let e=!1;if(!this.showScores)return!1;for(const t in this.ainfo.questions)if(this.ainfo.questions[t].hasOwnProperty("category")&&this.ainfo.questions[t].category!==""&&this.ainfo.questions[t].category!==null){e=!0;break}return e}},methods:{loadScoresIfNeeded(){this.hasScore||A.getScores()}},created(){this.loadScoresIfNeeded()},updated(){this.loadScoresIfNeeded()}},po={class:"home"},mo={class:"flexpanes"},_o={style:{"flex-grow":"1"}},wo=["innerHTML"],go={key:1},yo={id:"excusedlist"},bo={key:2},vo={key:0};function ko(e,t,i,r,a,s){const o=v("summary-header"),u=v("summary-diag-info"),f=v("summary-score-total"),_=v("summary-score-list"),m=v("summary-categories"),p=v("vue-tab"),g=v("summary-reshow-questions"),y=v("vue-tabs"),O=v("summary-gb-score"),E=v("previous-attempts");return l(),c("div",po,[k(o,{class:"headerpane"}),h("div",mo,[h("div",_o,[k(u),k(f),s.ainfo.hasOwnProperty("endmsg")&&s.ainfo.endmsg!=""?(l(),c("div",{key:0,innerHTML:s.ainfo.endmsg,class:"introtext"},null,8,wo)):w("",!0),s.ainfo.hasOwnProperty("newexcused")&&Object.keys(s.ainfo.newexcused).length>0?(l(),c("div",go,[h("p",null,d(e.$t("summary.new_excused")),1),h("ul",yo,[(l(!0),c(H,null,U(s.ainfo.newexcused,(M,j)=>(l(),c("li",{key:j},d(M),1))),128))])])):w("",!0),s.showScores?(l(),c("div",bo,[k(y,{id:"scoretabs"},{default:L(()=>[k(p,{name:e.$t("summary.scorelist")},{default:L(()=>[k(_),t[0]||(t[0]=h("p",null," ",-1)),s.hasCategories?(l(),T(m,{key:0,data:s.ainfo.questions},null,8,["data"])):w("",!0)]),_:1},8,["name"]),s.showReviewQ?(l(),T(p,{key:0,name:e.$t("summary.reshowquestions")},{default:L(({active:M})=>[k(g,{active:M},null,8,["active"])]),_:1},8,["name"])):w("",!0)]),_:1})])):w("",!0)]),s.ainfo.hasOwnProperty("prev_attempts")&&s.ainfo.prev_attempts.length>0?(l(),c("div",vo,[k(O),k(E,{caption:e.$t("prev.all_attempts")},null,8,["caption"])])):w("",!0)])])}const qo=x(fo,[["render",ko]]),Io={name:"Timer",props:["end","total","grace"],components:{Icons:B},data:function(){return{hours:0,minutes:0,seconds:0,timeString:"",interval:null,open:!0,gaveWarning:!1}},created(){this.updateTimer(),this.interval=setInterval(this.updateTimer,1e3)},mounted(){var e=window.$("#timerbox"),t=e.offset();window.$(window).scroll(function(){var i=window.$(window).scrollTop();i>=t.top?e.addClass("sticky"):e.removeClass("sticky")})},beforeUnmount(){clearInterval(this.interval)},computed:{warningTime(){return Math.max(60,Math.min(.05*this.total,300))}},methods:{updateTimer:function(){const e=new Date().getTime();this.timeString="";let t=Math.max(0,this.end-e);t===0&&this.grace>0&&(t=Math.max(0,this.grace-e),this.timeString+=this.$t("timer.overtime")+" "),!this.gaveWarning&&t<this.warningTime*1e3&&(this.open=!0,this.gaveWarning=!0),this.hours=Math.floor(t/(1e3*60*60)),this.minutes=Math.floor(t%(1e3*60*60)/(1e3*60)),this.seconds=Math.floor(t%(1e3*60)/1e3),this.hours===0&&this.minutes<5?(this.timeString+=this.hours>0?this.hours+":":"",this.timeString+=(this.minutes<10?"0":"")+this.minutes+":",this.timeString+=(this.seconds<10?"0":"")+this.seconds):(this.timeString+=this.hours>0?this.hours+this.$t("timer.hrs",this.hours):"",this.timeString+=this.minutes>0?this.minutes+this.$t("timer.min",this.minutes):"")},toggleShow:function(){this.open=!this.open}}},Ao={key:2,class:"sronly"};function Po(e,t,i,r,a,s){const o=v("icons");return l(),c("button",{type:"button",class:"plain",id:"timerbox",onClick:t[0]||(t[0]=(...u)=>s.toggleShow&&s.toggleShow(...u))},[k(o,{name:"timer",size:"small"}),e.open?(l(),c("span",{key:0,class:z({noticetext:e.hours===0&&60*e.minutes+e.seconds<s.warningTime})},d(e.timeString),3)):w("",!0),e.open?(l(),T(o,{key:1,name:"close",size:"small",color:"subdued"})):(l(),c("span",Ao,d(e.$t("timer.show")),1))])}const Wt=x(Io,[["render",Po]]),To={name:"Summary",components:{Question:we,FullQuestionHeader:Te,ShowworkInput:Gt,Timer:Wt},data:function(){return{loaded:!1,duringAssess:!1,work:{}}},computed:{ainfo(){return n.assessInfo},mode(){return n.inAssess?"aftertake":"gb"},readyToShow(){return this.mode==="gb"&&n.assessInfo.hasOwnProperty("questions")||this.mode==="aftertake"&&n.assessInfo.hasOwnProperty("score")},hasScore(){return n.assessInfo.hasOwnProperty("score")},questions(){var e={};for(var t in n.assessInfo.questions)n.assessInfo.questions[t].showwork&2&&(e[t]=n.assessInfo.questions[t]);return e},saveLabel(){return n.inAssess?this.$t("work.save_continue"):this.$t("work.save")}},methods:{loadScoresIfNeeded(){this.mode==="gb"&&!this.readyToShow?A.getQuestions():this.mode==="aftertake"&&!this.readyToShow&&A.getScores()},workChanged(e,t){n.work[e]=t},save(){A.submitWork()}},created(){this.loadScoresIfNeeded()},updated(){this.loadScoresIfNeeded()}},So={class:"home"},Oo={class:"assess-header headerpane"},xo={style:{"flex-grow":"1"}},$o={key:0},Eo={key:0},Co={key:1},Do={key:1};function Ro(e,t,i,r,a,s){const o=v("timer"),u=v("full-question-header"),f=v("question"),_=v("showwork-input");return l(),c("div",So,[h("div",Oo,[h("div",xo,[h("h1",null,d(e.$t("work.add"))+": "+d(s.ainfo.name),1)]),s.ainfo.showwork_cutoff>0?(l(),T(o,{key:0,total:s.ainfo.showwork_cutoff*60,end:s.ainfo.showwork_local_cutoff_expires,grace:0},null,8,["total","end"])):w("",!0),h("div",null,[h("button",{onClick:t[0]||(t[0]=(...m)=>s.save&&s.save(...m)),class:"primary"},d(s.saveLabel),1)])]),s.readyToShow?(l(),c("div",$o,[s.ainfo.showwork_cutoff>0?(l(),c("p",Eo,d(e.$t("work.duein",{date:s.ainfo.showwork_cutoff_expires_disp})),1)):w("",!0),s.questions.length===0?(l(),c("p",Co,d(e.$t("work.noquestions")),1)):w("",!0),(l(!0),c(H,null,U(s.questions,(m,p)=>(l(),c("div",{key:p},[k(u,{qn:p,showretry:!1},null,8,["qn"]),m.html!==null?(l(),T(f,{qn:p,key:"sq"+p,active:!0,disabled:!0,getwork:2,onWorkchanged:g=>s.workChanged(p,g)},null,8,["qn","onWorkchanged"])):(l(),c("div",Do,[k(_,{id:"sw"+p,qn:p,value:m.work,rows:"3",onInput:g=>s.workChanged(p,g)},null,8,["id","qn","value","onInput"])]))]))),128)),h("div",null,[h("button",{onClick:t[1]||(t[1]=(...m)=>s.save&&s.save(...m)),class:"primary"},d(s.saveLabel),1)])])):w("",!0)])}const Qo=x(To,[["render",Ro]]),Lo={name:"ResourcePane",props:["showicon"],components:{Icons:B},computed:{assessResources(){return n.assessInfo.resources},docEl(){return window.document.documentElement}},methods:{popout(e){window.GB_show(e.label,e.link,760,"auto",!1,"left",["skip-question-header","assess-header","resource-dropdown"])}}},Mo={key:0,id:"resource-pane"},No={class:"pane-header"},jo={class:"pane-body"},Vo={style:{"flex-grow":"1","margin-right":"12px"}},Bo=["onClick","title","aria-label"],Fo=["href","target","title","aria-label"];function Go(e,t,i,r,a,s){const o=v("icons");return s.assessResources.length>0?(l(),c("div",Mo,[h("div",No,[i.showicon?(l(),T(o,{key:0,name:"file"})):w("",!0),t[0]||(t[0]=q(" Resources ",-1))]),h("div",jo,[(l(!0),c(H,null,U(s.assessResources,(u,f)=>(l(),c("div",{key:f,class:"flexrow"},[h("span",Vo,d(u.label),1),h("button",{onClick:_=>s.popout(u),class:"min1000",title:e.$t("resource.sidebar"),"aria-label":e.$t("resource.sidebar")+" "+u.label},[k(o,{name:"sidebar",alt:""})],8,Bo),h("a",{class:"abutton",href:u.link,target:"res"+f,title:e.$t("resource.newtab"),"aria-label":e.$t("resource.newtab")+" "+u.label},[k(o,{name:"extlink",alt:""})],8,Fo)]))),128))])])):w("",!0)}const Kt=x(Lo,[["render",Go]]),Ho={name:"LtiMenu",components:{MenuButton:ze,Icons:B},computed:{LtiOptions(){const e=[];return e.push({label:this.$t("lti.userprefs"),onclick:()=>{window.GB_show(this.$t("lti.userprefs"),n.APIbase+"../admin/ltiuserprefs.php?cid="+n.cid+"&greybox=true",800,"auto",!0,0,0,{label:"Update Info",func:"doSubmit"})}}),n.assessInfo.in_practice&&n.assessInfo.prev_attempts.length>0&&e.push({label:this.$t("closed.view_scored"),link:n.APIbase+"gbviewassess.php?cid="+n.cid+"&aid="+n.aid+"&uid="+n.uid,target:"_self"}),n.assessInfo.can_use_latepass&&e.push({label:this.$t("lti.use_latepass"),link:n.APIbase+"../course/redeemlatepass.php?cid="+n.cid+"&aid="+n.aid,target:"_self"}),e}}};function Uo(e,t,i,r,a,s){const o=v("icons"),u=v("menu-button");return l(),T(u,{options:s.LtiOptions,position:"right",nobutton:"true",noarrow:"true",searchby:"label",id:"ltimenubutton",header:e.$t("lti.more")},{button:L(()=>[k(o,{name:"more",size:"medium"})]),_:1},8,["options","header"])}const Wo=x(Ho,[["render",Uo]]),Ko={name:"BadgedIcon",props:["link","icon","label","cnt"],components:{Icons:B,TooltipSpan:Pe},computed:{msglink(){return n.APIbase+"../msgs/msglist.php?cid="+n.cid},msgcnt(){return n.assessInfo.lti_msgcnt}}},zo=["href","aria-label"],Jo={key:0,class:"badgeicon"};function Yo(e,t,i,r,a,s){const o=v("icons"),u=v("tooltip-span");return l(),T(u,{tip:e.$t(i.label,i.cnt),style:{display:"inline-block"},hasbutton:!0},{default:L(()=>[h("a",{href:i.link,class:"noextlink badgewrap",target:"_blank","aria-label":e.$t(i.label,i.cnt)},[k(o,{name:i.icon,size:"medium"},null,8,["name"]),i.cnt>0?(l(),c("div",Jo,d(i.cnt),1)):w("",!0)],8,zo)]),_:1},8,["tip"])}const Xo=x(Ko,[["render",Yo]]),Zo={name:"AssessHeader",components:{Icons:B,LtiMenu:Wo,Dropdown:Ht,ResourcePane:Kt,Timer:Wt,TooltipSpan:Pe,BadgedIcon:Xo},data:function(){return{resourceMenuShowing:!1}},mixins:[$e],computed:{ainfo(){return n.assessInfo},canSubmit(){return!n.inTransit},primarySubmit(){return this.ainfo.submitby==="by_assessment"&&Object.keys(n.initValues).length===this.ainfo.questions.length||this.ainfo.submitby==="by_question"&&this.qAttempted===this.ainfo.questions.length},curScorePoints(){let e=0,t=0;for(const i in this.ainfo.questions)this.ainfo.questions[i].extracredit===0&&(e+=this.ainfo.questions[i].points_possible*1),this.ainfo.show_scores_during&&this.ainfo.questions[i].hasOwnProperty("gbscore")&&(t+=this.ainfo.questions[i].gbscore*1);return t=Math.round(t*1e3)/1e3,this.ainfo.in_practice?this.$t("header.practicescore",{pts:t,poss:e}):this.ainfo.show_scores_during?this.$t("header.score",{pts:t,poss:e}):this.$t("header.possible",e)},qAttempted(){let e=0;for(let t=0;t<this.qsAttempted.length;t++)this.qsAttempted[t]===1&&e++;return e},curAnswered(){const e=this.ainfo.questions.length;return this.$t("header.answered",{n:this.qAttempted,tot:e})},assessSubmitLabel(){return this.ainfo.submitby==="by_assessment"?this.$t("header.assess_submit"):this.hasShowWorkAfter&&!this.ainfo.in_practice?this.$t("work.add"):this.ainfo.showscores==="during"?this.$t("header.done"):""},saveStatus(){return n.autoSaving?1:Object.keys(n.autosaveQueue).length===0&&!n.somethingDirty?2:3},saveStatusMsg(){return this.saveStatus===1?this.$t("header.work_saving"):this.saveStatus===2?this.$t("header.work_saved"):(this.saveStatus===3,"")},showPrint(){return this.ainfo.noprint!==1},printLink(){return window.location.pathname+window.location.search+"#/print"},MQenabled(){return n.enableMQ},hasShowWorkAfter(){let e=!1;if(n.assessInfo.hasOwnProperty("showwork_cutoff_in")&&n.assessInfo.showwork_cutoff_in<0)return!1;for(let t=0;t<n.assessInfo.questions.length;t++)if(n.assessInfo.questions[t].showwork&2){e=!0;break}return e},msglink(){return n.APIbase+"../msgs/msglist.php?cid="+n.cid},forumlink(){return n.APIbase+"../forums/thread.php?cid="+n.cid+"&forum= "+this.ainfo.help_features.forum}},methods:{handleSubmit(){this.ainfo.submitby==="by_assessment"?A.submitAssessment():A.gotoSummary()},handleSaveWork(){Object.keys(n.autosaveQueue).length===0?(n.autoSaving=!0,setTimeout(()=>{n.autoSaving=!1,n.somethingDirty=!1},300)):A.submitAutosave()},toggleMQuse(){n.enableMQ?A.disableMQ():A.enableMQ()}}},el=["aria-label"],tl={style:{"flex-grow":"1"}},sl={class:"med-left subdued"},nl={class:"flexgroup"},il=["disabled"],rl=["disabled"],al={class:"assess-header"},ol=["href","aria-label"],ll=["aria-label","aria-checked"];function ul(e,t,i,r,a,s){const o=v("timer"),u=v("icons"),f=v("resource-pane"),_=v("dropdown"),m=v("tooltip-span"),p=v("badged-icon"),g=v("lti-menu");return l(),c("div",{id:"assess-header",class:z({"assess-header":!0,headerpane:!0,practice:s.ainfo.in_practice}),role:"region","aria-label":e.$t("regions.aheader")},[h("div",tl,[h("h1",null,d(s.ainfo.name),1),h("div",null,[h("span",{class:z({practicenotice:s.ainfo.in_practice})},d(s.curScorePoints),3),t[3]||(t[3]=q()),h("span",sl,d(s.curAnswered),1)])]),s.ainfo.timelimit>0?(l(),T(o,{key:0,total:s.ainfo.timelimit,end:s.ainfo.timelimit_local_expires,grace:s.ainfo.timelimit_local_grace},null,8,["total","end","grace"])):w("",!0),h("div",nl,[s.saveStatus>0?(l(),c("span",{key:0,class:z(["noticetext",s.saveStatus===3?"sr-only":""]),"aria-live":"polite","aria-atomic":"true"},d(s.saveStatusMsg),3)):w("",!0),s.saveStatus===3?(l(),c("button",{key:1,class:"secondary",onClick:t[0]||(t[0]=(...y)=>s.handleSaveWork&&s.handleSaveWork(...y)),disabled:!s.canSubmit},d(e.$t("header.work_save")),9,il)):w("",!0),s.assessSubmitLabel!==""?(l(),c("button",{key:2,class:z({primary:s.primarySubmit,secondary:!s.primarySubmit}),onClick:t[1]||(t[1]=(...y)=>s.handleSubmit&&s.handleSubmit(...y)),disabled:!s.canSubmit},d(s.assessSubmitLabel),11,rl)):w("",!0)]),h("div",al,[s.ainfo.resources.length>0?(l(),T(_,{key:0,id:"resource-dropdown",tip:e.$t("header.resources_header")},{button:L(()=>[k(u,{name:"file",size:"medium"})]),default:L(()=>[k(f)]),_:1},8,["tip"])):w("",!0),s.showPrint?(l(),T(m,{key:1,tip:e.$t("print.print_version"),hasbutton:!0},{default:L(()=>[h("a",{href:s.printLink,class:"noextlink",target:"_blank","aria-label":e.$t("print.print_version")},[k(u,{name:"print",size:"medium"})],8,ol)]),_:1},8,["tip"])):w("",!0),k(m,{tip:e.$t("header.use_mq"),style:{display:"inline-block"},hasbutton:!0},{default:L(()=>[h("button",{onClick:t[2]||(t[2]=(...y)=>s.toggleMQuse&&s.toggleMQuse(...y)),role:"switch",class:z({plain:!0,"switch-toggle":!0}),"aria-label":e.$t("header.use_mq"),"aria-checked":s.MQenabled},[k(u,{name:s.MQenabled?"eqned":"eqnedoff",color:s.MQenabled?"#060":"#600",size:"medium"},null,8,["name","color"]),t[4]||(t[4]=h("span",{class:"switch-toggle__ui"},null,-1))],8,ll)]),_:1},8,["tip"]),s.ainfo.is_lti&&s.ainfo.lti_showmsg?(l(),T(p,{key:2,link:s.msglink,icon:"message",label:"lti.msgs",cnt:s.ainfo.lti_msgcnt},null,8,["link","cnt"])):w("",!0),s.ainfo.is_lti&&s.ainfo.help_features.forum>0?(l(),T(p,{key:3,link:s.forumlink,icon:"forum",label:"lti.forum",cnt:s.ainfo.lti_forumcnt},null,8,["link","cnt"])):w("",!0),k(g)])],10,el)}const tt=x(Zo,[["render",ul]]),cl={name:"SkipQuestionListItem",props:["option","showretry","showretake","selected"],components:{Icons:B},computed:{statusIcon(){return this.option.dispqn===0?"none":this.option.status},nameDisp(){return this.option.dispqn===0?this.$t("intro"):this.$t("question_n",{n:this.option.dispqn})},nameHover(){return this.option.withdrawn!==0?this.$t("header.withdrawn"):""},scoreDisplay(){return this.option.dispqn===0?"":this.option.hasOwnProperty("gbscore")&&this.option.tries_max>1?this.option.gbscore+"/"+this.$t("header.pts",this.option.points_possible):"("+this.$t("header.pts",this.option.points_possible)+")"}}},dl={class:"flex-nowrap-center"},hl={class:"qname-wrap"},fl=["title"],pl={key:0,class:"small subdued"},ml={key:1,class:"subdued"},_l={key:2,class:"redoicon"},wl={key:3,class:"redoicon"};function gl(e,t,i,r,a,s){const o=v("icons");return l(),c("span",dl,[i.option.dispqn>0?(l(),T(o,{key:0,name:s.statusIcon,class:"qstatusicon"},null,8,["name"])):w("",!0),h("span",hl,[h("span",{class:z({greystrike:i.option.withdrawn>0}),title:s.nameHover},[q(d(s.nameDisp)+" ",1),i.option.extracredit?(l(),c("em",pl,d(e.$t("extracredit")),1)):w("",!0)],10,fl)]),s.scoreDisplay!==""&&!i.selected?(l(),c("span",ml,d(s.scoreDisplay),1)):w("",!0),i.showretry&&!i.selected?(l(),c("span",_l,[i.option.canretry?(l(),T(o,{key:0,name:"retry"})):w("",!0)])):w("",!0),i.showretake&&!i.selected?(l(),c("span",wl,[i.option.regens_remaining?(l(),T(o,{key:0,name:"retake"})):w("",!0)])):w("",!0)])}const yl=x(cl,[["render",gl]]),bl={name:"SkipQuestionHeader",props:["qn"],components:{QuestionHeaderIcons:Ut,Icons:B,MenuButton:ze,SkipQuestionListItem:yl},mixins:[$e],data:function(){return{}},computed:{ainfo(){return n.assessInfo},curQData(){return n.assessInfo.questions[this.qn]},dispqn(){return parseInt(this.qn)+1},hasIntro(){return n.assessInfo.intro!==""||n.assessInfo.resources.length>0},navOptions(){var e=[];this.hasIntro&&e.push({internallink:"/skip/0",dispqn:0,withdrawn:0});for(const t in n.assessInfo.questions){const i=parseInt(t)+1,r={internallink:"/skip/"+i,dispqn:i};for(const a in n.assessInfo.questions[t])r[a]=n.assessInfo.questions[t][a];r.status==="unattempted"&&(this.qsAttempted[t]===1?r.status="attempted":this.qsAttempted[t]>0&&(r.status="partattempted")),e.push(r)}return e},showScore(){return this.qn>-1?n.assessInfo.questions[this.qn].hasOwnProperty("gbscore"):!1},anyHaveRetry(){for(const e in n.assessInfo.questions)if(n.assessInfo.questions[e].canretry)return!0;return!1},anyHaveRetake(){for(const e in n.assessInfo.questions)if(n.assessInfo.questions[e].regens_remaining)return!0;return!1},curOption(){return this.hasIntro?this.dispqn:this.dispqn-1},showNextPrev(){return Object.keys(this.navOptions).length>1}},methods:{changeQuestion(e){}}},vl={id:"skip-question-header"},kl={class:"flexrow wrap",style:{"flex-grow":"1"}},ql=["aria-label"],Il=["onClick","onKeypress","disabled","aria-label","title"],Al=["onClick","onKeypress","disabled","aria-label","title"];function Pl(e,t,i,r,a,s){const o=v("skip-question-list-item"),u=v("menu-button"),f=v("icons"),_=v("router-link"),m=v("question-header-icons");return l(),c("div",vl,[h("div",kl,[h("div",{id:"skip-question-select",role:"navigation","aria-label":e.$t("regions.qnav")},[k(u,{id:"qnav",options:s.navOptions,selected:s.curOption,onChange:s.changeQuestion,searchby:"dispqn"},{default:L(({option:p,selected:g})=>[k(o,{showretry:s.anyHaveRetry,showretake:s.anyHaveRetake,option:p,selected:g},null,8,["showretry","showretake","option","selected"])]),_:1},8,["options","selected","onChange"]),s.showNextPrev?(l(),T(_,{key:0,to:"/skip/"+(s.dispqn-1),custom:""},{default:L(({navigate:p})=>[h("button",{type:"button",onClick:p,onKeypress:X(p,["enter"]),role:"link",disabled:i.qn<(this.hasIntro?0:1),class:"secondarybtn",id:"qprev","aria-label":e.$t("previous"),title:e.$t("previous")},[k(f,{name:"left"})],40,Il)]),_:1},8,["to"])):w("",!0),s.showNextPrev?(l(),T(_,{key:1,to:"/skip/"+(s.dispqn+1),custom:""},{default:L(({navigate:p})=>[h("button",{type:"button",onClick:p,onKeypress:X(p,["enter"]),role:"link",disabled:i.qn>=s.ainfo.questions.length-1,class:"secondarybtn",id:"qnext","aria-label":e.$t("next"),title:e.$t("next")},[k(f,{name:"right"})],40,Al)]),_:1},8,["to"])):w("",!0)],8,ql)]),k(m,{showscore:s.showScore,curQData:s.curQData,qn:i.qn,showretry:!0},null,8,["showscore","curQData","qn"])])}const Tl=x(bl,[["render",Pl]]),Sl={name:"InterQuestionTextSkiplist",props:["qn","pos"],components:{InterQuestionText:is},computed:{lastQuestion(){return n.assessInfo.questions.length-1},showtext(){const e=[];for(const t in this.texts){const i=this.texts[t];e[t]=this.pos==="before"&&this.qn>=i.displayBefore&&this.qn<=i.displayUntil||this.pos==="after"&&this.qn===this.lastQuestion}return e},texts(){if(!n.assessInfo.hasOwnProperty("interquestion_text"))return[];const e=[];for(const t in n.assessInfo.interquestion_text){const i=n.assessInfo.interquestion_text[t];(this.pos==="before"&&i.displayBefore<=this.lastQuestion||this.pos==="after"&&i.displayBefore>this.lastQuestion)&&i.text!==""&&e.push({html:i.text,expanded:!0,displayBefore:i.displayBefore,displayUntil:i.displayUntil})}return e}}},Ol={key:0};function xl(e,t,i,r,a,s){const o=v("inter-question-text");return s.texts.length>0?(l(),c("div",Ol,[(l(!0),c(H,null,U(s.texts,(u,f)=>(l(),c("div",{key:f},[ie(k(o,{class:"questionpane introtext",textobj:u,active:s.showtext[f]},null,8,["textobj","active"]),[[ae,s.showtext[f]]])]))),128))])):w("",!0)}const $l=x(Sl,[["render",xl]]),El={name:"IntroText",components:{ResourcePane:Kt},props:["html","active"],mounted(){this.html!==""&&(setTimeout(window.drawPics,100),window.rendermathnode(this.$refs.introtext),window.initSageCell(this.$refs.introtext),window.initlinkmarkup(this.$refs.introtext))},watch:{active:function(e,t){e===!1&&this.html!==""&&St(this.$refs.introtext)}}},Cl={class:"questionpane introtext"},Dl=["innerHTML"];function Rl(e,t,i,r,a,s){const o=v("resource-pane");return ie((l(),c("div",Cl,[i.html!==""?(l(),c("div",{key:0,innerHTML:i.html,ref:"introtext"},null,8,Dl)):w("",!0),k(o,{showicon:!0,style:{display:"inline-block"}})],512)),[[ae,i.active]])}const Ee=x(El,[["render",Rl]]),Ql={name:"skip",components:{SkipQuestionHeader:Tl,Question:we,InterQuestionTextSkiplist:$l,AssessHeader:tt,IntroText:Ee,Icons:B},computed:{qn(){return parseInt(this.$route.params.qn)-1},intro(){return n.assessInfo.intro},questionArray(){const e={};for(let t=0;t<n.assessInfo.questions.length;t++)e[t]=t;return e}}},Ll={class:"home"},Ml=["aria-label"],Nl=["onClick","onKeypress"],jl=["aria-hidden"],Vl={class:"sr-only"};function Bl(e,t,i,r,a,s){const o=v("assess-header"),u=v("skip-question-header"),f=v("intro-text"),_=v("icons"),m=v("router-link"),p=v("inter-question-text-skiplist"),g=v("question");return l(),c("div",Ll,[h("a",{href:"#",class:"sr-only",id:"skipnav",onClick:t[0]||(t[0]=se(y=>e.$refs.scrollpane.focus(),["prevent"]))},d(e.$t("jumptocontent")),1),k(o),k(u,{qn:s.qn},null,8,["qn"]),h("div",{class:"scrollpane",role:"region",ref:"scrollpane",tabindex:"-1","aria-label":e.$t("regions.questions")},[k(f,{active:s.qn==-1,html:s.intro,key:"-1"},null,8,["active","html"]),s.qn==-1?(l(),T(m,{key:0,to:"/skip/1",custom:""},{default:L(({navigate:y})=>[h("button",{type:"button",onClick:y,onKeypress:X(y,["enter"]),role:"link"},[k(_,{name:"right",alt:""}),q(" "+d(e.$t("question.firstq")),1)],40,Nl)]),_:1})):w("",!0),k(p,{pos:"before",qn:s.qn},null,8,["qn"]),(l(!0),c(H,null,U(s.questionArray,y=>(l(),c("div",{key:y,class:z({inactive:y!=s.qn}),"aria-hidden":y!=s.qn},[h("h2",Vl,d(e.$t("question_n",{n:y+1})),1),k(g,{qn:y,active:y==s.qn,getwork:1},null,8,["qn","active"])],10,jl))),128)),k(p,{pos:"after",qn:s.qn},null,8,["qn"])],8,Ml)])}const Fl=x(Ql,[["render",Bl]]),Gl={name:"Full",data:function(){return{showTexts:!0}},components:{Question:we,AssessHeader:tt,FullQuestionHeader:Te,InterQuestionTextList:Je,IntroText:Ee},computed:{intro(){return n.assessInfo.intro},hasIntro(){return n.assessInfo.intro!==""||n.assessInfo.resources.length>0},isPreviewAll(){return!!n.assessInfo.preview_all},questionArray(){const e={};for(let t=0;t<n.assessInfo.questions.length;t++)e[t]=t;return e},lastQ(){return n.assessInfo.questions.length-1},showSubmit(){return n.assessInfo.submitby==="by_assessment"},textToggleLabel(){return this.showTexts?this.$t("print.hide_text"):this.$t("print.show_text")},textList(){return n.assessInfo.hasOwnProperty("interquestion_text")?n.assessInfo.interquestion_text:[]},settingsLink(){return"../course/addassessment2.php?id="+n.aid+"&cid="+n.cid},questionsLink(){return"../course/addquestions2.php?aid="+n.aid+"&cid="+n.cid}},methods:{submitAssess(){A.submitAssessment()},showAllAns(){window.$("span[id^='ans']").removeClass("hidden").toggle(),window.$(".keybtn").attr("aria-expanded",function(e,t){return!JSON.parse(t)})}}},Hl={class:"home"},Ul={key:0,class:"headerpane noticetext"},Wl=["href"],Kl=["href"],zl=["aria-label"],Jl={key:1};function Yl(e,t,i,r,a,s){const o=v("assess-header"),u=v("intro-text"),f=v("inter-question-text-list"),_=v("full-question-header"),m=v("question");return l(),c("div",Hl,[h("a",{href:"#",class:"sr-only",id:"skipnav",onClick:t[0]||(t[0]=se(p=>e.$refs.scrollpane.focus(),["prevent"]))},d(e.$t("jumptocontent")),1),k(o),s.isPreviewAll?(l(),c("p",Ul,[q(d(e.$t("header.preview_all"))+" ",1),h("button",{type:"button",class:"secondary",onClick:t[1]||(t[1]=(...p)=>s.showAllAns&&s.showAllAns(...p))},d(e.$t("gradebook.show_all_ans")),1),h("button",{type:"button",class:"secondary",onClick:t[2]||(t[2]=p=>e.showTexts=!e.showTexts)},d(s.textToggleLabel),1),h("a",{href:s.settingsLink},d(e.$t("links.settings")),9,Wl),t[4]||(t[4]=q("  ",-1)),h("a",{href:s.questionsLink},d(e.$t("links.questions")),9,Kl)])):w("",!0),h("div",{class:"scrollpane fulldisp",role:"region",ref:"scrollpane",tabindex:"-1","aria-label":e.$t("regions.questions")},[s.hasIntro?(l(),T(u,{key:0,active:e.showTexts,html:s.intro},null,8,["active","html"])):w("",!0),(l(!0),c(H,null,U(s.questionArray,p=>(l(),c("div",{key:p},[ie((l(),T(f,{pos:"beforeexact",qn:p,key:"iqt"+p,textlist:s.textList,lastq:s.lastQ,active:e.showTexts},null,8,["qn","textlist","lastq","active"])),[[ae,e.showTexts]]),k(_,{qn:p},null,8,["qn"]),(l(),T(m,{qn:p,active:"true",key:"q"+p,getwork:1},null,8,["qn"]))]))),128)),ie(k(f,{pos:"after",qn:s.lastQ,textlist:s.textList,lastq:s.lastQ,active:e.showTexts},null,8,["qn","textlist","lastq","active"]),[[ae,e.showTexts]])],8,zl),s.showSubmit?(l(),c("p",Jl,[h("button",{type:"button",class:"primary",onClick:t[3]||(t[3]=(...p)=>s.submitAssess&&s.submitAssess(...p))},d(e.$t("header.assess_submit")),1)])):w("",!0)])}const Xl=x(Gl,[["render",Yl]]),Zl={name:"Print",components:{Question:we,FullQuestionHeader:Te,InterQuestionTextList:Je,IntroText:Ee},data:function(){return{showTexts:!0,showQs:!0}},computed:{ainfo(){return n.assessInfo},intro(){return n.assessInfo.intro},questionArray(){const e={};for(let t=0;t<n.assessInfo.questions.length;t++)e[t]=t;return e},lastQ(){return n.assessInfo.questions.length-1},textToggleLabel(){return this.showTexts?this.$t("print.hide_text"):this.$t("print.show_text")},qToggleLabel(){return this.showQs?this.$t("print.hide_qs"):this.$t("print.show_qs")},textList(){return n.assessInfo.hasOwnProperty("interquestion_text")?n.assessInfo.interquestion_text:[]}},methods:{doPrint(){window.print()}}},eu={class:"home print"},tu={class:"assess-header headerpane"},su={style:{"flex-grow":"1"}},nu={class:"pii-full-name"},iu={class:"hideonprint headerpane"},ru={class:"scrollpane"};function au(e,t,i,r,a,s){const o=v("intro-text"),u=v("inter-question-text-list"),f=v("full-question-header"),_=v("question");return l(),c("div",eu,[h("div",tu,[h("h1",su,d(s.ainfo.name),1),h("div",null,[h("span",nu,d(s.ainfo.userfullname),1)])]),h("p",iu,[h("strong",null,d(e.$t("print.print_version")),1),h("button",{type:"button",class:"primary",onClick:t[0]||(t[0]=(...m)=>s.doPrint&&s.doPrint(...m))},d(e.$t("print.print")),1),h("button",{type:"button",onClick:t[1]||(t[1]=m=>e.showTexts=!e.showTexts)},d(s.textToggleLabel),1),h("button",{type:"button",onClick:t[2]||(t[2]=m=>e.showQs=!e.showQs)},d(s.qToggleLabel),1)]),h("div",ru,[s.intro!==""?(l(),T(o,{key:0,active:e.showTexts,html:s.intro},null,8,["active","html"])):w("",!0),h("div",null,[(l(!0),c(H,null,U(s.questionArray,m=>(l(),c("div",{key:m},[ie((l(),T(u,{pos:"beforeexact",qn:m,key:"iqt"+m,textlist:s.textList,lastq:s.lastQ,active:e.showTexts},null,8,["qn","textlist","lastq","active"])),[[ae,e.showTexts]]),e.showQs?(l(),T(f,{key:0,qn:m},null,8,["qn"])):w("",!0),ie((l(),T(_,{class:"med-left",qn:m,active:e.showQs,key:"q"+m,disabled:!0},null,8,["qn","active"])),[[ae,e.showQs]])]))),128)),ie(k(u,{pos:"after",qn:s.lastQ,active:e.showTexts,textlist:s.textList,lastq:s.lastQ},null,8,["qn","active","textlist","lastq"]),[[ae,e.showTexts]])])])])}const ou=x(Zl,[["render",au]]),lu={name:"FullPagedListItem",props:["option","selected"],components:{Icons:B},computed:{statusIcon(){return this.option.disppage===0?"none":this.option.numquestions===this.option.numattempted?"attempted":"unattempted"},nameDisp(){return this.option.disppage===0?this.$t("intro"):this.option.title},qStatus(){return this.option.disppage===0||this.option.numquestions===0?"":this.$t("header.answered",{n:this.option.numattempted,tot:this.option.numquestions})}}},uu={class:"flex-nowrap-center"},cu={class:"qname-wrap"},du={class:"subdued nowrap"};function hu(e,t,i,r,a,s){const o=v("icons");return l(),c("span",uu,[h("span",cu,[s.statusIcon!=="none"?(l(),T(o,{key:0,name:s.statusIcon,class:"qstatusicon"},null,8,["name"])):w("",!0),q(" "+d(s.nameDisp),1)]),h("span",du,d(s.qStatus),1)])}const fu=x(lu,[["render",hu]]),pu={name:"FullPagedNav",props:["page"],components:{Icons:B,MenuButton:ze,FullPagedListItem:fu},mixins:[$e],data:function(){return{}},computed:{disppage(){return parseInt(this.page)+1},pagesData(){return n.assessInfo.interquestion_pages},hasIntro(){return n.assessInfo.intro!==""||n.assessInfo.resources.length>0},navOptions(){var e=[];this.hasIntro&&(e[0]={internallink:"/full/page/0",title:this.$t("intro"),disppage:0});for(const t in this.pagesData){const i=parseInt(t)+1;let r=0;for(let a=0;a<this.pagesData[t][0].questions.length;a++){const s=this.pagesData[t][0].questions[a];(n.assessInfo.questions[s].status!=="unattempted"||this.qsAttempted[s]===1)&&r++}e[i]={disppage:i,title:this.pagesData[t][0].pagetitle,internallink:"/full/page/"+i,numquestions:this.pagesData[t][0].questions.length,numattempted:r}}return e},showNextPrev(){return Object.keys(this.navOptions).length>1}}},mu=["aria-label"],_u=["onClick","onKeypress","disabled","aria-label"],wu=["onClick","onKeypress","disabled","aria-label"];function gu(e,t,i,r,a,s){const o=v("full-paged-list-item"),u=v("menu-button"),f=v("icons"),_=v("router-link");return l(),c("div",{class:"subheader pagenav",role:"navigation","aria-label":e.$t("regions.pagenav")},[k(u,{id:"qnav",options:s.navOptions,selected:s.disppage,searchby:"title"},{default:L(({option:m,selected:p})=>[k(o,{option:m,selected:p},null,8,["option","selected"])]),_:1},8,["options","selected"]),s.showNextPrev?(l(),T(_,{key:0,to:"/full/page/"+(s.disppage-1),custom:""},{default:L(({navigate:m})=>[h("button",{type:"button",onClick:m,onKeypress:X(m,["enter"]),role:"link",disabled:i.page<(this.hasIntro?0:1),class:"secondarybtn",id:"qprev","aria-label":e.$t("previous")},[k(f,{name:"left"})],40,_u)]),_:1},8,["to"])):w("",!0),s.showNextPrev?(l(),T(_,{key:1,to:"/full/page/"+(s.disppage+1),custom:""},{default:L(({navigate:m})=>[h("button",{type:"button",onClick:m,onKeypress:X(m,["enter"]),role:"link",disabled:i.page>=s.pagesData.length-1,class:"secondarybtn",id:"qnext","aria-label":e.$t("next")},[k(f,{name:"right"})],40,wu)]),_:1},8,["to"])):w("",!0)],8,mu)}const yu=x(pu,[["render",gu]]),bu={name:"FullPaged",components:{Question:we,AssessHeader:tt,FullPagedNav:yu,FullQuestionHeader:Te,InterQuestionTextList:Je,IntroText:Ee},computed:{page(){return parseInt(this.$route.params.page)-1},allPages(){return n.assessInfo.interquestion_pages},intro(){return n.assessInfo.intro},hasIntro(){return n.assessInfo.intro!==""||n.assessInfo.resources.length>0},showSubmit(){return n.assessInfo.submitby==="by_assessment"},lastQ(){const e=[];let t;for(const i in this.allPages)t=this.allPages[i][0].questions,e[i]=t[t.length-1];return e}},methods:{submitAssess(){A.submitAssessment()}}},vu={class:"home"},ku=["aria-label"],qu=["aria-hidden"],Iu={key:0,class:"noqtext"},Au={key:1},Pu={key:0},Tu={key:1};function Su(e,t,i,r,a,s){const o=v("assess-header"),u=v("full-paged-nav"),f=v("intro-text"),_=v("inter-question-text-list"),m=v("full-question-header"),p=v("question"),g=v("router-link");return l(),c("div",vu,[h("a",{href:"#",class:"sr-only",id:"skipnav",onClick:t[0]||(t[0]=se(y=>e.$refs.scrollpane.focus(),["prevent"]))},d(e.$t("jumptocontent")),1),k(o),k(u,{page:s.page},null,8,["page"]),h("div",{class:"scrollpane",role:"region",ref:"scrollpane",tabindex:"-1","aria-label":e.$t("regions.questions")},[k(f,{active:s.page===-1&&s.hasIntro,html:s.intro},null,8,["active","html"]),(l(!0),c(H,null,U(s.allPages,(y,O)=>(l(),c("div",{key:O,class:z({inactive:O!==s.page}),"aria-hidden":O!==s.page},[y[0].questions.length===0?(l(),c("div",Iu,[(l(),T(_,{pos:"all",textlist:y,lastq:s.lastQ[O],active:O===s.page,key:"iqtp"+O},null,8,["textlist","lastq","active"]))])):(l(),c("div",Au,[(l(!0),c(H,null,U(y[0].questions,E=>(l(),c("div",{key:E,class:"fullpaged"},[(l(),T(_,{pos:"beforeexact",qn:E,key:"iqt"+E,textlist:y,lastq:s.lastQ[O],active:O===s.page},null,8,["qn","textlist","lastq","active"])),h("div",null,[k(m,{qn:E},null,8,["qn"]),(l(),T(p,{qn:E,active:O===s.page,key:"q"+E,getwork:1},null,8,["qn","active"]))])]))),128)),(l(),T(_,{id:"aftertext",pos:"after",qn:y[0].questions[y[0].questions.length-1],key:"iqte"+O,textlist:y,lastq:s.lastQ[O],active:O===s.page},null,8,["qn","textlist","lastq","active"]))]))],10,qu))),128)),s.page<s.allPages.length-1?(l(),c("div",Pu,[t[2]||(t[2]=h("p",null," ",-1)),h("p",null,[k(g,{to:"/full/page/"+(s.page+2)},{default:L(()=>[q(d(e.$t("pages.next")),1)]),_:1},8,["to"])])])):s.showSubmit?(l(),c("p",Tu,[h("button",{type:"button",class:"primary",onClick:t[1]||(t[1]=(...y)=>s.submitAssess&&s.submitAssess(...y))},d(e.$t("header.assess_submit")),1)])):w("",!0)],8,ku)])}const Ou=x(bu,[["render",Su]]);var xu={};const $u=()=>Ot(()=>import("./Videocued-yT-FEOMd.js"),__vite__mapDeps([0,1]),import.meta.url),Eu=()=>Ot(()=>import("./Livepoll-B_jXTfak.js"),__vite__mapDeps([2,1]),import.meta.url),G=yn({history:Js(window.imasroot+"/assess2/"),routes:[{path:"/",name:"launch",component:Ti,beforeEnter:(e,t,i)=>{(n.assessInfo.available==="yes"||n.assessInfo.available==="practice"&&n.assessInfo.in_practice)&&(n.assessInfo.has_active_attempt||n.assessInfo.can_retake)?i():i({path:"/closed",replace:!0})}},{path:"/closed",name:"closed",component:Ki,beforeEnter:(e,t,i)=>{(n.assessInfo.available==="yes"||n.assessInfo.available==="practice"&&n.assessInfo.in_practice)&&(n.assessInfo.has_active_attempt||n.assessInfo.can_retake)?i({path:"/",replace:!0}):i()}},{path:"/skip/:qn",name:"skip",component:Fl,beforeEnter:(e,t,i)=>{n.inProgress?i():i({path:"/",replace:!0})}},{path:"/full",name:"full",component:Xl,beforeEnter:(e,t,i)=>{n.inProgress?i():i({path:"/",replace:!0})}},{path:"/full/page/:page",name:"fullpaged",component:Ou,beforeEnter:(e,t,i)=>{n.inProgress?i():i({path:"/",replace:!0})}},{path:"/videocued",component:$u,beforeEnter:(e,t,i)=>{n.inProgress?i():i({path:"/",replace:!0})}},{path:"/livepoll",component:Eu,beforeEnter:(e,t,i)=>{n.inProgress?i():i({path:"/",replace:!0})}},{path:"/summary",name:"summary",component:qo,beforeEnter:(e,t,i)=>{(n.assessInfo.available==="yes"||n.assessInfo.available==="practice"&&n.assessInfo.in_practice)&&(!n.assessInfo.has_active_attempt||n.assessInfo.submitby==="by_question")?i():i({path:"/",replace:!0})}},{path:"/showwork",name:"showwork",component:Qo,beforeEnter:(e,t,i)=>{!n.assessInfo.in_practice&&(!n.assessInfo.has_active_attempt||n.assessInfo.submitby==="by_question")&&!n.showwork_expired?i():i({path:"/",replace:!0})}},{path:"/print",name:"print",component:ou,beforeEnter:(e,t,i)=>{if(n.assessInfo.available==="yes"&&n.assessInfo.has_active_attempt||n.assessInfo.available==="practice"||n.assessInfo.can_view_all)if(n.inPrintView=!0,n.assessInfo.hasOwnProperty("questions"))i();else{const r=n.assessInfo.available==="practice";A.startAssess(r,"",[],()=>i())}else i({path:"/",replace:!0})}}],scrollBehavior(e,t,i){return i||new Promise((r,a)=>{setTimeout(()=>{r({left:0,top:0})},50)})}});G.beforeEach((e,t,i)=>{typeof window.APIbase<"u"?n.APIbase=window.APIbase:n.APIbase=xu.BASE_URL;const r=window.location.search.replace(/^.*cid=(\d+).*$/,"$1"),a=window.location.search.replace(/^.*aid=(\d+).*$/,"$1");let s=0;window.location.search.match(/uid=/)&&(s=window.location.search.replace(/^.*uid=(\d+).*$/,"$1")),n.assessInfo===null||n.cid!==r||n.aid!==a||n.uid!==s?(n.cid=r,window.cid=r,n.aid=a,n.uid=s,n.queryString="?cid="+n.cid+"&aid="+n.aid,n.uid!==0&&(n.queryString+="&uid="+n.uid),A.loadAssessData(()=>i())):n.inPrintView&&e.name!=="/print"?i({path:"/print",replace:!0}):i()});G.afterEach((e,t)=>{Ke(window.sendLTIresizemsg)});const n=At({assessInfo:null,APIbase:null,aid:null,cid:null,uid:null,queryString:"",inAssess:!1,inTransit:!1,autoSaving:!1,errorMsg:null,confirmObj:null,lastLoaded:[],inProgress:!1,autosaveQueue:{},autosaveTimeactive:{},timeActive:{},timeActivated:{},initValues:{},initTimes:{},work:{},autosaveTimer:null,somethingDirty:!1,noUnload:!1,timelimit_timer:null,timelimit_expired:!1,timelimit_grace_expired:!1,timelimit_restricted:0,enddate_timer:null,showwork_timer:null,showwork_expired:!1,show_enddate_dialog:!1,inPrintView:!1,enableMQ:!0,lastPos:null,livepollServer:"",livepollSettings:{showQuestionDefault:!0,showResultsLiveDefault:!1,showResultsAfter:!0,showAnswersAfter:!0,useTimer:!1,questionTimelimit:60},livepollStuCnt:0,livepollResults:{}}),A={loadAssessData(e,t){let i=n.queryString;if(t===!0&&(i+="&reset=1"),n.inTransit){window.setTimeout(()=>this.loadAssessData(e,t),20);return}n.inTransit=!0,n.errorMsg=null,n.inAssess=!1,window.$.ajax({url:n.APIbase+"loadassess.php"+i,dataType:"json",xhrFields:{withCredentials:!0},crossDomain:!0}).done(r=>{if(r.hasOwnProperty("error")){this.handleError(r.error);return}n.inProgress=!1,n.timelimit_expired=!1,clearTimeout(n.timelimit_timer),r=this.processSettings(r),n.assessInfo=r,typeof e<"u"&&e!==null&&e()}).fail((r,a,s)=>{this.handleError(a==="parsererror"?"parseerror":"noserver")}).always(r=>{n.inTransit=!1})},startAssess(e,t,i,r,a){if(n.inTransit){window.setTimeout(()=>this.startAssess(e,t,i,r),20);return}n.inTransit=!0,n.errorMsg=null,window.$.ajax({url:n.APIbase+"startassess.php"+n.queryString,type:"POST",dataType:"json",data:{practice:e,preview_all:a?1:0,password:t,in_print:n.inPrintView?1:0,new_group_members:i.join(","),cur_group:n.assessInfo.stugroupid,has_ltisourcedid:n.assessInfo.is_lti&&n.assessInfo.has_ltisourcedid?1:0},xhrFields:{withCredentials:!0},crossDomain:!0}).done(s=>{if(s.hasOwnProperty("error")){this.handleError(s.error);return}if(window.imathasDraw.reset(),s=this.processSettings(s),n.assessInfo=Object.assign({},n.assessInfo,s),n.autosaveQueue={},n.autosaveTimeactive={},n.initValues={},n.initTimes={},n.timeActive={},n.timeActivated={},n.work={},n.inAssess=!0,s.error)this.handleError(s.error);else if(n.assessInfo.has_active_attempt){if(n.inProgress=!0,typeof r<"u"&&r!==null){r();return}n.assessInfo.displaymethod==="skip"?n.assessInfo.intro!==""||n.assessInfo.resources.length>0?G.push("/skip/0"):G.push("/skip/1"):n.assessInfo.displaymethod==="full"?n.assessInfo.hasOwnProperty("interquestion_pages")?n.assessInfo.intro!==""||n.assessInfo.resources.length>0?G.push("/full/page/0"):G.push("/full/page/1"):G.push("/full"):n.assessInfo.displaymethod==="video_cued"?G.push("/videocued"):n.assessInfo.displaymethod==="livepoll"&&G.push("/livepoll")}}).fail((s,o,u)=>{this.handleError(o==="parsererror"?"parseerror":"noserver")}).always(s=>{n.inTransit=!1})},loadQuestion(e,t,i,r){if(this.prepForSave("all"),n.inTransit){window.setTimeout(()=>this.loadQuestion(e,t,i),20);return}else if(n.somethingDirty&&r==null){window.setTimeout(()=>this.loadQuestion(e,t,i,!0),50);return}n.inTransit=!0,t&&(this.clearInitValue(e),n.assessInfo.hasOwnProperty("scoreerrors")&&n.assessInfo.scoreerrors.hasOwnProperty(e)&&delete n.assessInfo.scoreerrors[e]);const a=new FormData;a.append("qn",e),a.append("practice",n.assessInfo.in_practice),a.append("regen",t?1:0),a.append("jumptoans",i?1:0),n.assessInfo.preview_all&&a.append("preview_all",!0),Object.keys(n.autosaveQueue).length>0&&(A.clearAutosaveTimer(),this.addAutosaveData(a)),window.$.ajax({url:n.APIbase+"loadquestion.php"+n.queryString,type:"POST",dataType:"text",data:a,processData:!1,contentType:!1,xhrFields:{withCredentials:!0},crossDomain:!0}).done(s=>{try{var o=JSON.parse(s.trim().replace(/^\uFEFF/,""));if(o.hasOwnProperty("error")){this.handleError(o.error);return}o.saved_autosaves&&this.markAutosavesDone(),delete o.saved_autosaves,t&&n.assessInfo.questions[e].jsparams&&window.imathasAssess.clearparams(n.assessInfo.questions[e].jsparams),o=this.processSettings(o),this.copySettings(o)}catch(u){console.log("Response text:",s),this.handleError("parseerror")}}).fail((s,o,u)=>{o==="parsererror"&&console.log("Response text:",s.responseText),this.handleError(o==="parsererror"?"parseerror":"noserver")}).always(s=>{n.inTransit=!1})},prepForSave(e){for(let t in window.callbackstack)t=parseInt(t),(e==="all"||e.indexOf(t<1e3?t:Math.floor(t/1e3)-1)>-1)&&window.callbackstack[t](t);typeof window.tinyMCE<"u"&&window.tinyMCE.triggerSave()},submitAssessment(){let e="header.confirm_assess_submit";if(n.assessInfo.submitby==="by_assessment"){let t=0;const i=this.getChangedQuestions();for(const a in n.assessInfo.questions)(n.assessInfo.questions[a].try>0||n.assessInfo.questions[a].hasOwnProperty("parts_entered")&&n.assessInfo.questions[a].hasOwnProperty("answeights")&&n.assessInfo.questions[a].parts_entered.length>=n.assessInfo.questions[a].answeights.length||i.hasOwnProperty(a))&&t++;const r=n.assessInfo.questions.length;t!==r&&(e="header.confirm_assess_unattempted_submit"),n.confirmObj={body:e,action:()=>{var a=[];for(let s=0;s<n.assessInfo.questions.length;s++)a.push(s);this.submitQuestion(a,!0)}}}},submitWork(){if(n.inTransit){window.setTimeout(()=>this.submitWork(),20);return}typeof window.tinyMCE<"u"&&window.tinyMCE.triggerSave(),n.inTransit=!0;const e={};window.$(".swbox").each(function(){const t=parseInt(this.id.substr(2));(!n.assessInfo.questions[t].hasOwnProperty("work")||this.value!==n.assessInfo.questions[t].work)&&(n.work[t]=this.value)});for(const t in n.work)e[t]=n.work[t];if(Object.keys(e).length===0){n.inTransit=!1,n.errorMsg=null,n.inAssess?G.push("/summary"):n.assessInfo.available==="yes"?G.push("/"):window.location=window.exiturl;return}window.$.ajax({url:n.APIbase+"savework.php"+n.queryString,type:"POST",dataType:"json",data:{work:e},xhrFields:{withCredentials:!0},crossDomain:!0}).done(t=>{if(t.hasOwnProperty("error")&&t.error!=="workafter_expired"){this.handleError(t.error),t.error==="already_submitted"&&(t=this.processSettings(t),this.copySettings(t));return}else n.errorMsg=null;for(const i in n.work)n.assessInfo.questions[parseInt(i)].work=n.work[i],delete n.work[i];n.inAssess?G.push("/summary"):n.assessInfo.available==="yes"?G.push("/"):window.location=window.exiturl}).fail((t,i,r)=>{this.handleError(i==="parsererror"?"parseerror":"noserver")}).always(t=>{n.inTransit=!1})},submitQuestion(e,t){if(n.somethingDirty=!1,this.clearAutosaveTimer(),n.inTransit){window.setTimeout(()=>this.submitQuestion(e,t),20);return}n.inTransit=!0,typeof e!="object"&&(e=[e]),this.prepForSave(e);const i=[],r=this.getChangedQuestions(e);let a=!1;for(let m=0;m<e.length;m++){const p=parseInt(e[m]);document.getElementById("sw"+p)&&(n.work[p]=document.getElementById("sw"+p).value),n.work[p]&&n.work[p]!==A.getInitValue(p,"sw"+p)&&(a=!0)}if(Object.keys(r).length===0&&!a&&!t){n.errorMsg="nochange",n.inTransit=!1;return}window.MQeditor.resetEditor(),window.imathasAssess.clearTips(),window.setTimeout(()=>this.clearAutosave(e),100);const s=new FormData;let o;const u=[];for(const m in r){if(n.assessInfo.displaymethod!=="full"){if(n.timeActivated.hasOwnProperty(m)){const g=new Date;n.timeActive[m]+=g-n.timeActivated[m]}u.push(n.timeActive[m])}r[m].length===1&&r[m][0]===0&&(o=window.imathasAssess.preSubmit(m),o!==!1&&s.append("qn"+m+"-val",o));let p;for(let g=0;g<r[m].length;g++)p=(parseInt(m)+1)*1e3+r[m][g],o=window.imathasAssess.preSubmit(p),o!==!1&&s.append("qn"+p+"-val",o)}for(let m=0;m<e.length;m++){const p=parseInt(e[m]);var f=new RegExp("^(qn|tc|qs)("+p+"\\b|"+(p+1)+"\\d{3})");window.$("#questionwrap"+p).find("input,select,textarea").each(function(g,y){y.name.match(f)&&(y.type!=="radio"&&y.type!=="checkbox"||y.checked)&&(y.type==="file"&&y.files.length>0?s.append(y.name,y.files[0]):y.type==="file"?document.getElementById(y.name+"-autosave")&&s.append(y.name,"file-autosave"):s.append(y.name,window.imathasAssess.preSubmitString(y.name,y.value)))}),n.work[p]&&n.work[p]!==A.getInitValue(p,"sw"+p)&&s.append("sw"+p,n.work[p]),i[m]=n.lastLoaded[p].getTime()}s.append("toscoreqn",JSON.stringify(r)),s.append("timeactive",u.join(",")),s.append("lastloaded",i.join(",")),s.append("verification",JSON.stringify(this.getVerificationData(r))),t&&s.append("endattempt",t),n.assessInfo.in_practice&&s.append("practice",!0),n.assessInfo.preview_all&&s.append("preview_all",!0),this.addAutosaveData(s,Object.keys(r));const _=e.length===1&&n.assessInfo.questions[e[0]].jsparams&&n.assessInfo.questions[e[0]].jsparams.hasseqnext;window.$.ajax({url:n.APIbase+"scorequestion.php"+n.queryString,type:"POST",dataType:"json",data:s,processData:!1,contentType:!1,xhrFields:{withCredentials:!0},crossDomain:!0}).done(m=>{if(m.hasOwnProperty("error")){this.handleError(m.error),m.error==="already_submitted"&&(m=this.processSettings(m),this.copySettings(m));return}else n.errorMsg=null;m.saved_autosaves&&this.markAutosavesDone(),delete m.saved_autosaves;for(const g in r)n.assessInfo.hasOwnProperty("scoreerrors")&&n.assessInfo.scoreerrors.hasOwnProperty(g)&&delete n.assessInfo.scoreerrors[g],n.initValues.hasOwnProperty(g)&&delete n.initValues[g],n.work.hasOwnProperty(g)&&delete n.work[g];m=this.processSettings(m),this.copySettings(m),!n.assessInfo.in_practice&&window.inTreeReader&&this.updateTreeReader();let p=!1;for(let g=0;g<n.assessInfo.questions.length;g++)if(n.assessInfo.questions[g].showwork&2){p=!0;break}t?(n.inProgress=!1,p&&!n.assessInfo.in_practice?G.push("/showwork"):G.push("/summary")):e.length===1&&(n.assessInfo.questions[e[0]].hadSeqNext=_,Ke(()=>{var g;_?(g=window.$("#questionwrap"+e[0]).find(".seqsep").last().next()[0],window.$("#questionwrap"+e[0]).find(".seqsep").last().focus()):(g=document.getElementById("questionwrap"+e[0]).parentNode.parentNode,window.$(g).find(".scoreresult").focus());var y=g.getBoundingClientRect();(y.top<0||y.bottom>document.documentElement.clientHeight)&&g.scrollIntoView()}))}).fail((m,p,g)=>{this.handleError(p==="parsererror"?"parseerror":"noserver")}).always(m=>{n.inTransit=!1})},gotoSummary(){let e=!1;for(let t=0;t<n.assessInfo.questions.length;t++)if(n.assessInfo.questions[t].showwork&2){e=!0,n.assessInfo.showwork_after=!0;break}n.assessInfo.submitby==="by_question"&&(e&&!n.assessInfo.in_practice?G.push("/showwork"):G.push("/summary"))},doAutosave(e,t,i){if(n.inTransit){window.setTimeout(()=>this.doAutosave(e,t,i),20);return}n.somethingDirty=!1,n.autosaveQueue.hasOwnProperty(e)||(n.autosaveQueue[e]=[]),n.autosaveQueue[e].indexOf(t)===-1&&n.autosaveQueue[e].push(t),n.autosaveTimeactive[e]=i,n.autosaveTimer===null&&(n.autosaveTimer=window.setTimeout(()=>{this.submitAutosave(!0)},60*1e3))},clearAutosave(e){for(const t in e)n.autosaveQueue.hasOwnProperty(e[t])&&delete n.autosaveQueue[e[t]];Object.keys(n.autosaveQueue).length===0&&this.clearAutosaveTimer()},clearAutosaveTimer(){window.clearTimeout(n.autosaveTimer),n.autosaveTimer=null},addAutosaveData(e,t){t=t||[];const i={},r={};let a;for(const o in n.autosaveQueue){if(t.indexOf(o)!==-1)continue;r[o]=n.autosaveQueue[o],n.autosaveQueue[o].length===1&&n.autosaveQueue[o][0]===0&&(a=window.imathasAssess.preSubmit(o),a!==!1&&e.append("qn"+o+"-val",a));const u=[];let f;for(const _ in n.autosaveQueue[o]){const m=n.autosaveQueue[o][_];if(m==="sw"){e.append("sw"+o,n.work[o]);continue}m===0&&u.push(o),f=(o*1+1)*1e3+m*1,u.push(f),a=window.imathasAssess.preSubmit(f),a!==!1&&e.append("qn"+f+"-val",a)}var s=new RegExp("^(qn|tc|qs)("+u.join("\\b|")+"\\b)");window.$("#questionwrap"+o).find("input,select,textarea").each(function(_,m){m.name.match(s)&&(m.type!=="radio"&&m.type!=="checkbox"||m.checked)&&(m.type==="file"?m.files.length===0?e.append(m.name,""):e.append(m.name,m.files[0]):e.append(m.name,window.imathasAssess.preSubmitString(m.name,m.value)))}),i[o]=n.lastLoaded[o].getTime()}e.append("autosave-tosaveqn",JSON.stringify(r)),e.append("autosave-lastloaded",JSON.stringify(i)),e.append("autosave-verification",JSON.stringify(this.getVerificationData(r))),n.assessInfo.displaymethod==="full"?e.append("autosave-timeactive",""):e.append("autosave-timeactive",JSON.stringify(n.autosaveTimeactive))},markAutosavesDone(){for(const e in n.autosaveQueue)for(const t in n.autosaveQueue[e])n.assessInfo.questions[parseInt(e)].hasOwnProperty("parts_entered")&&n.assessInfo.questions[parseInt(e)].parts_entered.indexOf(n.autosaveQueue[e][t])===-1&&n.assessInfo.questions[parseInt(e)].parts_entered.push(n.autosaveQueue[e][t]);n.autosaveQueue={}},submitAutosave(e){if(n.somethingDirty=!1,this.clearAutosaveTimer(),Object.keys(n.autosaveQueue).length===0)return;if(n.inTransit){window.setTimeout(()=>this.submitAutosave(e),20);return}n.inTransit=!0,n.autoSaving=!0,this.prepForSave(Object.keys(n.autosaveQueue));const t=new FormData;if(this.addAutosaveData(t),n.assessInfo.in_practice&&t.append("practice",!0),n.assessInfo.preview_all&&t.append("preview_all",!0),e===!1&&navigator.sendBeacon){navigator.sendBeacon(n.APIbase+"autosave.php"+n.queryString,t),n.inTransit=!1,n.autoSaving=!1,n.autosaveQueue={};return}window.$.ajax({url:n.APIbase+"autosave.php"+n.queryString,type:"POST",dataType:"json",data:t,async:e,processData:!1,contentType:!1,xhrFields:{withCredentials:!0},crossDomain:!0}).done(i=>{if(i.hasOwnProperty("error")){this.handleError(i.error),i.error==="already_submitted"&&(i=this.processSettings(i),this.copySettings(i));return}i.autosave==="done"&&(this.markAutosavesDone(),delete i.autosave),i=this.processSettings(i),this.copySettings(i)}).fail((i,r,a)=>{this.handleError(r==="parsererror"?"parseerror":"noserver")}).always(i=>{n.inTransit=!1,n.autoSaving=!1})},handleTimelimitUp(){n.assessInfo.has_active_attempt&&(n.errorMsg="timesup_submitting",this.prepForSave("all"),setTimeout(()=>{const e=Object.keys(this.getChangedQuestions());this.submitQuestion(e,!0)},1e3))},handleShowworklimitUp(){typeof window.tinyMCE<"u"&&window.tinyMCE.triggerSave(),n.errorMsg="workafter_submitting",n.showwork_expired=!0,setTimeout(()=>{this.submitWork()},1e3)},handleDueDate(){A.submitAutosave(),n.show_enddate_dialog=!0},endAssess(e){if(n.somethingDirty=!1,this.clearAutosaveTimer(),window.MQeditor.resetEditor(),window.imathasAssess.clearTips(),n.inTransit){window.setTimeout(()=>this.endAssess(e),20);return}n.inTransit=!0,n.errorMsg=null,window.$.ajax({url:n.APIbase+"endassess.php"+n.queryString,dataType:"json",xhrFields:{withCredentials:!0},crossDomain:!0}).done(t=>{if(t.hasOwnProperty("error")){this.handleError(t.error);return}t=this.processSettings(t),this.copySettings(t),n.inProgress=!1,typeof e=="function"&&e()}).fail((t,i,r)=>{this.handleError(i==="parsererror"?"parseerror":"noserver")}).always(t=>{n.inTransit=!1})},getScores(){if(n.inTransit){window.setTimeout(()=>this.getScores(),20);return}n.inTransit=!0,window.$.ajax({url:n.APIbase+"getscores.php"+n.queryString,type:"GET",dataType:"json",xhrFields:{withCredentials:!0},crossDomain:!0}).done(e=>{if(e.hasOwnProperty("error")){this.handleError(e.error);return}e=this.processSettings(e),this.copySettings(e)}).fail((e,t,i)=>{this.handleError(t==="parsererror"?"parseerror":"noserver")}).always(e=>{n.inTransit=!1})},getQuestions(){if(n.inTransit){window.setTimeout(()=>this.getQuestions(),20);return}n.inTransit=!0,window.$.ajax({url:n.APIbase+"getquestions.php"+n.queryString,type:"GET",dataType:"json",xhrFields:{withCredentials:!0},crossDomain:!0}).done(e=>{if(e.hasOwnProperty("error")){this.handleError(e.error);return}e=this.processSettings(e),this.copySettings(e)}).fail((e,t,i)=>{this.handleError(t==="parsererror"?"parseerror":"noserver")}).always(e=>{n.inTransit=!1})},redeemLatePass(e){if(n.inTransit){window.setTimeout(()=>this.redeemLatePass(e),20);return}n.inTransit=!0,window.$.ajax({url:n.APIbase+"uselatepass.php"+n.queryString,type:"POST",dataType:"json",xhrFields:{withCredentials:!0},crossDomain:!0}).done(t=>{if(t.hasOwnProperty("error")){this.handleError(t.error);return}t=this.processSettings(t),this.copySettings(t),typeof e=="function"?e():G.push("/")}).fail((t,i,r)=>{this.handleError(i==="parsererror"?"parseerror":"noserver")}).always(t=>{n.inTransit=!1})},routeToStart(){G.push("/")},setLivepollStatus(e){if(n.inTransit){window.setTimeout(()=>this.setLivepollStatus(e),20);return}n.inTransit=!0,n.errorMsg=null,window.$.ajax({url:n.APIbase+"livepollstatus.php"+n.queryString,type:"POST",dataType:"json",data:e,xhrFields:{withCredentials:!0},crossDomain:!0}).done(t=>{if(t.hasOwnProperty("error")){this.handleError(t.error);return}t=this.processSettings(t),this.copySettings(t)}).fail((t,i,r)=>{this.handleError(i==="parsererror"?"parseerror":"noserver")}).always(t=>{n.inTransit=!1})},getVerificationData(e){const t={},i=n.assessInfo.submitby==="by_question",r=n.assessInfo.prev_attempts.length;for(const a in e){const s=[],o=n.assessInfo.questions[a];for(let u=0;u<o.parts.length;u++)s[u]=o.parts[u].try;t[a]={tries:s,regen:i?o.regen:r}}return t},setInitValue(e,t,i){n.initValues.hasOwnProperty(e)||(n.initValues[e]={});let r=0;if(t.match(/^sw/))r="sw";else{const s=t.match(/^(qs|qn|tc)(\d+)/)[2];s>1e3&&(r=s%1e3),n.assessInfo.questions[e].jsparams[s].qtype==="draw"&&i===""&&(i=";;;;;;;;")}n.assessInfo.questions[e].hasOwnProperty("usedautosave")&&n.assessInfo.questions[e].usedautosave.indexOf(r)!==-1||n.initValues[e].hasOwnProperty(t)||(n.initValues[e][t]=i)},getInitValue(e,t){return n.initValues.hasOwnProperty(e)&&n.initValues[e].hasOwnProperty(t)?n.initValues[e][t]:""},clearInitValue(e){n.initValues[e]={}},getInitTimeactive(e){if(n.assessInfo.questions[e].hasOwnProperty("autosave_timeactive")){var t=n.assessInfo.questions[e].autosave_timeactive;return n.assessInfo.questions[e].autosave_timeactive=0,t}return 0},setRendered(e,t){n.assessInfo&&(n.assessInfo.questions[e].rendered=t)},getChangedQuestions(e){if(typeof e!="object"){if(!n.assessInfo.hasOwnProperty("questions"))return{};e=[];for(let a=0;a<n.assessInfo.questions.length;a++)e.push(a)}const t={};let i;for(let a=0;a<e.length;a++){const s=e[a];n.assessInfo.questions[s].showwork&&n.work.hasOwnProperty(s)&&n.work[s]!==A.getInitValue(s,"sw"+s)&&(t.hasOwnProperty(s)||(t[s]=[]));var r=new RegExp("^(qn|tc|qs)("+s+"\\b|"+(s*1+1)+"\\d{3})");if(window.$("#questionwrap"+s).find("input,select,textarea").each(function(o,u){if((i=u.name.match(r))!==null){let f=!1;if(u.type==="radio"||u.type==="checkbox"?(u.checked&&u.value!==A.getInitValue(s,u.name)||!u.checked&&u.value===A.getInitValue(s,u.name))&&(f=!0):(u.type==="file"&&document.getElementById(u.name+"-autosave")!==null||u.value.trim()!==A.getInitValue(s,u.name)&&u.value.trim()!=="")&&(f=!0),f){t.hasOwnProperty(s)||(t[s]=[]);let _=0;const m=parseInt(i[2]);m>1e3&&(_=m%1e3),t[s].indexOf(_)===-1&&t[s].push(_)}}}),n.assessInfo.questions[s].hasOwnProperty("jsparams")){const o=n.assessInfo.questions[s].jsparams;for(const u in o)if(o.submitall||u.match(/\d/)&&o[u].hasOwnProperty("submitblank")){let f=0;u>1e3&&(f=u%1e3),t.hasOwnProperty(s)||(t[s]=[]),t[s].indexOf(f)===-1&&t[s].push(f)}}}return t},handleError(e){n.assessInfo.hasOwnProperty("is_lti")&&n.assessInfo.is_lti&&e==="no_session"&&(e="lti_no_session"),n.errorMsg=e},updateTreeReader(){let e=0;for(const i in n.assessInfo.questions)n.assessInfo.questions[i].try>0&&e++;let t=0;e===n.assessInfo.questions.length?t=2:e>0&&(t=1);try{top.updateTRunans(n.aid,t)}catch(i){}},enableMQ(){n.enableMQ=!0,window.imathasAssess.clearLivePreviewTimeouts(),window.$("input[type=button][id^=pbtn],button[id^=pbtn]").hide(),window.$("span[id^=p] span[id^=lpbuf]").empty(),window.MQeditor.toggleMQAll("input[data-mq]",!0)},disableMQ(){n.enableMQ=!1,window.$("input[type=button][id^=pbtn],button[id^=pbtn]").show().trigger("click"),window.MQeditor.toggleMQAll("input[data-mq]",!1)},copySettings(e){if(e.hasOwnProperty("questions")){n.assessInfo.hasOwnProperty("questions")||(n.assessInfo.questions=[]);for(const t in e.questions){const i=parseInt(t);e.questions[t].category===null&&n.assessInfo.questions.hasOwnProperty(i)&&n.assessInfo.questions[i].hasOwnProperty("category")&&(e.questions[t].category=n.assessInfo.questions[i].category),n.assessInfo.questions[i]=e.questions[t]}delete e.questions}n.assessInfo=Object.assign({},n.assessInfo,e)},processSettings(e){if(e.hasOwnProperty("questions"))for(const t in e.questions){const i=e.questions[t];if(e.questions[t].canretry=i.try<i.tries_max,e.questions[t].canretry_primary=e.questions[t].canretry,e.questions[t].tries_remaining=i.tries_max-i.try,!e.questions[t].did_jump_to_ans&&i.hasOwnProperty("parts")){let r=1e10,a=0,s=!1;for(const o in i.parts){const u=i.tries_max-i.parts[o].try,f=i.hasOwnProperty("answeights")&&parseFloat(i.answeights[o])===0||i.parts[o].hasOwnProperty("points_possible")&&parseFloat(i.parts[o].points_possible)===0;u<r&&(!f||parseInt(o)===0&&parseInt(i.try)===0)&&(r=u),u>a&&(!f||parseInt(o)===0&&parseInt(i.try)===0)&&(a=u),u>0&&(!i.parts[o].hasOwnProperty("rawscore")||i.parts[o].rawscore<1||i.parts[o].req_manual)&&(s=!0)}e.questions[t].canretry_primary=s,r!==a&&(e.questions[t].tries_remaining_range=[r,a])}i.hasOwnProperty("regens_max")!=="undefined"&&i.regen<i.regens_max-1?(e.questions[t].canregen=!0,e.questions[t].regens_remaining=i.regens_max-i.regen-1):(e.questions[t].canregen=!1,e.questions[t].regens_remaining=0),e.questions[t].has_details=i.hasOwnProperty("parts")&&(i.parts.length>1||i.parts[0].hasOwnProperty("penalties")&&i.parts[0].penalties.length>0),e.questions[t].withdrawn!==0&&(e.questions[t].canretry=!1,e.questions[t].tries_remaining=0,e.questions[t].canregen=!1,e.questions[t].regens_remaining=0),n.lastLoaded[t]=new Date}if(e.hasOwnProperty("showscores")&&(e.show_scores_during=e.showscores==="during"),e.hasOwnProperty("regen")&&(e.regens_remaining=e.regens_max-e.regen-1),e.hasOwnProperty("enableMQ")&&(n.enableMQ=e.enableMQ),e.hasOwnProperty("enddate_in")&&e.enddate_in>0&&n.timelimit_timer===null&&e.enddate_in<480*60*60){window.clearTimeout(n.enddate_timer);const t=new Date().getTime(),i=e.enddate_in*1e3;e.enddate_local=t+i,n.enddate_timer=setTimeout(()=>{this.handleDueDate()},i)}if(e.hasOwnProperty("showwork_cutoff_in")){window.clearTimeout(n.showwork_timer);const t=new Date().getTime(),i=e.showwork_cutoff_in*1e3;e.showwork_local_cutoff_expires=t+i,i>0?(n.showwork_timer=setTimeout(()=>{this.handleShowworklimitUp()},i),n.showwork_expired=!1):n.showwork_expired=!0}if(e.hasOwnProperty("timelimit_expiresin")){window.clearTimeout(n.timelimit_timer),window.clearTimeout(n.enddate_timer);const t=new Date().getTime();e.hasOwnProperty("timelimit_expires")&&(e.timelimit_expires===e.enddate?n.timelimit_restricted=1:e.timelimit_grace===e.enddate&&(n.timelimit_restricted=2));const i=e.timelimit_expiresin*1e3,r=e.timelimit_gracein*1e3;e.timelimit_local_expires=t+i,r>0?e.timelimit_local_grace=t+r:e.timelimit_local_grace=0,i>0?(e.timelimit_gracein>0?n.timelimit_timer=setTimeout(()=>{this.handleTimelimitUp()},r):n.timelimit_timer=setTimeout(()=>{this.handleTimelimitUp()},i),n.timelimit_expired=!1,n.timelimit_grace_expired=!1):(n.timelimit_expired=!0,n.timelimit_grace_expired=!0,e.timelimit_gracein>0&&r>0&&(n.timelimit_timer=setTimeout(()=>{this.handleTimelimitUp()},r),n.timelimit_grace_expired=!1))}else e.timelimit>0&&(e.enddate_in<e.timelimit?n.timelimit_restricted=1:e.enddate_in<e.timelimit+e.overtime_grace?n.timelimit_restricted=2:n.timelimit_restricted=0);if(e.hasOwnProperty("questions")&&e.hasOwnProperty("interquestion_text")&&rs(e,e.questions),e.hasOwnProperty("interquestion_text")&&as(e,e.questions),e.hasOwnProperty("noprint")&&e.noprint===1){const t=document.createElement("style");t.type="text/css",t.media="print",t.innerText="body { display: none;}",document.head.appendChild(t)}if(e.hasOwnProperty("livepoll_server")&&n.livepollServer===""){const t=document.createElement("script");t.src="https://"+e.livepoll_server+":3000/socket.io/socket.io.js",document.head.appendChild(t),n.livepollServer=e.livepoll_server}return e.hasOwnProperty("useMQ")&&(e.useMQ===!0&&!n.enableMQ?this.enableMQ():e.useMQ===!1&&n.enableMQ&&this.disableMQ()),e.hasOwnProperty("name")&&(window.document.title=e.name),e}},Cu={name:"DueDialog",data:function(){return{dialog:null}},components:{Icons:B},computed:{settings(){return n.assessInfo},latepassExtendMsg(){return this.$t("closed.latepass_needed",this.settings.can_use_latepass,{n:this.settings.can_use_latepass,date:this.settings.latepass_extendto_disp})},hasUnsubmitted(){return this.settings.submitby==="by_assessment"||Object.keys(A.getChangedQuestions()).length>0},unsubmittedMessage(){return this.settings.submitby==="by_question"?this.$t("duedialog.byq_unsubmitted"):this.$t("duedialog.bya_unsubmitted")},exitPrimary(){return!this.hasUnsubmitted&&!this.canUseLatePass}},methods:{closeDialog(){n.show_enddate_dialog=!1},submitNow(){A.endAssess(()=>{this.exit()})},useLatepass(){A.redeemLatePass(()=>{n.show_enddate_dialog=!1})},exit(){this.closeDialog(),window.exiturl&&window.exiturl!==""?(n.noUnload=!0,window.location=window.exiturl):A.routeToStart()}},mounted(){const e=n.lastPos;window.$(document).on("keyup.dialog",t=>{t.key==="Escape"&&this.closeDialog()}),this.dialog=new os(this.$refs.wrap),this.dialog.show(),window.innerHeight>2e3&&e!==null&&(this.$refs.dialog.style.top=Math.max(20,e-this.$refs.dialog.offsetHeight)+"px")},beforeUnmount(){window.$(document).off("keyup.dialog"),this.dialog.destroy()}},Du={class:"fullwrap",ref:"wrap"},Ru={class:"dialog-overlay",tabindex:"-1"},Qu={class:"pane-header flexrow",id:"duedialog_hdr"},Lu={style:{"flex-grow":"1"}},Mu={class:"pane-body",id:"duedialog_body"},Nu={key:0},ju={key:1};function Vu(e,t,i,r,a,s){const o=v("icons");return l(),c("div",Du,[h("div",Ru,[h("div",{class:"dialog",ref:"dialog",role:"alertdialog","aria-modal":"true","aria-labelledby":"duedialog_hdr","aria-describedby":"duedialog_body",tabindex:"-1",onClick:t[3]||(t[3]=se(()=>{},["stop"]))},[h("div",Qu,[h("div",Lu,[k(o,{name:"alert"}),q(" "+d(e.$t("duedialog.due")),1)])]),h("div",Mu,[h("p",null,d(e.$t("duedialog.nowdue")),1),s.settings.can_use_latepass>0&&s.settings.latepass_after?(l(),c("p",Nu,[q(d(e.$t("closed.latepassn",s.settings.latepasses_avail))+" ",1),t[4]||(t[4]=h("br",null,null,-1)),q(" "+d(s.latepassExtendMsg)+" ",1),t[5]||(t[5]=h("br",null,null,-1)),h("button",{onClick:t[0]||(t[0]=(...u)=>s.useLatepass&&s.useLatepass(...u)),class:"primary"},d(e.$t("closed.use_latepass",this.settings.can_use_latepass)),1)])):w("",!0),s.hasUnsubmitted?(l(),c("p",ju,[q(d(s.unsubmittedMessage)+" ",1),t[6]||(t[6]=h("br",null,null,-1)),h("button",{onClick:t[1]||(t[1]=(...u)=>s.submitNow&&s.submitNow(...u)),class:"primary"},d(e.$t("duedialog.submitnow")),1)])):w("",!0),h("p",null,[h("button",{class:z({primary:s.exitPrimary,secondary:!s.exitPrimary}),onClick:t[2]||(t[2]=(...u)=>s.exit&&s.exit(...u))},d(e.$t("closed.exit")),3)])])],512)])],512)}const Bu=x(Cu,[["render",Vu]]),Fu={components:{ErrorDialog:us,DueDialog:Bu,ConfirmDialog:ls},data:function(){return{prewarned:!1}},computed:{assessInfoLoaded(){return n.assessInfo!==null},hasError(){return n.errorMsg!==null},errorMsg(){return n.errorMsg},confirmObj(){return n.confirmObj},assessName(){return n.assessInfo.name},showDueDialog(){return n.show_enddate_dialog},lastPos(){return n.lastPos}},methods:{beforeUnload(e){Object.keys(n.autosaveQueue).length>0&&A.submitAutosave(!1);var t=!0;if(n.assessInfo.hasOwnProperty("questions")){let i=0;const r=n.assessInfo.questions.length;for(const a in n.assessInfo.questions)n.assessInfo.questions[a].try>0&&i++;i===r&&(t=!1)}if(!n.noUnload){if(!n.inProgress&&Object.keys(n.work).length>0&&!this.prewarned)return e.preventDefault(),this.prewarned=!1,this.$t("unload.unsubmitted_work");if(n.inProgress){if(Object.keys(A.getChangedQuestions()).length>0&&!this.prewarned)return e.preventDefault(),this.prewarned=!1,this.$t("unload.unsubmitted_questions");if(n.assessInfo.submitby==="by_assessment"&&n.assessInfo.has_active_attempt&&!this.prewarned)return e.preventDefault(),t?this.$t("unload.unsubmitted_assessment"):this.$t("unload.unsubmitted_done_assessment")}}this.prewarned=!1},clearError(){n.errorMsg=null},closeConfirm(){n.confirmObj=null}},created(){window.$(document).on("click",function(t){n.lastPos=t.pageY}),window.$(document).on("focusin",function(t){t.target&&t.target.getBoundingClientRect&&(n.lastPos=t.target.getBoundingClientRect().top)}),window.$(window).on("beforeunload",this.beforeUnload);var e=this;window.$("a").not('#app a, a[href="#"]').on("click",function(t){if(n.assessInfo.submitby==="by_assessment"&&n.assessInfo.has_active_attempt)return t.preventDefault(),n.confirmObj={body:"unload.unsubmitted_assessment",action:()=>{e.prewarned=!0,window.location=t.currentTarget.href}},!1;if(!n.inProgress&&Object.keys(n.work).length>0)return t.preventDefault(),n.confirmObj={body:"unload.unsubmitted_work",action:()=>{e.prewarned=!0,window.location=t.currentTarget.href}},!1})}},Gu={id:"app",role:"main"},Hu={key:0};function Uu(e,t,i,r,a,s){const o=v("router-view"),u=v("error-dialog"),f=v("due-dialog"),_=v("confirm-dialog");return l(),c("div",Gu,[s.assessInfoLoaded?w("",!0):(l(),c("div",Hu,d(e.$t("loading")),1)),s.assessInfoLoaded?(l(),T(o,{key:1})):w("",!0),s.hasError?(l(),T(u,{key:2,errormsg:s.errorMsg,lastpos:s.lastPos,onClearerror:s.clearError},null,8,["errormsg","lastpos","onClearerror"])):w("",!0),s.showDueDialog?(l(),T(f,{key:3})):w("",!0),s.confirmObj!==null?(l(),T(_,{key:4,data:s.confirmObj,lastpos:s.lastPos,onClose:s.closeConfirm},null,8,["data","lastpos","onClose"])):w("",!0)])}const Wu=x(Fu,[["render",Uu]]);cs(Wu).use(G).use(ds).mount("#app");export{tt as A,Te as F,Ee as I,we as Q,Wt as T,Ku as __vite_legacy_guard,$e as a,A as b,n as s};
