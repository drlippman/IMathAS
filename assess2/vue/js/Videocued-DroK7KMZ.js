import{a as F,s as i,I as S,A as b,Q as C,F as E}from"./index-zX0dKd_l.js";import{_ as y,I as L,e as c,j as p,l as f,k as u,q as j,g as d,m as _,t as m,z as k,o as r,M as A,A as N,C as O,J as R,B as Y,x as g,G as P,Z as x,F as M,f as B}from"./i18n-CTIODh6d.js";const z={name:"VideocuedNavListItem",props:["option","selected"],components:{Icons:L},mixins:[F],computed:{statusIcon(){if(this.option.type==="v"||this.option.type==="f")return"video";if(this.option.type==="q"){if(i.assessInfo.questions[this.option.qn].status==="unattempted"){if(this.qsAttempted[this.option.qn]===1)return"attempted";if(this.qsAttempted[this.option.qn]>0)return"partattempted"}return i.assessInfo.questions[this.option.qn].status}else return"none"},nameHover(){return this.option.type==="q"&&i.assessInfo.questions[this.option.qn].withdrawn!==0?this.$t("header.withdrawn"):""},scoreDisplay(){if(this.option.type!=="q")return"";{const e=i.assessInfo.questions[this.option.qn];if(e.hasOwnProperty("gbscore")){let t=e.canretry?"(":"[";return t+=e.gbscore+"/"+e.points_possible,t+=e.canretry?")":"]",t}else return this.$t("header.pts",e.points_possible)}},canRetry(){return this.option.type==="q"?i.assessInfo.questions[this.option.qn].canretry:!1},canRegen(){return this.option.type==="q"?i.assessInfo.questions[this.option.qn].regens_remaining:!1}}},H={class:"flex-nowrap-center"},Q={class:"qname-wrap"},D=["title"],G={key:0,class:"redoicon"},J={key:1,class:"redoicon"};function W(e,t,n,h,a,s){const o=d("icons");return r(),c("span",H,[p("span",Q,[u(o,{name:s.statusIcon,class:"qstatusicon"},null,8,["name"]),p("span",{class:_({greystrike:s.nameHover!==""}),title:s.nameHover},m(n.option.title),11,D),j(" "+m(s.scoreDisplay),1)]),n.selected?f("",!0):(r(),c("span",G,[s.canRetry?(r(),k(o,{key:0,name:"retry"})):f("",!0)])),n.selected?f("",!0):(r(),c("span",J,[s.canRegen?(r(),k(o,{key:0,name:"retake"})):f("",!0)]))])}const $=y(z,[["render",W]]),U={name:"VideocuedNav",props:["cue","toshow","showfollowup"],components:{MenuButton:A,VideocuedNavListItem:$},computed:{hasIntro(){return i.assessInfo.intro!==""},navOptions(){var e=[];this.hasIntro&&e.push({onclick:()=>this.$emit("jumpto",-1,"i"),title:this.$t("intro"),type:"i"});for(let t=0;t<i.assessInfo.videocues.length;t++){const n=i.assessInfo.videocues[t];e.push({onclick:()=>this.$emit("jumpto",t,"v"),type:"v",title:n.title,cue:t}),n.hasOwnProperty("qn")&&e.push({onclick:()=>this.$emit("jumpto",t,"q"),type:"q",title:this.$t("question_n",{n:parseInt(n.qn)+1}),qn:parseInt(n.qn),cue:t,subitem:!0}),n.hasOwnProperty("followuptime")&&(n.followuplink||this.showfollowup.includes(t))&&e.push({onclick:()=>this.$emit("jumpto",t,"f"),type:"f",title:n.followuptitle,cue:t,subitem:!0})}return e},curOption(){const e=parseInt(this.cue);if(e===-1&&this.hasIntro)return 0;for(let t=this.hasIntro?1:0;t<this.navOptions.length;t++)if(this.navOptions[t].cue===e&&this.navOptions[t].type===this.toshow)return t;return-1},showNextPrev(){return Object.keys(this.navOptions).length>1},prevLink(){return this.curOption<=0?"":this.navOptions[this.curOption-1].internallink},nextLink(){return this.curOption>=this.navOptions.length-1?"":this.navOptions[this.curOption+1].internallink}}},Z=["aria-label"];function K(e,t,n,h,a,s){const o=d("videocued-nav-list-item"),w=d("menu-button");return r(),c("div",{class:"subheader",role:"navigation","aria-label":e.$t("regions.qvidnav")},[u(w,{id:"qnav",options:s.navOptions,selected:s.curOption,searchby:"title"},{default:O(({option:v,selected:q})=>[u(o,{option:v,selected:q},null,8,["option","selected"])]),_:1},8,["options","selected"]),N(e.$slots,"default")],8,Z)}const X=y(U,[["render",K]]),ee={name:"VideocuedResultNav",props:["qn","cue","playing"],computed:{qdata(){return i.assessInfo.questions[this.qn]},showNav(){return i.inProgress&&i.assessInfo.hasOwnProperty("questions")&&this.qdata.hasOwnProperty("score")&&(this.qdata.try>0||this.qdata.hasOwnProperty("tries_remaining_range"))&&this.qdata.withdrawn===0},showScores(){return i.assessInfo.showscores==="during"},status(){if(!this.showScores||!this.qdata.hasOwnProperty("parts"))return"neutral";for(let e=0;e<this.qdata.parts.length;e++)if(this.qdata.parts[e].try===0||this.qdata.parts[e].rawscore<.98)return"neutral";return"correct"},nextVidType(){return i.assessInfo.videocues[this.cue].hasOwnProperty("followuptitle")?"followup":"nextseg"},hasNextVid(){return i.assessInfo.videocues[this.cue].hasOwnProperty("followuptitle")&&this.$emit("addfollowup",this.cue),this.nextVidType==="followup"||i.assessInfo.videocues.hasOwnProperty(this.cue+1)},nextVidTitle(){return this.nextVidType==="followup"?i.assessInfo.videocues[this.cue].followuptitle:i.assessInfo.videocues[this.cue+1].title},showSkip(){return this.status==="correct"&&this.nextVidType==="followup"&&i.assessInfo.videocues.hasOwnProperty(this.cue+1)},skipTitle(){return i.assessInfo.videocues[this.cue+1].title}},methods:{skipLink(){this.$emit("jumpto",this.cue+1,"v")},nextVidLink(){this.nextVidType==="followup"?this.$emit("jumpto",this.cue,"f"):this.$emit("jumpto",this.cue+1,"v")},startVid(){this.$emit("jumpto",this.cue===-1?0:this.cue,"rv")}}},te={key:0};function se(e,t,n,h,a,s){return n.qn===-1||s.showNav?(r(),c("div",te,[n.qn===-1&&!n.playing?(r(),c("button",{key:0,onClick:t[0]||(t[0]=(...o)=>s.startVid&&s.startVid(...o)),class:"primary"},m(e.$t("videocued.start")),1)):f("",!0),n.qn>-1&&s.hasNextVid?(r(),c("button",{key:1,onClick:t[1]||(t[1]=(...o)=>s.nextVidLink&&s.nextVidLink(...o)),class:_({primary:s.status!=="correct"||!s.showSkip})},m(e.$t("videocued.continue",{title:s.nextVidTitle})),3)):f("",!0),n.qn>-1&&s.showSkip?(r(),c("button",{key:2,onClick:t[2]||(t[2]=(...o)=>s.skipLink&&s.skipLink(...o)),class:"primary"},m(e.$t("videocued.skipto",{title:s.skipTitle})),1)):f("",!0)])):f("",!0)}const ie=y(ee,[["render",se]]),ne={name:"videocued",components:{FullQuestionHeader:E,VideocuedNav:X,Question:C,VideocuedResultNav:ie,InterQuestionTextList:R,AssessHeader:b,IntroText:S},data:function(){return{videoWidth:600,aspectRatioPercent:56.2,ytplayer:null,timer:null,cue:0,toshow:"v",showfolloup:[],playing:!1}},computed:{curCue(){return this.cue>-1?i.assessInfo.videocues[this.cue]:{}},qn(){return this.toshow==="q"?parseInt(this.curCue.qn):-1},timeCues(){const e={};for(const t in i.assessInfo.videocues)i.assessInfo.videocues[t].hasOwnProperty("qn")&&(e[i.assessInfo.videocues[t].time]=parseInt(t));return e},nextVidTimes(){const e={};for(let t=0;t<i.assessInfo.videocues.length;t++)i.assessInfo.videocues[t].hasOwnProperty("followuptime")&&i.assessInfo.videocues.hasOwnProperty(t+1)?e[i.assessInfo.videocues[t].followuptime]=t:!i.assessInfo.videocues[t].hasOwnProperty("qn")&&i.assessInfo.videocues.hasOwnProperty(t+1)&&(e[i.assessInfo.videocues[t].time]=t);return e},intro(){return i.assessInfo.intro},questionArray(){const e={};for(let t=0;t<i.assessInfo.questions.length;t++)e[t]=t;return e},lastQ(){return i.assessInfo.questions.length-1},textList(){return i.assessInfo.hasOwnProperty("interquestion_text")?i.assessInfo.interquestion_text:[]}},methods:{createPlayer(){const t={autoplay:0,wmode:"transparent",fs:!!(document.exitFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen||document.msExitFullscreen)?1:0,controls:2,rel:0,modestbranding:1,showinfo:0,origin:window.location.protocol+"//"+window.location.host},n=i.assessInfo.videoar.split(":"),h=window.innerHeight-50;this.videoWidth=n[0]/n[1]*h,this.aspectRatioPercent=Math.round(1e3*h/this.videoWidth)/10,this.ytplayer=new window.YT.Player("player",{height:h,width:this.videoWidth,videoId:i.assessInfo.videoid,playerVars:t,events:{onReady:()=>this.handlePlayerReady(),onStateChange:a=>this.handlePlayerStateChange(a),onError:a=>this.handlePlayerError(a)}})},exitFullscreen(){(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)&&(document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen())},checkTime(){const e=Math.floor(this.ytplayer.getCurrentTime());this.timeCues.hasOwnProperty(e)&&!(this.toshow==="v"&&this.cue===this.timeCues[e]+1)&&!(this.toshow==="f"&&this.cue===this.timeCues[e])&&this.ytplayer.getPlayerState()===window.YT.PlayerState.PLAYING?this.jumpTo(parseInt(this.timeCues[e]),"q"):(this.nextVidTimes.hasOwnProperty(e)&&this.cue===this.nextVidTimes[e]&&(this.cue=this.cue+1,this.toshow="v"),this.timer=window.setTimeout(()=>{this.checkTime()},200))},handlePlayerReady(){window.$("iframe#player").removeAttr("height").removeAttr("width").css("height","").css("width","")},handlePlayerStateChange(e){e.data===window.YT.PlayerState.PLAYING?this.timer=window.setTimeout(()=>{this.checkTime()},200):e.data===window.YT.PlayerState.ENDED&&this.toshow==="v"&&this.curCue.hasOwnProperty("qn")&&(window.clearTimeout(this.timer),this.jumpTo(this.cue,"q")),this.playing=e.data===window.YT.PlayerState.PLAYING||e.data===window.YT.PlayerState.BUFFERING},handlePlayerError(e){i.errorMsg=e.data},jumpTo(e,t,n=0){if(t==="rv"){if(this.ytplayer&&this.ytplayer.getPlayerState()===2){this.ytplayer.playVideo();return}t="v"}if(e===-1||t==="q")this.exitFullscreen(),this.ytplayer&&this.ytplayer.pauseVideo();else{if(this.ytplayer===null||typeof this.ytplayer.seekTo!="function"){n===0&&(i.errorMsg="ytnotready"),window.setTimeout(()=>{this.jumpTo(e,t,1)},100);return}else n>0&&(i.errorMsg=null);const h=i.assessInfo.videocues[e];let a=0;if(t==="v"){if(e>0){const s=i.assessInfo.videocues[e-1];s.hasOwnProperty("followuptime")?a=s.followuptime:a=s.time}}else t==="f"&&(a=h.time);this.ytplayer.seekTo(a,!0),this.ytplayer.playVideo()}this.cue=e,this.toshow=t},addShowFollowup(e){this.showfolloup.push(e)}},mounted(){if(window.YT)this.createPlayer();else if(window.onYouTubePlayerAPIReady=()=>{this.createPlayer()},!document.getElementById("yt_player_api")){const e=document.createElement("script");e.id="yt_player_api",e.src="https://www.youtube.com/player_api",document.head.appendChild(e)}},created(){i.assessInfo.intro!==""&&(this.cue=-1,this.toshow="i")}},oe={class:"home"},re=["aria-label"],ae={id:"playerwrapper"},le=["aria-hidden"];function ue(e,t,n,h,a,s){const o=d("assess-header"),w=d("videocued-result-nav"),v=d("videocued-nav"),q=d("intro-text"),I=d("inter-question-text-list"),T=d("full-question-header"),V=d("question");return r(),c("div",oe,[p("a",{href:"#",class:"sr-only",onClick:t[0]||(t[0]=Y(l=>e.$refs.scrollpane.focus(),["prevent"]))},m(e.$t("jumptocontent")),1),u(o),u(v,{cue:e.cue,toshow:e.toshow,showfollowup:e.showfolloup,onJumpto:s.jumpTo},{default:O(()=>[u(w,{class:"med-left",qn:s.qn,cue:e.cue,playing:e.playing,onJumpto:s.jumpTo,onAddfollowup:s.addShowFollowup},null,8,["qn","cue","playing","onJumpto","onAddfollowup"])]),_:1},8,["cue","toshow","showfollowup","onJumpto"]),p("div",{class:"scrollpane",role:"region",ref:"scrollpane",tabindex:"-1","aria-label":e.$t("regions.q_and_vid")},[u(q,{active:e.cue==-1,html:s.intro,key:"-1"},null,8,["active","html"]),g(p("div",ae,[p("div",{class:"video-wrapper-wrapper",style:x({"max-width":e.videoWidth+"px"})},[p("div",{class:"fluid-width-video-wrapper",style:x({"padding-bottom":e.aspectRatioPercent+"%"})},[...t[1]||(t[1]=[p("div",{id:"player"},null,-1)])],4)],4)],512),[[P,e.cue>-1&&s.qn===-1]]),(r(!0),c(M,null,B(s.questionArray,l=>(r(),c("div",{key:l,"aria-hidden":l!=s.qn,class:_({inactive:l!=s.qn})},[u(I,{pos:"before",qn:l,active:l==s.qn,textlist:s.textList,lastq:s.lastQ},null,8,["qn","active","textlist","lastq"]),g(u(T,{qn:l},null,8,["qn"]),[[P,l==s.qn]]),u(V,{qn:l,active:l==s.qn,getwork:1},null,8,["qn","active"]),u(I,{pos:"after",qn:l,active:l==s.qn,textlist:s.textList,lastq:s.lastQ},null,8,["qn","active","textlist","lastq"])],10,le))),128))],8,re)])}const he=y(ne,[["render",ue]]);export{he as default};
