var pi=Math.PI,ln=Math.log,e=Math.E,arcsin=Math.asin,arccos=Math.acos,arctan=Math.atan,sec=function(r){return 1/Math.cos(r)},csc=function(r){return 1/Math.sin(r)},cot=function(r){return 1/Math.tan(r)},arcsec=function(r){return arccos(1/r)},arccsc=function(r){return arcsin(1/r)},arccot=function(r){return arctan(1/r)},sinh=function(r){return(Math.exp(r)-Math.exp(-r))/2},cosh=function(r){return(Math.exp(r)+Math.exp(-r))/2},tanh=function(r){return(Math.exp(r)-Math.exp(-r))/(Math.exp(r)+Math.exp(-r))},sech=function(r){return 1/cosh(r)},csch=function(r){return 1/sinh(r)},coth=function(r){return 1/tanh(r)},arcsinh=function(r){return ln(r+Math.sqrt(r*r+1))},arccosh=function(r){return ln(r+Math.sqrt(r*r-1))},arctanh=function(r){return ln((1+r)/(1-r))/2},arcsech=(sech=function(r){return 1/cosh(r)},csch=function(r){return 1/sinh(r)},coth=function(r){return 1/tanh(r)},function(r){return arccosh(1/r)}),arccsch=function(r){return arcsinh(1/r)},arccoth=function(r){return arctanh(1/r)},sign=function(r){return 0==r?0:r<0?-1:1},logten=function(r){return Math.LOG10E*Math.log(r)},sinn=function(r,c){return Math.pow(Math.sin(c),r)},cosn=function(r,c){return Math.pow(Math.cos(c),r)},tann=function(r,c){return Math.pow(Math.tan(c),r)},cscn=function(r,c){return 1/Math.pow(Math.sin(c),r)},secn=function(r,c){return 1/Math.pow(Math.cos(c),r)},cotn=function(r,c){return 1/Math.pow(Math.tan(c),r)},lnn=function(r,c){return Math.pow(Math.log(c),r)};function factorial(r,c){null==c&&(c=1);for(var t=r-c;t>0;t-=c)r*=t;return r<0?NaN:0==r?1:r}function C(r,c){for(var t=1,n=0;n<c;n++)t*=(r-n)/(c-n);return t}function matchtolower(r){return r.toLowerCase()}function nthroot(r,c){return safepow(c,1/r)}function nthlogten(r,c){return Math.log(c)/Math.log(r)}var funcstoindexarr="sinh|cosh|tanh|sech|csch|coth|sqrt|ln|log|exp|sin|cos|tan|sec|csc|cot|abs|root|arcsin|arccos|arctan|arcsec|arccsc|arccot|arcsinh|arccosh|arctanh|arcsech|arccsch|arccoth|argsinh|argcosh|argtanh|argsech|argcsch|argcoth|arsinh|arcosh|artanh|arsech|arcsch|arcoth|pi".split("|");function functoindex(r){for(var c=0;c<funcstoindexarr.length;c++)if(funcstoindexarr[c]==r)return"@"+c+"@";return r}function indextofunc(r,c){return funcstoindexarr[c]}function safepow(r,c){if(r<0&&Math.floor(c)!=c){for(var t=3;t<50;t+=2)if(Math.abs(Math.round(t*c)-t*c)<1e-6)return Math.round(t*c)%2==0?Math.pow(Math.abs(r),c):-1*Math.pow(Math.abs(r),c);return Math.sqrt(-1)}return Math.pow(r,c)}function mathjs(r,c){if(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=r.replace(/(\+\s*-|-\s*\+)/g,"-").replace(/-\s*-/g,"+")).replace(/\[/g,"(")).replace(/\]/g,")")).replace(/\b00+\./g,"0.")).replace(/root\s*(\d+)/,"root($1)")).replace(/\|(.*?)\|/g,"abs($1)")).replace(/arc(sin|cos|tan|sec|csc|cot|sinh|cosh|tanh|sech|csch|coth)/gi,"$1^-1")).replace(/(ar|arg)(sinh|cosh|tanh|sech|csch|coth)/gi,"$2^-1")).replace(/(Sin|Cos|Tan|Sec|Csc|Cot|Arc|Abs|Log|Exp|Ln|Sqrt)/gi,matchtolower)).replace(/(sinh|cosh|tanh|sech|csch|coth|sqrt|ln|log|exp|sin|cos|tan|sec|csc|cot|abs|root)/g,functoindex),null!=c&&""!=c){var t=c.split("|");t.push("pi"),t.sort((function(r,c){return c.length-r.length})),c=t.join("|");for(var n=[],a=0;a<t.length;a++)if(n[a]=!1,"E"==t[a]||"e"==t[a])n[a]=!0;else for(var e=0;e<t.length;e++)if(a!=e&&t[e].toLowerCase()==t[a].toLowerCase()&&t[e]!=t[a]){n[a]=!0;break}r=r.replace(new RegExp("("+c+")","gi"),(function(r,c){for(var a=0;a<t.length;a++)if(t[a]==c||!n[a]&&t[a].toLowerCase()==c.toLowerCase())return"(@v"+a+"@)";return c}))}else r=r.replace(/pi/g,"(pi)");var o,s,h;for(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=r.replace(/([0-9])E([\-0-9])/g,"$1(EE)$2")).replace(/\*?\s*degrees?/g,"*((pi)/180)")).replace(/div/,"/")).replace(/e/g,"(E)")).replace(/@(\d+)@/g,indextofunc)).replace(/log_([a-zA-Z\d\.]+)\s*\(/g,"nthlog($1,")).replace(/log_\(([a-zA-Z\/\d\.]+)\)\s*\(/g,"nthlog(($1),")).replace(/log_(\(@v\d+@\))\s*\(/g,"nthlog($1,")).replace(/log/g,"logten")).replace(/(sin|cos|tan|sec|csc|cot|sinh|cosh|tanh|sech|csch|coth)\^(-1|\(-1\))/g,"arc$1")).replace(/(sin|cos|tan|sec|csc|cot|ln)\^(\d+)\s*\(/g,"$1n($2,")).replace(/(sin|cos|tan|sec|csc|cot|ln)\^\((\d+)\)\s*\(/g,"$1n($2,")).replace(/root\s*\(([a-zA-Z\/\d\.]+)\)\s*\(/g,"nthroot(($1),")).replace(/root\s*\(\((@v\d+@)\)\)\s*\(/g,"nthroot($1,")).replace(/([0-9]\.?)\s+([0-9])/g,"$1*$2")).replace(/#/g,"")).replace(/\s/g,""),null!=c&&""!=c&&(r=r.replace(/@v(\d+)@/g,(function(r,c){return t[c]}))),r=(r=(r=(r=r.replace(/([0-9]\.?)([\(a-zA-Z])/g,"$1*$2")).replace(/(!)([0-9\(a-zA-Z])/g,"$1*$2")).replace(/\)([\(0-9a-zA-Z]|\.\d+)/g,")*$1")).replace(/([0-9])\*\(EE\)\*?([\-0-9])/g,"$1e$2");-1!=(a=r.indexOf("!"));){if(0==a)return"Error: missing argument";if(e=a-1,(s=r.charAt(e))>="0"&&s<="9"||"."==s){for(e--;e>=0&&(s=r.charAt(e))>="0"&&s<="9";)e--;if("."==s)for(e--;e>=0&&(s=r.charAt(e))>="0"&&s<="9";)e--}else if(")"==s){for(h=1,e--;e>=0&&h>0;)"("==(s=r.charAt(e))?h--:")"==s&&h++,e--;for(;e>=0&&((s=r.charAt(e))>="a"&&s<="z"||s>="A"&&s<="Z");)e--}else{if(!(s>="a"&&s<="z"||s>="A"&&s<="Z"))return"Error: incorrect syntax in "+r+" at position "+e;for(e--;e>=0&&((s=r.charAt(e))>="a"&&s<="z"||s>="A"&&s<="Z");)e--}r=r.slice(0,e+1)+"factorial("+r.slice(e+1,a)+")"+r.slice(a+1)}for(;-1!=(a=r.lastIndexOf("^"));){if(0==a)return"Error: missing argument";if(e=a-1,(s=r.charAt(e))>="0"&&s<="9"||"."==s){for(e--;e>=0&&(s=r.charAt(e))>="0"&&s<="9";)e--;if("."==s)for(e--;e>=0&&(s=r.charAt(e))>="0"&&s<="9";)e--}else if(")"==s){for(h=1,e--;e>=0&&h>0;)"("==(s=r.charAt(e))?h--:")"==s&&h++,e--;for(;e>=0&&((s=r.charAt(e))>="a"&&s<="z"||s>="A"&&s<="Z");)e--}else{if(!(s>="a"&&s<="z"||s>="A"&&s<="Z"))return"Error: incorrect syntax in "+r+" at position "+e;for(e--;e>=0&&((s=r.charAt(e))>="a"&&s<="z"||s>="A"&&s<="Z");)e--}if(a==r.length-1)return"Error: missing argument";if(o=a+1,s=r.charAt(o),nch=r.charAt(o+1),s>="0"&&s<="9"||"-"==s&&"("!=nch||"."==s){for(o++;o<r.length&&(s=r.charAt(o))>="0"&&s<="9";)o++;if("."==s)for(o++;o<r.length&&(s=r.charAt(o))>="0"&&s<="9";)o++}else if("("==s||"-"==s&&"("==nch)for("-"==s&&o++,h=1,o++;o<r.length&&h>0;)"("==(s=r.charAt(o))?h++:")"==s&&h--,o++;else{if(!(s>="a"&&s<="z"||s>="A"&&s<="Z"))return"Error: incorrect syntax in "+r+" at position "+o;for(o++;o<r.length&&((s=r.charAt(o))>="a"&&s<="z"||s>="A"&&s<="Z");)o++;if("("==s&&r.slice(a+1,o).match(/^(sinn|cosn|tann|secn|cscn|cotn|sin|cos|tan|sec|csc|cot|logten|nthlogten|log|ln|exp|arcsin|arccos|arctan|arcsec|arccsc|arccot|sinh|cosh|tanh|sech|csch|coth|arcsinh|arccosh|arctanh|arcsech|arccsch|arccoth|sqrt|abs|nthroot|factorial|safepow)$/))for(h=1,o++;o<r.length&&h>0;)"("==(s=r.charAt(o))?h++:")"==s&&h--,o++}r=r.slice(0,e+1)+"safepow("+r.slice(e+1,a)+","+r.slice(a+1,o)+")"+r.slice(o)}return r}