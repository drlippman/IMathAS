!function(){var m,v,i,g,p,b,w,x,j,n,r,s,f,a,c,h,o,l,q,u,y,k,Q,L,t,C,e,S,D,O,E,A,R,T,z,B,$,I,_,W,M,F,U,P,H,K,N,G,X,Z,Y,J,V,tt,et,nt,it,rt,st,at,ot,ct,ht,lt,ut,pt,ft,dt,mt,gt,bt,vt,wt=window.jQuery,xt="mathquill-command-id",jt="mathquill-block-id",qt=Math.min,yt=(Math.max,[].slice);function kt(){}function Qt(t){var e=yt.call(arguments,1);return function(){return t.apply(this,e)}}function Lt(t,e){if(!e)throw new Error("prayer failed: "+t)}function Ct(t){return"object"==typeof t}function St(t){return"function"==typeof t}function Dt(){}function Ot(t){Lt("a direction was passed",t===b||t===w)}function Et(r,e,t,s){var a,o,c,n,h,l,i,u=r.contents().detach();function p(){n=m;var t=a.selection?"$"+a.selection.latex()+"$":"";i.select(t)}if(t||r.addClass("mathquill-rendered-math"),e.jQ=r.attr(jt,e.id),e.revert=function(){r.empty().unbind(".mathquill").removeClass("mathquill-rendered-math mathquill-editable mathquill-textbox").append(u)},a=e.cursor=Y(e),e.renderLatex(u.text()),c=(o=navigator.userAgent.match("Android")?e.textarea=x('<span class="textarea"><input type="password"/></span>'):e.textarea=x('<span class="textarea"><textarea></textarea></span>')).children(),e.selectionChanged=function(){n===m&&(n=setTimeout(p)),L(r[0])},r.bind("selectstart.mathquill",function(t){t.target!==c[0]&&t.preventDefault(),t.stopPropagation()}),l=a.blink,r.bind("mousedown.mathquill",function(t){function n(t){return a.seek(x(t.target),t.pageX,t.pageY),a[b]===h[b]&&a.parent===h.parent||a.selectFrom(h),!1}function i(t){return delete t.target,n(t)}return setTimeout(function(){document.activeElement!=c[0]&&c.focus()}),a.blink=kt,a.seek(x(t.target),t.pageX,t.pageY),h=j(a.parent,a[b],a[w]),s||r.prepend(o),r.mousemove(n),x(t.target.ownerDocument).mousemove(i).mouseup(function t(e){h=m,a.blink=l,a.selection||(s?a.show():o.detach()),r.unbind("mousemove",n),x(e.target.ownerDocument).unbind("mousemove",i).unbind("mouseup",t)}),!1}),!s){function f(){o.detach()}return i=g(c,{container:r}),r.bind("cut paste",!1).bind("copy",p).prepend('<span class="selectable">$'+e.latex()+"$</span>"),void c.blur(function(){a.clearSelection(),setTimeout(f)})}i=g(c,{container:r,key:function(t,e){a.parent.bubble("onKey",t,e)},text:function(t){a.parent.bubble("onText",t)},cut:function(t){a.selection&&setTimeout(function(){a.prepareEdit(),a.parent.bubble("redraw")}),t.stopPropagation()},paste:function(t){t="$"===t.slice(0,1)&&"$"===t.slice(-1)?t.slice(1,-1):"\\text{"+t+"}",a.writeLatex(t).show()}}),r.prepend(o),r.addClass("mathquill-editable"),t&&r.addClass("mathquill-textbox"),c.focus(function(t){a.parent||a.insAtRightEnd(e),a.parent.jQ.addClass("hasCursor"),a.selection?(a.selection.jQ.removeClass("blur"),setTimeout(e.selectionChanged)):a.show(),t.stopPropagation()}).blur(function(t){a.hide().parent.blur(),a.selection&&a.selection.jQ.addClass("blur"),t.stopPropagation()}),r.bind("focus.mathquill blur.mathquill",function(t){c.trigger(t)}).bind("click.mathquill",function(t){document.activeElement!=c[0]&&c.focus()}).blur()}for(e in v=navigator.userAgent.match("Android"),V="prototype",tt={}.hasOwnProperty,nt={8:"Backspace",9:"Tab",10:"Enter",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Esc",32:"Spacebar",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",45:"Insert",46:"Del",144:"NumLock"},g=function(t,e){var n,s,i,r,a,o,c,h,l=null,u=null;function p(t){c=t,clearTimeout(h),h=setTimeout(t)}function f(t){var e=wt.trim(a.val());a.val(" "),e&&t(e)}function d(){var t,e,n,i,r;s((n=(t=l).which||t.keyCode,i=nt[n],r=[],t.ctrlKey&&r.push("Ctrl"),t.originalEvent&&t.originalEvent.metaKey&&r.push("Meta"),t.altKey&&r.push("Alt"),t.shiftKey&&r.push("Shift"),e=i||String.fromCharCode(n),r.length||i?(r.push(e),r.join("-")):e),l)}function m(t){l.which||l.keyCode,l&&(u||v)&&d(),u=t,p(g)}function g(){var t;("selectionStart"in(t=a[0])?t.selectionStart!==t.selectionEnd:document.selection&&"Text"===document.selection.type&&document.selection.createRange&&document.selection.createRange().parentElement()===a[0])||f(n)}function b(){f(i)}return n=(e=e||{}).text||kt,s=e.key||kt,i=e.paste||kt,r=e.cut||kt,a=wt(t),o=wt(e.container||a),c=kt,o.bind("keydown keypress input keyup focusout paste",function(){c()}),o.bind({keydown:function(t){u=null,(l=t).which||l.keyCode,(v?m:d)()},keypress:m,focusout:function(){l=u=null},cut:r,paste:function(t){a.focus(),p(b)}}),{select:function(t){c(),c=kt,clearTimeout(h),a.val(t),t&&a[0].select()}}},p=(i=function e(n,t){var i,r,s;function a(){var t=new o;return St(t.init)&&t.init.apply(t,arguments),t}function o(){}return t===et&&(t=n,n=Object),a.Bare=o,i=Dt[V]=n[V],((r=o[V]=a[V]=new Dt).constructor=a).mixin=function(t){return o[V]=a[V]=e(a,t)[V],a},(a.open=function(t){if(s={},St(t)?s=t.call(a,r,i,a,n):Ct(t)&&(s=t),Ct(s))for(var e in s)tt.call(s,e)&&(r[e]=s[e]);return St(r.init)||(r.init=n),a})(t)})(function(t,e,o){var n,i,r;function s(t,e){throw"Parse Error: "+e+" at "+(t=t?"'"+t+"'":"EOF")}t.init=function(t){this._=t},t.parse=function(t){return this.skip(r)._(t,function(t,e){return e},s)},t.or=function(r){Lt("or is passed a parser",r instanceof o);var t=this;return o(function(e,n,i){return t._(e,n,function(t){return r._(e,n,i)})})},t.then=function(s){var e=this;return o(function(t,i,r){return e._(t,function(t,e){var n=s instanceof o?s:s(e);return Lt("a parser is returned",n instanceof o),n._(t,i,r)},r)})},t.many=function(){var a=this;return o(function(n,t,e){for(var i=[];a._(n,r,s););return t(n,i);function r(t,e){return n=t,i.push(e),!0}function s(){return!1}})},t.times=function(l,u){arguments.length<2&&(u=l);var p=this;return o(function(n,t,e){var i,r,s=[],a=!0;for(r=0;r<l;r+=1)if(!(a=p._(n,o,c)))return e(n,i);for(;r<u&&a;r+=1)a=p._(n,o,h);return t(n,s);function o(t,e){return s.push(e),n=t,!0}function c(t,e){return i=e,n=t,!1}function h(t,e){return!1}})},t.result=function(t){return this.then(i(t))},t.atMost=function(t){return this.times(0,t)},t.atLeast=function(t){var n=this;return n.times(t).then(function(e){return n.many().map(function(t){return e.concat(t)})})},t.map=function(e){return this.then(function(t){return i(e(t))})},t.skip=function(e){return this.then(function(t){return e.result(t)})},this.string=function(r){var s=r.length,a="expected '"+r+"'";return o(function(t,e,n){var i=t.slice(0,s);return i===r?e(t.slice(s),i):n(t,a)})},n=this.regex=function(s){Lt("regexp parser is anchored","^"===s.toString().charAt(1));var a="expected "+s;return o(function(t,e,n){var i,r=s.exec(t);return r?(i=r[0],e(t.slice(i.length),i)):n(t,a)})},i=o.succeed=function(n){return o(function(t,e){return e(t,n)})},o.fail=function(i){return o(function(t,e,n){return n(t,i)})},o.letter=n(/^[a-z]/i),o.letters=n(/^[a-z]*/i),o.digit=n(/^[0-9]/),o.digits=n(/^[0-9]*/),o.whitespace=n(/^\s+/),o.optWhitespace=n(/^\s*/),o.any=o(function(t,e,n){return t?e(t.slice(1),t.charAt(0)):n(t,"expected any character")}),o.all=o(function(t,e,n){return e("",t)}),r=o.eof=o(function(t,e,n){return t?n(t,"expected EOF"):e(t,t)})}),b=-1,w=1,x=i(wt,function(t){t.insDirOf=function(t,e){return t===b?this.insertBefore(e.first()):this.insertAfter(e.last())},t.insAtDirEnd=function(t,e){return t===b?this.prependTo(e):this.appendTo(e)}}),j=i(function(t){t.parent=0,t[b]=0,t[w]=0,t.init=function(t,e,n){this.parent=t,this[b]=e,this[w]=n}}),n=i(function(t){t[b]=0,t[w]=0,t.parent=0,t.init=function(){this.ends={},this.ends[b]=0,this.ends[w]=0},t.children=function(){return r(this.ends[b],this.ends[w])},t.eachChild=function(t){return this.children().each(t)},t.foldChildren=function(t,e){return this.children().fold(t,e)},t.adopt=function(t,e,n){return r(this,this).adopt(t,e,n),this},t.disown=function(){return r(this,this).disown(),this}}),r=i(function(t){function a(t,e,n){Lt("a parent is always present",t),Lt("leftward is properly set up",e?e[w]===n&&e.parent===t:t.ends[b]===n),Lt("rightward is properly set up",n?n[b]===e&&n.parent===t:t.ends[w]===e)}t.init=function(t,e){Lt("no half-empty fragments",!t==!e),this.ends={},t&&(Lt("left end node is passed to Fragment",t instanceof n),Lt("right end node is passed to Fragment",e instanceof n),Lt("leftEnd and rightEnd have the same parent",t.parent===e.parent),this.ends[b]=t,this.ends[w]=e)},t.adopt=function(e,n,t){var i,r,s;return a(e,n,t),(i=this).disowned=!1,(r=i.ends[b])?(s=i.ends[w],n||(e.ends[b]=r),t?t[b]=s:e.ends[w]=s,i.ends[w][w]=t,i.each(function(t){t[b]=n,t.parent=e,n&&(n[w]=t),n=t}),i):this},t.disown=function(){var t,e,n=this,i=n.ends[b];return!i||n.disowned||(n.disowned=!0,t=n.ends[w],a(e=i.parent,i[b],i),a(e,t,t[w]),i[b]?i[b][w]=t[w]:e.ends[b]=t[w],t[w]?t[w][b]=i[b]:e.ends[w]=i[b]),n},t.each=function(t){var e=this,n=e.ends[b];if(!n)return e;for(;n!==e.ends[w][w]&&!1!==t.call(e,n);n=n[w]);return e},t.fold=function(e,n){return this.each(function(t){e=n.call(this,e,t)}),e}}),it=0,s=function(){return it+=1},f=i(n,function(t,e){t.init=function(t){e.init.call(this),this.id=s(),f[this.id]=this},t.toString=function(){return"[MathElement "+this.id+"]"},t.bubble=function(t){var e,n=yt.call(arguments,1);for(e=this;e&&!1!==(e[t]&&e[t].apply(e,n));e=e.parent);return this},t.postOrder=function(n){var e,i=yt.call(arguments,1);"string"==typeof n&&(e=n,n=function(t){e in t&&t[e].apply(t,i)}),function t(e){e.eachChild(t),n(e)}(this)},t.jQ=x(),t.jQadd=function(t){this.jQ=this.jQ.add(t)},this.jQize=function(t){var e=x(t);return e.find("*").andSelf().each(function(){var t=x(this),e=t.attr("mathquill-command-id"),n=t.attr("mathquill-block-id");e&&f[e].jQadd(t),n&&f[n].jQadd(t)}),e},t.finalizeInsert=function(){var t=this;t.postOrder("finalizeTree"),t.postOrder("blur"),t.postOrder("respace"),t[w].respace&&t[w].respace(),t[b].respace&&t[b].respace(),t.postOrder("redraw"),t.bubble("redraw")}}),a=i(f,function(t,r){t.init=function(t,e,n){var i=this;r.init.call(i),i.ctrlSeq||(i.ctrlSeq=t),e&&(i.htmlTemplate=e),n&&(i.textTemplate=n)},t.replaces=function(t){t.disown(),this.replacedFragment=t},t.isEmpty=function(){return this.foldChildren(!0,function(t,e){return t&&e.isEmpty()})},t.parser=function(){var t=Z.block,n=this;return t.times(n.numBlocks()).map(function(t){n.blocks=t;for(var e=0;e<t.length;e+=1)t[e].adopt(n,n.ends[w],0);return n})},t.createLeftOf=function(t){var e=this,n=e.replacedFragment;e.createBlocks(),f.jQize(e.html()),n&&(n.adopt(e.ends[b],0,0),n.jQ.appendTo(e.ends[b].jQ)),t.jQ.before(e.jQ),t[b]=e.adopt(t.parent,t[b],t[w]),e.finalizeInsert(t),e.placeCursor(t)},t.createBlocks=function(){var t,e=this,n=e.numBlocks(),i=e.blocks=Array(n);for(t=0;t<n;t+=1)(i[t]=h()).adopt(e,e.ends[w],0)},t.respace=kt,t.placeCursor=function(t){t.insAtRightEnd(this.foldChildren(this.ends[b],function(t,e){return t.isEmpty()?t:e}))},t.remove=function(){return this.disown(),this.jQ.remove(),this.postOrder(function(t){delete f[t.id]}),this},t.numBlocks=function(){var t=this.htmlTemplate.match(/&\d+/g);return t?t.length:0},t.html=function(){var t,e,n,i=this,r=i.blocks,s=" mathquill-command-id="+i.id,a=i.htmlTemplate.match(/<[^<>]+>|[^<>]+/g);for(Lt("no unmatched angle brackets",a.join("")===this.htmlTemplate),e=a[t=0];e;e=a[t+=1])if("/>"===e.slice(-2))a[t]=e.slice(0,-2)+s+"/>";else if("<"===e.charAt(0))for(Lt("not an unmatched top-level close tag","/"!==e.charAt(1)),a[t]=e.slice(0,-1)+s+">",n=1;Lt("no missing close tags",e=a[t+=1]),"</"===e.slice(0,2)?--n:"<"===e.charAt(0)&&"/>"!==e.slice(-2)&&(n+=1),0<n;);return a.join("").replace(/>&(\d+)/g,function(t,e){return" mathquill-block-id="+r[e].id+">"+r[e].join("html")})},t.latex=function(){return this.foldChildren(this.ctrlSeq,function(t,e){return t+"{"+(e.latex()||" ")+"}"})},t.textTemplate=[""],t.text=function(){var i=0;return this.foldChildren(this.textTemplate[i],function(t,e){i+=1;var n=e.text();return t&&"("===this.textTemplate[i]&&"("===n[0]&&")"===n.slice(-1)?t+n.slice(1,-1)+this.textTemplate[i]:t+e.text()+(this.textTemplate[i]||"")})}}),c=i(a,function(t,i){t.init=function(t,e,n){n=n||(t&&1<t.length?t.slice(1):t),i.init.call(this,t,e,[n])},t.parser=function(){return p.succeed(this)},t.numBlocks=function(){return 0},t.replaces=function(t){t.remove()},t.createBlocks=kt,t.latex=function(){return this.ctrlSeq},t.text=function(){return this.textTemplate},t.placeCursor=kt,t.isEmpty=function(){return!0}}),h=i(f,function(t){t.join=function(n){return this.foldChildren("",function(t,e){return t+e[n]()})},t.latex=function(){return this.join("latex")},t.text=function(){return this.ends[b]===this.ends[w]?this.ends[b].text():"("+this.join("text")+")"},t.isEmpty=function(){return 0===this.ends[b]&&0===this.ends[w]},t.write=function(t,e,n){var i;i=(e.match(/^[a-eg-zA-Z]$/)?F:(i=y[e]||k[e])?i:U)(e),n&&i.replaces(n),i.createLeftOf(t)},t.focus=function(){return this.jQ.addClass("hasCursor"),this.jQ.removeClass("empty"),this},t.blur=function(){return this.jQ.removeClass("hasCursor"),this.isEmpty()&&this.jQ.addClass("empty"),this}}),o=i(r,function(t,n){t.init=function(t,e){n.init.call(this,t,e||t),this.jQ=this.fold(x(),function(t,e){return e.jQ.add(t)})},t.latex=function(){return this.fold("",function(t,e){return t+e.latex()})},t.remove=function(){return this.jQ.remove(),this.each(function(t){t.postOrder(function(t){delete f[t.id]})}),this.disown()}}),l=i(h,function(t,e){t.latex=function(){return e.latex.call(this).replace(/(\\[a-z]+) (?![a-z])/gi,"$1")},t.text=function(){return this.foldChildren("",function(t,e){return t+e.text()})},t.renderLatex=function(t){this.jQ.children().slice(1).remove(),this.ends[b]=this.ends[w]=0,delete this.cursor.selection,this.cursor.insAtRightEnd(this).writeLatex(t)},t.onKey=function(t,e){var n;switch(t){case"Ctrl-Shift-Backspace":case"Ctrl-Backspace":for(;this.cursor[b]||this.cursor.selection;)this.cursor.backspace();break;case"Shift-Backspace":case"Backspace":this.cursor.backspace();break;case"Esc":case"Tab":case"Spacebar":if((n=this.cursor.parent)===this.cursor.root)return void("Spacebar"===t&&e.preventDefault());this.cursor.prepareMove(),n[w]?this.cursor.insAtLeftEnd(n[w]):this.cursor.insRightOf(n.parent);break;case"Shift-Tab":case"Shift-Esc":case"Shift-Spacebar":if((n=this.cursor.parent)===this.cursor.root)return void("Shift-Spacebar"===t&&e.preventDefault());this.cursor.prepareMove(),n[b]?this.cursor.insAtRightEnd(n[b]):this.cursor.insLeftOf(n.parent);break;case"Enter":"function"==typeof savemathquill&&savemathquill();break;case"End":this.cursor.prepareMove().insAtRightEnd(this.cursor.parent);break;case"Ctrl-End":this.cursor.prepareMove().insAtRightEnd(this);break;case"Shift-End":for(;this.cursor[w];)this.cursor.selectRight();break;case"Ctrl-Shift-End":for(;this.cursor[w]||this.cursor.parent!==this;)this.cursor.selectRight();break;case"Home":this.cursor.prepareMove().insAtLeftEnd(this.cursor.parent);break;case"Ctrl-Home":this.cursor.prepareMove().insAtLeftEnd(this);break;case"Shift-Home":for(;this.cursor[b];)this.cursor.selectLeft();break;case"Ctrl-Shift-Home":for(;this.cursor[b]||this.cursor.parent!==this;)this.cursor.selectLeft();break;case"Left":this.cursor.moveLeft();break;case"Shift-Left":this.cursor.selectLeft();break;case"Ctrl-Left":break;case"Right":this.cursor.moveRight();break;case"Shift-Right":this.cursor.selectRight();break;case"Ctrl-Right":break;case"Up":this.cursor.moveUp();break;case"Down":this.cursor.moveDown();break;case"Shift-Up":if(this.cursor[b])for(;this.cursor[b];)this.cursor.selectLeft();else this.cursor.selectLeft();case"Shift-Down":if(this.cursor[w])for(;this.cursor[w];)this.cursor.selectRight();else this.cursor.selectRight();case"Ctrl-Up":case"Ctrl-Down":break;case"Ctrl-Shift-Del":case"Ctrl-Del":for(;this.cursor[w]||this.cursor.selection;)this.cursor.deleteForward();break;case"Shift-Del":case"Del":this.cursor.deleteForward();break;case"Meta-A":case"Ctrl-A":if(this!==this.cursor.root)return;for(this.cursor.prepareMove().insAtRightEnd(this);this.cursor[b];)this.cursor.selectLeft();break;default:return!1}return e.preventDefault(),!1},t.onText=function(t){return this.cursor.write(t),!1}}),q=i(a,function(t,e){t.init=function(t){e.init.call(this,"$"),this.cursor=t},t.htmlTemplate='<span class="mathquill-rendered-math">&0</span>',t.createBlocks=function(){this.ends[b]=this.ends[w]=l(),this.blocks=[this.ends[b]],(this.ends[b].parent=this).ends[b].cursor=this.cursor,this.ends[b].write=function(t,e,n){"$"!==e?h.prototype.write.call(this,t,e,n):this.isEmpty()?(t.insRightOf(this.parent).backspace().show(),U("\\$","$").createLeftOf(t)):t[w]?t[b]?h.prototype.write.call(this,t,e,n):t.insLeftOf(this.parent):t.insRightOf(this.parent)}},t.latex=function(){return"$"+this.ends[b].latex()+"$"}}),u=i(h,function(t){t.renderLatex=function(t){var e,n,i,r,s,a,o,c,h,l=this,u=l.cursor;if(l.jQ.children().slice(1).remove(),l.ends[b]=l.ends[w]=0,delete u.selection,u.show().insAtRightEnd(l),e=p.regex,n=p.string,i=p.eof,r=p.all,s=n("$").then(Z).skip(n("$").or(i)).map(function(t){var e,n=q(u);return n.createBlocks(),e=n.ends[b],t.children().adopt(e,0,0),n}),a=n("\\$").result("$").or(e(/^[^$]/)).map(U),o=s.or(a).many().skip(i).or(r.result(!1)).parse(t)){for(c=0;c<o.length;c+=1)o[c].adopt(l,l.ends[w],0);h=l.join("html"),f.jQize(h).appendTo(l.jQ),this.finalizeInsert()}},t.onKey=function(t){"Spacebar"!==t&&"Shift-Spacebar"!==t&&l.prototype.onKey.apply(this,arguments)},t.onText=l.prototype.onText,t.write=function(t,e,n){var i;(n&&n.remove(),"$"===e)?q(t).createLeftOf(t):("<"===e?i="&lt;":">"===e&&(i="&gt;"),U(e,i).createLeftOf(t))}}),y={},k={},L=kt,t=document.createElement("div").style,{transform:1,WebkitTransform:1,MozTransform:1,OTransform:1,msTransform:1})if(e in t){C=e;break}function At(t,e,n){return i(_,{ctrlSeq:t,htmlTemplate:"<"+e+" "+n+">&0</"+e+">"})}function Rt(t){var e,n=t[0]||h();for(e=1;e<t.length;e+=1)t[e].children().adopt(n,n.ends[w],0);return n}Q=C?function(t,e,n){t.css(C,"scale("+e+","+n+")")}:"filter"in t?(L=function(t){t.className=t.className},function(t,e,n){function i(){t.css("marginRight",(1+t.width())*(e-1)/e+"px")}e/=1+(n-1)/2,t.addClass("matrixed").css({fontSize:n+.05+"em",marginTop:"-.05em",filter:"progid:DXImageTransform.Microsoft.Matrix(M11="+e+",SizingMethod='auto expand')"}),i();var r=setInterval(i);x(window).load(function(){clearTimeout(r),i()})}):function(t,e,n){t.css("fontSize",n+"em")},S=i(a,function(t,i){t.init=function(t,e,n){i.init.call(this,t,"<"+e+" "+n+">&0</"+e+">")}}),k.mathrm=Qt(S,"\\mathrm","span",'class="roman font"'),k.mathit=Qt(S,"\\mathit","i",'class="font"'),k.mathbf=Qt(S,"\\mathbf","b",'class="font"'),k.mathsf=Qt(S,"\\mathsf","span",'class="sans-serif font"'),k.mathtt=Qt(S,"\\mathtt","span",'class="monospace font"'),k.underline=Qt(S,"\\underline","span",'class="non-leaf underline"'),k.overline=k.bar=Qt(S,"\\overline","span",'class="non-leaf overline"'),D=i(a,function(t,i){t.init=function(t,e,n){i.init.call(this,t,"<"+e+' class="non-leaf">&0</'+e+">",[n])},t.finalizeTree=function(){function t(t){var e=this.parent,n=t;do{if(n[w])return t.insLeftOf(e),!1;n=n.parent.parent}while(n!==e);return t.insRightOf(e),!1}Lt("SupSub is only _ and ^","^"===this.ctrlSeq||"_"===this.ctrlSeq),"_"===this.ctrlSeq?(this.down=this.ends[b],this.ends[b].up=t):(this.up=this.ends[b],this.ends[b].down=t)},t.latex=function(){var t=this.ends[b].latex();return 1===t.length?this.ctrlSeq+t:this.ctrlSeq+"{"+(t||" ")+"}"},t.redraw=function(){this[b]&&this[b].respace(),this[b]instanceof D||(this.respace(),!this[w]||this[w]instanceof D||this[w].respace())},t.respace=function(){if("\\int "===this[b].ctrlSeq||this[b]instanceof D&&this[b].ctrlSeq!=this.ctrlSeq&&this[b][b]&&"\\int "===this[b][b].ctrlSeq?this.limit||(this.limit=!0,this.jQ.addClass("limit")):this.limit&&(this.limit=!1,this.jQ.removeClass("limit")),this.respaced=this[b]instanceof D&&this[b].ctrlSeq!=this.ctrlSeq&&!this[b].respaced,this.respaced){var t=+this.jQ.css("fontSize").slice(0,-2),e=this[b].jQ.outerWidth(),n=this.jQ.outerWidth();this.jQ.css({left:(this.limit&&"_"===this.ctrlSeq?-.25:0)-e/t+"em",marginRight:.1-qt(n,e)/t+"em"})}else this.limit&&"_"===this.ctrlSeq?this.jQ.css({left:"-.25em",marginRight:""}):this.jQ.css({left:"",marginRight:""});return this[w]instanceof D&&this[w].respace(),this}}),k.subscript=k._=Qt(D,"_","sub","_"),k.superscript=k.supscript=k["^"]=Qt(D,"^","sup","**"),O=k.frac=k.dfrac=k.cfrac=k.fraction=i(a,function(t,e){t.ctrlSeq="\\frac",t.htmlTemplate='<span class="fraction non-leaf"><span class="numerator">&0</span><span class="denominator">&1</span><span style="display:inline-block;width:0">&nbsp;</span></span>',t.textTemplate=["(","/",")"],t.finalizeTree=function(){this.up=this.ends[w].up=this.ends[b],this.down=this.ends[b].down=this.ends[w]},t.redraw=function(){if(wt.browser.msie&&parseInt(wt.browser.version,10)<=7){var t,e=this.jQ,n=e.children(".numerator"),i=e.children(".denominator");n.css("width","auto"),i.css("width","auto"),t=Math.max(n.width(),i.width()),n.css("width",t+"px"),i.css("width",t+"px")}}}),E=k.over=y["/"]=i(O,function(t,n){t.createLeftOf=function(t){if(!this.replacedFragment){for(var e=t[b];e&&!(e instanceof K||e instanceof _||e instanceof G||-1<",;:".indexOf(e.ctrlSeq));)e=e[b];e instanceof G&&e[w]instanceof D&&(e=e[w])[w]instanceof D&&e[w].ctrlSeq!=e.ctrlSeq&&(e=e[w]),e!==t[b]&&(this.replaces(o(e[w]||t.parent.ends[b],t[b])),t[b]=e)}n.createLeftOf.call(this,t)}}),A=k.sqrt=k["âˆš"]=i(a,function(t,e){t.ctrlSeq="\\sqrt",t.htmlTemplate='<span class="non-leaf"><span class="scaled sqrt-prefix">&radic;</span><span class="non-leaf sqrt-stem">&0</span></span>',t.textTemplate=["sqrt(",")"],t.parser=function(){return Z.optBlock.then(function(n){return Z.block.map(function(t){var e=R();return e.blocks=[n,t],n.adopt(e,0,0),t.adopt(e,n,0),e})}).or(e.parser.call(this))},t.redraw=function(){var t=this.ends[w].jQ;Q(t.prev(),1,t.innerHeight()/t.css("fontSize").slice(0,-2)-.1)}}),k.vec=i(a,function(t,e){t.ctrlSeq="\\vec",t.htmlTemplate='<span class="non-leaf"><span class="vector-prefix">&rarr;</span><span class="vector-stem">&0</span></span>',t.textTemplate=["vec(",")"]}),R=k.nthroot=i(A,function(t,e){t.htmlTemplate='<sup class="nthroot non-leaf">&0</sup><span class="scaled"><span class="sqrt-prefix scaled">&radic;</span><span class="sqrt-stem non-leaf">&1</span></span>',t.textTemplate=["sqrt[","](",")"],t.latex=function(){return"\\sqrt["+this.ends[b].latex()+"]{"+this.ends[w].latex()+"}"}}),T=i(a,function(t,r){t.init=function(t,e,n,i){r.init.call(this,"\\left"+n,'<span class="non-leaf"><span class="scaled paren">'+t+'</span><span class="non-leaf">&0</span><span class="scaled paren">'+e+"</span></span>",[t,e]),this.end="\\right"+i},t.jQadd=function(){r.jQadd.apply(this,arguments);var t=this.jQ;this.bracketjQs=t.children(":first").add(t.children(":last"))},t.latex=function(){return this.ctrlSeq+this.ends[b].latex()+this.end},t.redraw=function(){var t=this.ends[b].jQ,e=t.outerHeight()/t.css("fontSize").slice(0,-2);Q(this.bracketjQs,qt(1+.2*(e-1),1.2),1.05*e)}}),k.left=i(a,function(t){t.parser=function(){var n=p.regex,i=p.string,r=p.succeed,s=p.optWhitespace;return s.then(n(/^(?:[([|]|\\\{)/)).then(function(t){"\\"===t.charAt(0)&&(t=t.slice(1));var e=y[t]();return Z.map(function(t){e.blocks=[t],t.adopt(e,0,0)}).then(i("\\right")).skip(s).then(n(/^(?:[\])|]|\\\})/)).then(function(t){return t.slice(-1)!==e.end.slice(-1)?p.fail("open doesn't match close"):r(e)})})}}),k.right=i(a,function(t){t.parser=function(){return p.fail("unmatched \\right")}}),k.intervalopenleft=Qt(T,"(","]","(","]"),k.intervalopenright=Qt(T,"[",")","[",")"),k.lbrace=y["{"]=Qt(T,"{","}","\\{","\\}"),k.langle=k.lang=Qt(T,"&lang;","&rang;","\\langle ","\\rangle "),z=i(T,function(t,e){t.createLeftOf=function(t){t[w]||!t.parent.parent||t.parent.parent.end!==this.end||this.replacedFragment?e.createLeftOf.call(this,t):t.insRightOf(t.parent.parent)},t.placeCursor=function(t){this.ends[b].blur(),t.insRightOf(this)}}),k.rbrace=y["}"]=Qt(z,"{","}","\\{","\\}"),k.rangle=k.rang=Qt(z,"&lang;","&rang;","\\langle ","\\rangle "),$=i(T,B=function(t,n){t.init=function(t,e){n.init.call(this,t,e,t,e)}}),k.lparen=y["("]=Qt($,"(",")"),k.lbrack=k.lbracket=y["["]=Qt($,"[","]"),I=i(z,B),k.rparen=y[")"]=Qt(I,"(",")"),k.rbrack=k.rbracket=y["]"]=Qt(I,"[","]"),k.lpipe=k.rpipe=y["|"]=i($,function(t,e){t.init=function(){e.init.call(this,"|","|")},t.createLeftOf=z.prototype.createLeftOf}),_=y.$=k.text=k.textnormal=k.textrm=k.textup=k.textmd=i(a,function(t,n){t.ctrlSeq="\\text",t.htmlTemplate='<span class="text">&0</span>',t.replaces=function(t){t instanceof o?this.replacedText=t.remove().jQ.text():"string"==typeof t&&(this.replacedText=t)},t.textTemplate=['"','"'],t.parser=function(){var i=this,t=p.string,e=p.regex,n=p.optWhitespace;return n.then(t("{")).then(e(/^[^}]*/)).skip(t("}")).map(function(t){var e,n;for(i.createBlocks(),e=i.ends[b],n=0;n<t.length;n+=1)U(t.charAt(n)).adopt(e,e.ends[w],0);return i})},t.createBlocks=function(){this.ends[b]=this.ends[w]=W(),this.blocks=[this.ends[b]],this.ends[b].parent=this},t.finalizeInsert=function(){this.ends[b].blur=function(){return delete this.blur,this},n.finalizeInsert.call(this)},t.createLeftOf=function(t){if(n.createLeftOf.call(this,this.cursor=t),this.replacedText)for(var e=0;e<this.replacedText.length;e+=1)this.ends[b].write(t,this.replacedText.charAt(e))}}),W=i(h,function(t,r){t.onKey=function(t,e){if("Spacebar"===t||"Shift-Spacebar"===t)return!1},t.deleteOutOf=function(t,e){this.isEmpty()&&e.insRightOf(this.parent)},t.write=function(t,e,n){var i,r;return n&&n.remove(),"$"!==e?("<"===e?i="&lt;":">"===e&&(i="&gt;"),U(e,i).createLeftOf(t)):this.isEmpty()?(t.insRightOf(this.parent).backspace(),U("\\$","$").createLeftOf(t)):t[w]?t[b]?((r=_()).replaces(o(t[w],this.ends[w])),t.insRightOf(this.parent),r.adopt=function(){delete this.adopt,this.adopt.apply(this,arguments),this[b]=0},r.createLeftOf(t),r[b]=this.parent,t.insLeftOf(r)):t.insLeftOf(this.parent):t.insRightOf(this.parent),!1},t.blur=function(){if(this.jQ.removeClass("hasCursor"),this.isEmpty()){var t=this.parent,e=t.cursor;e.parent===this?this.jQ.addClass("empty"):(e.hide(),t.remove(),e[w]===t?e[w]=t[w]:e[b]===t&&(e[b]=t[b]),e.show().parent.bubble("redraw"))}return this},t.focus=function(){var t,e,n,i;return r.focus.call(this),(t=this.parent)[w].ctrlSeq===t.ctrlSeq?(e=this,n=t.cursor,(i=t[w].ends[b]).eachChild(function(t){t.parent=e,t.jQ.appendTo(e.jQ)}),this.ends[w]?this.ends[w][w]=i.ends[b]:this.ends[b]=i.ends[b],i.ends[b][b]=this.ends[w],this.ends[w]=i.ends[w],i.parent.remove(),n[b]?n.insRightOf(n[b]):n.insAtLeftEnd(this),n.parent.bubble("redraw")):t[b].ctrlSeq===t.ctrlSeq&&((n=t.cursor)[b]?t[b].ends[b].focus():n.insAtRightEnd(t[b].ends[b])),this}}),k.em=k.italic=k.italics=k.emph=k.textit=k.textsl=At("\\textit","i",'class="text"'),k.strong=k.bold=k.textbf=At("\\textbf","b",'class="text"'),k.sf=k.textsf=At("\\textsf","span",'class="sans-serif text"'),k.tt=k.texttt=At("\\texttt","span",'class="monospace text"'),k.textsc=At("\\textsc","span",'style="font-variant:small-caps" class="text"'),k.uppercase=At("\\uppercase","span",'style="text-transform:uppercase" class="text"'),k.lowercase=At("\\lowercase","span",'style="text-transform:lowercase" class="text"'),y["\\"]=i(a,function(t,n){t.ctrlSeq="\\",t.replaces=function(t){this._replacedFragment=t.disown(),this.isEmpty=function(){return!1}},t.htmlTemplate='<span class="latex-command-input non-leaf">\\<span>&0</span></span>',t.textTemplate=["\\"],t.createBlocks=function(){n.createBlocks.call(this),this.ends[b].focus=function(){return this.parent.jQ.addClass("hasCursor"),this.isEmpty()&&this.parent.jQ.removeClass("empty"),this},this.ends[b].blur=function(){return this.parent.jQ.removeClass("hasCursor"),this.isEmpty()&&this.parent.jQ.addClass("empty"),this}},t.createLeftOf=function(t){if(n.createLeftOf.call(this,t),this.cursor=t.insAtRightEnd(this.ends[b]),this._replacedFragment){var e=this.jQ[0];this.jQ=this._replacedFragment.jQ.addClass("blur").bind("mousedown mousemove",function(t){return x(t.target=e).trigger(t),!1}).insertBefore(this.jQ).add(this.jQ)}this.ends[b].write=function(t,e,n){n&&n.remove(),e.match(/[a-z]/i)?U(e).createLeftOf(t):(this.parent.renderCommand(),"\\"===e&&this.isEmpty()||this.parent.parent.write(t,e))}},t.latex=function(){return"\\"+this.ends[b].latex()+" "},t.onKey=function(t,e){if("Tab"===t||"Enter"===t||"Spacebar"===t)return this.renderCommand(),e.preventDefault(),!1},t.renderCommand=function(){this.jQ=this.jQ.last(),this.remove(),this[w]?this.cursor.insLeftOf(this[w]):this.cursor.insAtRightEnd(this.parent);var t=this.ends[b].latex();t=t||"backslash",this.cursor.insertCmd(t,this._replacedFragment)}}),M=k.binom=k.binomial=i(a,function(t,e){t.ctrlSeq="\\binom",t.htmlTemplate='<span class="paren scaled">(</span><span class="non-leaf"><span class="array non-leaf"><span>&0</span><span>&1</span></span></span><span class="paren scaled">)</span>',t.textTemplate=["choose(",",",")"],t.redraw=function(){var t=this.jQ.eq(1),e=t.outerHeight()/t.css("fontSize").slice(0,-2),n=this.jQ.filter(".paren");Q(n,qt(1+.2*(e-1),1.2),1.05*e)}}),k.choose=i(M,function(t){t.createLeftOf=E.prototype.createLeftOf}),k.vector=i(a,function(t,e){t.ctrlSeq="\\vector",t.htmlTemplate='<span class="array"><span>&0</span></span>',t.latex=function(){return"\\begin{matrix}"+this.foldChildren([],function(t,e){return t.push(e.latex()),t}).join("\\\\")+"\\end{matrix}"},t.text=function(){return"["+this.foldChildren([],function(t,e){return t.push(e.text()),t}).join()+"]"},t.createLeftOf=function(t){e.createLeftOf.call(this,this.cursor=t)},t.onKey=function(t,e){var n,i=this.cursor.parent;if(i.parent===this){if("Enter"===t)return(n=h()).parent=this,n.jQ=x("<span></span>").attr(jt,n.id).insertAfter(i.jQ),i[w]?i[w][b]=n:this.ends[w]=n,n[w]=i[w],(i[w]=n)[b]=i,this.bubble("redraw").cursor.insAtRightEnd(n),e.preventDefault(),!1;if("Tab"===t&&!i[w])return i.isEmpty()?i[b]?(this.cursor.insRightOf(this),delete i[b][w],this.ends[w]=i[b],i.jQ.remove(),this.bubble("redraw"),e.preventDefault(),!1):void 0:((n=h()).parent=this,n.jQ=x("<span></span>").attr(jt,n.id).appendTo(this.jQ),this.ends[w]=n,(i[w]=n)[b]=i,this.bubble("redraw").cursor.insAtRightEnd(n),e.preventDefault(),!1);if(8===e.which){if(i.isEmpty())return i[b]?(this.cursor.insAtRightEnd(i[b]),i[b][w]=i[w]):(this.cursor.insLeftOf(this),this.ends[b]=i[w]),i[w]?i[w][b]=i[b]:this.ends[w]=i[b],i.jQ.remove(),this.isEmpty()?this.cursor.deleteForward():this.bubble("redraw"),e.preventDefault(),!1;if(!this.cursor[b])return e.preventDefault(),!1}}}}),k.editable=i(q,function(t,i){t.init=function(){a.prototype.init.call(this,"\\editable")},t.jQadd=function(){var t,e,n=this;i.jQadd.apply(n,arguments),t=n.ends[b].disown(),e=n.jQ.children().detach(),n.ends[b]=n.ends[w]=l(),n.blocks=[n.ends[b]],Et((n.ends[b].parent=n).jQ,n.ends[b],!1,!0),n.cursor=n.ends[b].cursor,t.children().adopt(n.ends[b],0,0),e.appendTo(n.ends[b].jQ),n.ends[b].cursor.insAtRightEnd(n.ends[b])},t.latex=function(){return this.ends[b].latex()},t.text=function(){return this.ends[b].text()}}),k.f=Qt(c,"f",'<var class="florin">&fnof;</var><span style="display:inline-block;width:0">&nbsp;</span>'),F=i(c,function(t,n){t.init=function(t,e){n.init.call(this,t,"<var>"+(e||t)+"</var>")},t.text=function(){var t=this.ctrlSeq;return!this[b]||this[b]instanceof F||this[b]instanceof K||(t="*"+t),!this[w]||this[w]instanceof K||"^"===this[w].ctrlSeq||(t+="*"),t},t.createLeftOf=function(t){var e,n,i=this.ctrlSeq;for(d=t[b];d&&d instanceof F;)i=d.ctrlSeq+i,d=d[b];if(e=i.match(/(sqrt|root|arcsin|arccos|arctan|sin|cos|tan|sec|csc|cot|log|ln)/)){for(n=0;n<e[0].length-1;n++)t.selectLeft();"root"==e[0]&&(e[0]="nthroot{3}"),e[0].match(/(sqrt|root)/)?t.writeLatex("\\"+e[0]+"{}").parent.blur():t.writeLatex("\\"+e[0]+"\\left(\\right)").parent.blur(),t.moveLeft()}else(e=i.match(/(pi|^oo)$/))?("oo"==e[0]&&(e[0]="infty"),t.selectLeft(),t.writeLatex("\\"+e[0]).parent.blur()):a.prototype.createLeftOf.apply(this,arguments)}}),U=i(c,function(t,n){t.init=function(t,e){n.init.call(this,t,"<span>"+(e||t)+"</span>")}}),y[" "]=Qt(U,"\\:"," "),k.prime=y["'"]=Qt(U,"'","&prime;"),P=i(c,function(t,n){t.init=function(t,e){n.init.call(this,t,'<span class="nonSymbola">'+(e||t)+"</span>")}}),k["@"]=P,k["&"]=Qt(P,"\\&","&amp;"),k["%"]=Qt(P,"\\%","%"),k.alpha=k.beta=k.gamma=k.delta=k.zeta=k.eta=k.theta=k.iota=k.kappa=k.mu=k.nu=k.xi=k.rho=k.sigma=k.tau=k.chi=k.psi=k.omega=i(F,function(t,e){t.init=function(t){e.init.call(this,"\\"+t+" ","&"+t+";")}}),k.phi=Qt(F,"\\phi ","&#981;"),k.phiv=k.varphi=Qt(F,"\\varphi ","&phi;"),k.epsilon=Qt(F,"\\epsilon ","&#1013;"),k.epsiv=k.varepsilon=Qt(F,"\\varepsilon ","&epsilon;"),k.piv=k.varpi=Qt(F,"\\varpi ","&piv;"),k.sigmaf=k.sigmav=k.varsigma=Qt(F,"\\varsigma ","&sigmaf;"),k.thetav=k.vartheta=k.thetasym=Qt(F,"\\vartheta ","&thetasym;"),k.upsilon=k.upsi=Qt(F,"\\upsilon ","&upsilon;"),k.gammad=k.Gammad=k.digamma=Qt(F,"\\digamma ","&#989;"),k.kappav=k.varkappa=Qt(F,"\\varkappa ","&#1008;"),k.rhov=k.varrho=Qt(F,"\\varrho ","&#1009;"),k.pi=k["Ï€"]=Qt(P,"\\pi ","&pi;"),k.lambda=Qt(P,"\\lambda ","&lambda;"),k.Upsilon=k.Upsi=k.upsih=k.Upsih=Qt(c,"\\Upsilon ",'<var style="font-family: serif">&upsih;</var>'),k.Gamma=k.Delta=k.Theta=k.Lambda=k.Xi=k.Pi=k.Sigma=k.Phi=k.Psi=k.Omega=k.forall=i(U,function(t,e){t.init=function(t){e.init.call(this,"\\"+t+" ","&"+t+";")}}),H=i(a,function(t){t.init=function(t){this.latex=t},t.createLeftOf=function(t){t.writeLatex(this.latex)},t.parser=function(){var t=Z.parse(this.latex).children();return p.succeed(t)}}),k["¹"]=Qt(H,"^1"),k["²"]=Qt(H,"^2"),k["³"]=Qt(H,"^3"),k["¼"]=Qt(H,"\\frac14"),k["½"]=Qt(H,"\\frac12"),k["¾"]=Qt(H,"\\frac34"),K=i(c,function(t,i){t.init=function(t,e,n){i.init.call(this,t,'<span class="binary-operator">'+e+"</span>",n)}}),N=i(K,function(t){t.init=U.prototype.init,t.respace=function(){return this[b]?this[b]instanceof K&&this[w]&&!(this[w]instanceof K)?this.jQ[0].className="unary-operator":this.jQ[0].className="binary-operator":this.jQ[0].className="",this}}),k["+"]=Qt(N,"+","+"),k["–"]=k["-"]=Qt(N,"-","&minus;"),k["±"]=k.pm=k.plusmn=k.plusminus=Qt(N,"\\pm ","&plusmn;"),k.mp=k.mnplus=k.minusplus=Qt(N,"\\mp ","&#8723;"),y["*"]=k.sdot=k.cdot=Qt(K,"\\cdot ","&middot;"),k["="]=Qt(K,"=","="),k["<"]=Qt(K,"<","&lt;"),k[">"]=Qt(K,">","&gt;"),k.notin=k.sim=k.cong=k.equiv=k.oplus=k.otimes=i(K,function(t,e){t.init=function(t){e.init.call(this,"\\"+t+" ","&"+t+";")}}),k.times=Qt(K,"\\times ","&times;","[x]"),k["÷"]=k.div=k.divide=k.divides=Qt(K,"\\div ","&divide;","[/]"),k["≠"]=k.ne=k.neq=Qt(K,"\\ne ","&ne;"),k.ast=k.star=k.loast=k.lowast=Qt(K,"\\ast ","&lowast;"),k.therefor=k.therefore=Qt(K,"\\therefore ","&there4;"),k.cuz=k.because=Qt(K,"\\because ","&#8757;"),k.prop=k.propto=Qt(K,"\\propto ","&prop;"),k["≈"]=k.asymp=k.approx=Qt(K,"\\approx ","&asymp;"),k.lt=Qt(K,"<","&lt;"),k.gt=Qt(K,">","&gt;"),k["≤"]=k.le=k.leq=Qt(K,"\\le ","&le;"),k["≥"]=k.ge=k.geq=Qt(K,"\\ge ","&ge;"),k.isin=k.in=Qt(K,"\\in ","&isin;"),k.ni=k.contains=Qt(K,"\\ni ","&ni;"),k.notni=k.niton=k.notcontains=k.doesnotcontain=Qt(K,"\\not\\ni ","&#8716;"),k.sub=k.subset=Qt(K,"\\subset ","&sub;"),k.sup=k.supset=k.superset=Qt(K,"\\supset ","&sup;"),k.nsub=k.notsub=k.nsubset=k.notsubset=Qt(K,"\\not\\subset ","&#8836;"),k.nsup=k.notsup=k.nsupset=k.notsupset=k.nsuperset=k.notsuperset=Qt(K,"\\not\\supset ","&#8837;"),k.sube=k.subeq=k.subsete=k.subseteq=Qt(K,"\\subseteq ","&sube;"),k.supe=k.supeq=k.supsete=k.supseteq=k.supersete=k.superseteq=Qt(K,"\\supseteq ","&supe;"),k.nsube=k.nsubeq=k.notsube=k.notsubeq=k.nsubsete=k.nsubseteq=k.notsubsete=k.notsubseteq=Qt(K,"\\not\\subseteq ","&#8840;"),k.nsupe=k.nsupeq=k.notsupe=k.notsupeq=k.nsupsete=k.nsupseteq=k.notsupsete=k.notsupseteq=k.nsupersete=k.nsuperseteq=k.notsupersete=k.notsuperseteq=Qt(K,"\\not\\supseteq ","&#8841;"),G=i(c,function(t,n){t.init=function(t,e){n.init.call(this,t,"<big>"+e+"</big>")}}),k["∑"]=k.sum=k.summation=Qt(G,"\\sum ","&sum;"),k["∏"]=k.prod=k.product=Qt(G,"\\prod ","&prod;"),k.coprod=k.coproduct=Qt(G,"\\coprod ","&#8720;"),k["∫"]=k.int=k.integral=Qt(G,"\\int ","&int;"),k.N=k.naturals=k.Naturals=Qt(U,"\\mathbb{N}","&#8469;"),k.P=k.primes=k.Primes=k.projective=k.Projective=k.probability=k.Probability=Qt(U,"\\mathbb{P}","&#8473;"),k.Z=k.integers=k.Integers=Qt(U,"\\mathbb{Z}","&#8484;"),k.Q=k.rationals=k.Rationals=Qt(U,"\\mathbb{Q}","&#8474;"),k.R=k.reals=k.Reals=Qt(U,"\\mathbb{R}","&#8477;"),k.C=k.complex=k.Complex=k.complexes=k.Complexes=k.complexplane=k.Complexplane=k.ComplexPlane=Qt(U,"\\mathbb{C}","&#8450;"),k.H=k.Hamiltonian=k.quaternions=k.Quaternions=Qt(U,"\\mathbb{H}","&#8461;"),k.quad=k.emsp=Qt(U,"\\quad ","    "),k.qquad=Qt(U,"\\qquad ","        "),k.diamond=Qt(U,"\\diamond ","&#9671;"),k.bigtriangleup=Qt(U,"\\bigtriangleup ","&#9651;"),k.ominus=Qt(U,"\\ominus ","&#8854;"),k.uplus=Qt(U,"\\uplus ","&#8846;"),k.bigtriangledown=Qt(U,"\\bigtriangledown ","&#9661;"),k.sqcap=Qt(U,"\\sqcap ","&#8851;"),k.triangleleft=Qt(U,"\\triangleleft ","&#8882;"),k.sqcup=Qt(U,"\\sqcup ","&#8852;"),k.triangleright=Qt(U,"\\triangleright ","&#8883;"),k.odot=Qt(U,"\\odot ","&#8857;"),k.bigcirc=Qt(U,"\\bigcirc ","&#9711;"),k.dagger=Qt(U,"\\dagger ","&#0134;"),k.ddagger=Qt(U,"\\ddagger ","&#135;"),k.wr=Qt(U,"\\wr ","&#8768;"),k.amalg=Qt(U,"\\amalg ","&#8720;"),k.models=Qt(U,"\\models ","&#8872;"),k.prec=Qt(U,"\\prec ","&#8826;"),k.succ=Qt(U,"\\succ ","&#8827;"),k.preceq=Qt(U,"\\preceq ","&#8828;"),k.succeq=Qt(U,"\\succeq ","&#8829;"),k.simeq=Qt(U,"\\simeq ","&#8771;"),k.mid=Qt(U,"\\mid ","&#8739;"),k.ll=Qt(U,"\\ll ","&#8810;"),k.gg=Qt(U,"\\gg ","&#8811;"),k.parallel=Qt(U,"\\parallel ","&#8741;"),k.bowtie=Qt(U,"\\bowtie ","&#8904;"),k.sqsubset=Qt(U,"\\sqsubset ","&#8847;"),k.sqsupset=Qt(U,"\\sqsupset ","&#8848;"),k.smile=Qt(U,"\\smile ","&#8995;"),k.sqsubseteq=Qt(U,"\\sqsubseteq ","&#8849;"),k.sqsupseteq=Qt(U,"\\sqsupseteq ","&#8850;"),k.doteq=Qt(U,"\\doteq ","&#8784;"),k.frown=Qt(U,"\\frown ","&#8994;"),k.vdash=Qt(U,"\\vdash ","&#8870;"),k.dashv=Qt(U,"\\dashv ","&#8867;"),k.longleftarrow=Qt(U,"\\longleftarrow ","&#8592;"),k.longrightarrow=Qt(U,"\\longrightarrow ","&#8594;"),k.Longleftarrow=Qt(U,"\\Longleftarrow ","&#8656;"),k.Longrightarrow=Qt(U,"\\Longrightarrow ","&#8658;"),k.longleftrightarrow=Qt(U,"\\longleftrightarrow ","&#8596;"),k.updownarrow=Qt(U,"\\updownarrow ","&#8597;"),k.Longleftrightarrow=Qt(U,"\\Longleftrightarrow ","&#8660;"),k.Updownarrow=Qt(U,"\\Updownarrow ","&#8661;"),k.mapsto=Qt(U,"\\mapsto ","&#8614;"),k.nearrow=Qt(U,"\\nearrow ","&#8599;"),k.hookleftarrow=Qt(U,"\\hookleftarrow ","&#8617;"),k.hookrightarrow=Qt(U,"\\hookrightarrow ","&#8618;"),k.searrow=Qt(U,"\\searrow ","&#8600;"),k.leftharpoonup=Qt(U,"\\leftharpoonup ","&#8636;"),k.rightharpoonup=Qt(U,"\\rightharpoonup ","&#8640;"),k.swarrow=Qt(U,"\\swarrow ","&#8601;"),k.leftharpoondown=Qt(U,"\\leftharpoondown ","&#8637;"),k.rightharpoondown=Qt(U,"\\rightharpoondown ","&#8641;"),k.nwarrow=Qt(U,"\\nwarrow ","&#8598;"),k.ldots=Qt(U,"\\ldots ","&#8230;"),k.cdots=Qt(U,"\\cdots ","&#8943;"),k.vdots=Qt(U,"\\vdots ","&#8942;"),k.ddots=Qt(U,"\\ddots ","&#8944;"),k.surd=Qt(U,"\\surd ","&#8730;"),k.triangle=Qt(U,"\\triangle ","&#9653;"),k.ell=Qt(U,"\\ell ","&#8467;"),k.top=Qt(U,"\\top ","&#8868;"),k.flat=Qt(U,"\\flat ","&#9837;"),k.natural=Qt(U,"\\natural ","&#9838;"),k.sharp=Qt(U,"\\sharp ","&#9839;"),k.wp=Qt(U,"\\wp ","&#8472;"),k.bot=Qt(U,"\\bot ","&#8869;"),k.clubsuit=Qt(U,"\\clubsuit ","&#9827;"),k.diamondsuit=Qt(U,"\\diamondsuit ","&#9826;"),k.heartsuit=Qt(U,"\\heartsuit ","&#9825;"),k.spadesuit=Qt(U,"\\spadesuit ","&#9824;"),k.oint=Qt(U,"\\oint ","&#8750;"),k.bigcap=Qt(U,"\\bigcap ","&#8745;"),k.bigcup=Qt(U,"\\bigcup ","&#8746;"),k.bigsqcup=Qt(U,"\\bigsqcup ","&#8852;"),k.bigvee=Qt(U,"\\bigvee ","&#8744;"),k.bigwedge=Qt(U,"\\bigwedge ","&#8743;"),k.bigodot=Qt(U,"\\bigodot ","&#8857;"),k.bigotimes=Qt(U,"\\bigotimes ","&#8855;"),k.bigoplus=Qt(U,"\\bigoplus ","&#8853;"),k.biguplus=Qt(U,"\\biguplus ","&#8846;"),k.lfloor=Qt(U,"\\lfloor ","&#8970;"),k.rfloor=Qt(U,"\\rfloor ","&#8971;"),k.lceil=Qt(U,"\\lceil ","&#8968;"),k.rceil=Qt(U,"\\rceil ","&#8969;"),k.slash=Qt(U,"\\slash ","&#47;"),k.opencurlybrace=Qt(U,"\\opencurlybrace ","&#123;"),k.closecurlybrace=Qt(U,"\\closecurlybrace ","&#125;"),k.caret=Qt(U,"\\caret ","^"),k.underscore=Qt(U,"\\underscore ","_"),k.backslash=Qt(U,"\\backslash ","\\"),k.vert=Qt(U,"|"),k.perp=k.perpendicular=Qt(U,"\\perp ","&perp;"),k.nabla=k.del=Qt(U,"\\nabla ","&nabla;"),k.hbar=Qt(U,"\\hbar ","&#8463;"),k.AA=k.Angstrom=k.angstrom=Qt(U,"\\text\\AA ","&#8491;"),k.ring=k.circ=k.circle=Qt(U,"\\circ ","&#8728;"),k.bull=k.bullet=Qt(U,"\\bullet ","&bull;"),k.setminus=k.smallsetminus=Qt(U,"\\setminus ","&#8726;"),k.not=k["¬"]=k.neg=Qt(U,"\\neg ","&not;"),k["…"]=k.dots=k.ellip=k.hellip=k.ellipsis=k.hellipsis=Qt(U,"\\dots ","&hellip;"),k.converges=k.darr=k.dnarr=k.dnarrow=k.downarrow=Qt(U,"\\downarrow ","&darr;"),k.dArr=k.dnArr=k.dnArrow=k.Downarrow=Qt(U,"\\Downarrow ","&dArr;"),k.diverges=k.uarr=k.uparrow=Qt(U,"\\uparrow ","&uarr;"),k.uArr=k.Uparrow=Qt(U,"\\Uparrow ","&uArr;"),k.to=Qt(K,"\\to ","&rarr;"),k.rarr=k.rightarrow=Qt(U,"\\rightarrow ","&rarr;"),k.implies=Qt(K,"\\Rightarrow ","&rArr;"),k.rArr=k.Rightarrow=Qt(U,"\\Rightarrow ","&rArr;"),k.gets=Qt(K,"\\gets ","&larr;"),k.larr=k.leftarrow=Qt(U,"\\leftarrow ","&larr;"),k.impliedby=Qt(K,"\\Leftarrow ","&lArr;"),k.lArr=k.Leftarrow=Qt(U,"\\Leftarrow ","&lArr;"),k.harr=k.lrarr=k.leftrightarrow=Qt(U,"\\leftrightarrow ","&harr;"),k.iff=Qt(K,"\\Leftrightarrow ","&hArr;"),k.hArr=k.lrArr=k.Leftrightarrow=Qt(U,"\\Leftrightarrow ","&hArr;"),k.Re=k.Real=k.real=Qt(U,"\\Re ","&real;"),k.Im=k.imag=k.image=k.imagin=k.imaginary=k.Imaginary=Qt(U,"\\Im ","&image;"),k.part=k.partial=Qt(U,"\\partial ","&part;"),k.inf=k.infin=k.infty=k.infinity=Qt(U,"\\infty ","&infin;"),k.alef=k.alefsym=k.aleph=k.alephsym=Qt(U,"\\aleph ","&alefsym;"),k.xist=k.xists=k.exist=k.exists=Qt(U,"\\exists ","&exist;"),k.and=k.land=k.wedge=Qt(U,"\\wedge ","&and;"),k.or=k.lor=k.vee=Qt(U,"\\vee ","&or;"),k.o=k.O=k.empty=k.emptyset=k.oslash=k.Oslash=k.nothing=k.varnothing=Qt(K,"\\varnothing ","&empty;"),k.cup=k.union=Qt(K,"\\cup ","&cup;"),k.cap=k.intersect=k.intersection=Qt(K,"\\cap ","&cap;"),k.deg=k.degree=Qt(U,"^\\circ ","&deg;"),k.ang=k.angle=Qt(U,"\\angle ","&ang;"),X=i(c,function(t,e){t.init=function(t){e.init.call(this,"\\"+t+" ","<span>"+t+"</span>")},t.respace=function(){this.jQ[0].className=this[w]instanceof D||this[w]instanceof T?"":"non-italicized-function"}}),k.ln=k.lg=k.log=k.span=k.proj=k.det=k.dim=k.min=k.max=k.mod=k.lcm=k.gcd=k.gcf=k.hcf=k.lim=X,function(){var t,e=["sin","cos","tan","sec","cosec","csc","cotan","cot"];for(t in e)k[e[t]]=k[e[t]+"h"]=k["a"+e[t]]=k["arc"+e[t]]=k["a"+e[t]+"h"]=k["arc"+e[t]+"h"]=X}(),rt=p.string,st=p.regex,at=p.letter,ot=p.any,ct=p.optWhitespace,ht=p.succeed,lt=p.fail,ut=at.map(F),pt=st(/^[^${}\\_^]/).map(U),ft=st(/^[^\\a-eg-zA-Z]/).or(rt("\\").then(st(/^[a-z]+/i).or(st(/^\s+/).result(" ")).or(ot))).then(function(t){var e=k[t];return e?e(t).parser():lt("unknown command: \\"+t)}).or(ut).or(pt),dt=rt("{").then(function(){return gt}).skip(rt("}")),mt=ct.then(dt.or(ft.map(function(t){var e=h();return t.adopt(e,0,0),e}))),gt=mt.many().map(Rt).skip(ct),bt=rt("[").then(mt.then(function(t){return"]"!==t.join("latex")?ht(t):lt()}).many().map(Rt).skip(ct)).skip(rt("]")),(vt=gt).block=mt,vt.optBlock=bt,Z=vt,Y=i(j,function(t){function e(t,e){var n,i,r,s;if(t[w][e])t.insAtLeftEnd(t[w][e]);else if(t[b][e])t.insAtRightEnd(t[b][e]);else{n=t.parent;do{if((i=n[e])&&("function"==typeof i&&(i=n[e](t)),!1===i||i instanceof h)){t.upDownCache[n.id]=j(t.parent,t[b],t[w]),i instanceof h&&((r=t.upDownCache[i.id])?r[w]?t.insLeftOf(r[w]):t.insAtRightEnd(r.parent):(s=a(t).left,t.insAtRightEnd(i),t.seekHoriz(s,i)));break}n=n.parent.parent}while(n)}return t.clearSelection().show()}function a(t){var e=t.jQ.removeClass("cursor").offset();return t.jQ.addClass("cursor"),e}function o(t){t.upDownCache={}}t.init=function(t){this.parent=this.root=t;var e=this.jQ=this._jQ=x('<span class="cursor">&zwj;</span>');this.blink=function(){e.toggleClass("blink")},this.upDownCache={}},t.show=function(){return this.jQ=this._jQ.removeClass("blink"),"intervalId"in this?clearInterval(this.intervalId):(this[w]?this.selection&&this.selection.ends[b][b]===this[b]?this.jQ.insertBefore(this.selection.jQ):this.jQ.insertBefore(this[w].jQ.first()):this.jQ.appendTo(this.parent.jQ),this.parent.focus()),this.intervalId=setInterval(this.blink,500),this},t.hide=function(){return"intervalId"in this&&clearInterval(this.intervalId),delete this.intervalId,this.jQ.detach(),this.jQ=x(),this},t.withDirInsertAt=function(t,e,n,i){var r=this.parent;this.parent=e,this[t]=n,this[-t]=i,r.blur()},t.insDirOf=function(t,e){return Ot(t),this.withDirInsertAt(t,e.parent,e[t],e),this.parent.jQ.addClass("hasCursor"),this.jQ.insDirOf(t,e.jQ),this},t.insLeftOf=function(t){return this.insDirOf(b,t)},t.insRightOf=function(t){return this.insDirOf(w,t)},t.insAtDirEnd=function(t,e){return Ot(t),this.withDirInsertAt(t,e,0,e.ends[t]),t===b&&e.textarea?this.jQ.insDirOf(-t,e.textarea):this.jQ.insAtDirEnd(t,e.jQ),e.focus(),this},t.insAtLeftEnd=function(t){return this.insAtDirEnd(b,t)},t.insAtRightEnd=function(t){return this.insAtDirEnd(w,t)},t.hopDir=function(t){return Ot(t),this.jQ.insDirOf(t,this[t].jQ),this[-t]=this[t],this[t]=this[t][t],this},t.hopLeft=function(){return this.hopDir(b)},t.hopRight=function(){return this.hopDir(w)},t.moveDirWithin=function(t,e){if(Ot(t),this[t])this[t].ends[-t]?this.insAtDirEnd(-t,this[t].ends[-t]):this.hopDir(t);else{if(this.parent===e)return;this.parent[t]?this.insAtDirEnd(-t,this.parent[t]):this.insDirOf(t,this.parent.parent)}},t.moveLeftWithin=function(t){return this.moveDirWithin(b,t)},t.moveRightWithin=function(t){return this.moveDirWithin(w,t)},t.moveDir=function(t){return Ot(t),o(this),this.selection?this.insDirOf(t,this.selection.ends[t]).clearSelection():this.moveDirWithin(t,this.root),this.show()},t.moveLeft=function(){return this.moveDir(b)},t.moveRight=function(){return this.moveDir(w)},t.moveUp=function(){return e(this,"up")},t.moveDown=function(){return e(this,"down")},t.seek=function(t,e,n){o(this);var i,r,s=this.clearSelection().show();return t.hasClass("empty")?(s.insAtLeftEnd(f[t.attr(jt)]),s):(i=f[t.attr(xt)])instanceof c?(t.outerWidth()>2*(e-t.offset().left)?s.insLeftOf(i):s.insRightOf(i),s):(i||(r=f[t.attr(jt)])||(t=t.parent(),(i=f[t.attr(xt)])||(r=(r=f[t.attr(jt)])||s.root)),i?s.insRightOf(i):s.insAtRightEnd(r),s.seekHoriz(e,s.root))},t.seekHoriz=function(t,e){for(var n,i=this,r=a(i).left-t;i.moveLeftWithin(e),n=r,0<(r=a(i).left-t)&&(i[b]||i.parent!==e););return n<-r&&i.moveRightWithin(e),i},t.writeLatex=function(t){var e,n,i,r=this;return o(r),r.show().deleteSelection(),e=p.all,n=p.eof,(i=Z.skip(n).or(e.result(!1)).parse(t))&&(i.children().adopt(r.parent,r[b],r[w]),f.jQize(i.join("html")).insertBefore(r.jQ),r[b]=i.ends[w],i.finalizeInsert(),r.parent.bubble("redraw")),this.hide()},t.write=function(t){var e=this.prepareWrite();return this.insertCh(t,e)},t.insertCh=function(t,e){return this.parent.write(this,t,e),this},t.insertCmd=function(t,e){var n=k[t];return n?(n=n(t),e&&n.replaces(e),n.createLeftOf(this)):((n=_()).replaces(t),n.ends[b].focus=function(){return delete this.focus,this},n.createLeftOf(this),this.insRightOf(n),e&&e.remove()),this},t.unwrapGramp=function(){var e=this.parent.parent,n=e.parent,i=e[w],r=e[b];if(e.disown().eachChild(function(t){t.isEmpty()||(t.children().adopt(n,r,i).each(function(t){t.jQ.insertBefore(e.jQ.first())}),r=t.ends[w])}),!this[w])if(this[b])this[w]=this[b][w];else for(;!this[w];){if(this.parent=this.parent[w],!this.parent){this[w]=e[w],this.parent=n;break}this[w]=this.parent.ends[b]}this[w]?this.insLeftOf(this[w]):this.insAtRightEnd(n),e.jQ.remove(),e[b]&&e[b].respace(),e[w]&&e[w].respace()},t.deleteDir=function(t){if(Ot(t),o(this),this.show(),!this.deleteSelection())if(this[t])this[t].isEmpty()?this[t]=this[t].remove()[t]:this.selectDir(t);else if(this.parent!==this.root){if(this.parent.parent.isEmpty())return this.insDirOf(-t,this.parent.parent).deleteDir(t);this.unwrapGramp()}return this[b]&&this[b].respace(),this[w]&&this[w].respace(),this.parent.bubble("redraw"),this},t.backspace=function(){return this.deleteDir(b)},t.deleteForward=function(){return this.deleteDir(w)},t.selectFrom=function(t){var e,n,i,r,s,a,o=this,c=t;t:for(;;){for(e=this;e!==o.parent.parent;e=e.parent.parent)if(e.parent===c.parent){i=e,r=c;break t}for(n=t;n!==c.parent.parent;n=n.parent.parent)if(o.parent===n.parent){i=o,r=n;break t}o.parent.parent&&(o=o.parent.parent),c.parent.parent&&(c=c.parent.parent)}if(i[w]!==r){for(a=i;a;a=a[w])if(a===r[b]){s=!0;break}s||(s=r,r=i,i=s)}this.hide().selection=J(i[b][w]||i.parent.ends[b],r[w][b]||r.parent.ends[w]),this.insRightOf(r[w][b]||r.parent.ends[w]),this.root.selectionChanged()},t.selectDir=function(t){if(Ot(t),o(this),this.selection)if(this.selection.ends[t]===this[-t])this[t]?this.hopDir(t).selection.extendDir(t):this.parent!==this.root&&this.insDirOf(t,this.parent.parent).selection.levelUp();else{if(this.hopDir(t),this.selection.ends[t]===this.selection.ends[-t])return void this.clearSelection().show();this.selection.retractDir(t)}else{if(this[t])this.hopDir(t);else{if(this.parent===this.root)return;this.insDirOf(t,this.parent.parent)}this.hide().selection=J(this[-t])}this.root.selectionChanged()},t.selectLeft=function(){return this.selectDir(b)},t.selectRight=function(){return this.selectDir(w)},t.prepareMove=function(){return o(this),this.show().clearSelection()},t.prepareEdit=function(){return o(this),this.show().deleteSelection()},t.prepareWrite=function(){return o(this),this.show().replaceSelection()},t.clearSelection=function(){return this.selection&&(this.selection.clear(),delete this.selection,this.root.selectionChanged()),this},t.deleteSelection=function(){return!!this.selection&&(this[b]=this.selection.ends[b][b],this[w]=this.selection.ends[w][w],this.selection.remove(),this.root.selectionChanged(),delete this.selection)},t.replaceSelection=function(){var t=this.selection;return t&&(this[b]=t.ends[b][b],this[w]=t.ends[w][w],delete this.selection),t}}),J=i(o,function(t,e){t.init=function(){e.init.apply(this,arguments),this.jQwrap(this.jQ)},t.jQwrap=function(t){this.jQ=t.wrapAll('<span class="selection"></span>').parent()},t.adopt=function(){return this.jQ.replaceWith(this.jQ=this.jQ.children()),e.adopt.apply(this,arguments)},t.clear=function(){return this.jQ.replaceWith(this.jQ.children()),this},t.levelUp=function(){var t=this,e=t.ends[b]=t.ends[w]=t.ends[w].parent.parent;return t.clear().jQwrap(e.jQ),t},t.extendDir=function(t){return Ot(t),this.ends[t]=this.ends[t][t],this.ends[t].jQ.insAtDirEnd(t,this.jQ),this},t.extendLeft=function(){return this.extendDir(b)},t.extendRight=function(){return this.extendDir(w)},t.retractDir=function(t){Ot(t),this.ends[-t].jQ.insDirOf(-t,this.jQ),this.ends[-t]=this.ends[-t][t]},t.retractRight=function(){return this.retractDir(w)},t.retractLeft=function(){return this.retractDir(b)}}),wt.fn.mathquill=function(t,s){var e,n,i,r,a;switch(t){case"redraw":return this.each(function(){var t=x(this).attr(jt),e=t&&f[t];e&&!function t(e){e.eachChild(t),e.redraw&&e.redraw()}(e)});case"revert":return this.each(function(){var t=x(this).attr(jt),e=t&&f[t];e&&e.revert&&e.revert()});case"latex":return 1<arguments.length?this.each(function(){var t=x(this).attr(jt),e=t&&f[t];e&&e.renderLatex(s)}):(n=(e=x(this).attr(jt))&&f[e])&&n.latex();case"text":return(n=(e=x(this).attr(jt))&&f[e])&&n.text();case"html":return this.html().replace(/ ?hasCursor|hasCursor /,"").replace(/ class=(""|(?= |>))/g,"").replace(/<span class="?cursor( blink)?"?><\/span>/i,"").replace(/<span class="?textarea"?><textarea><\/textarea><\/span>/i,"");case"write":if(1<arguments.length)return this.each(function(){var t=x(this).attr(jt),e=t&&f[t],n=e&&e.cursor;n&&n.writeLatex(s).parent.blur()});case"cmd":if(1<arguments.length)return this.each(function(){var t,e=x(this).attr(jt),n=e&&f[e],i=n&&n.cursor;i&&(t=i.prepareWrite(),/^\\[a-z]+$/i.test(s)?i.insertCmd(s.slice(1),t):i.insertCh(s,t),i.hide().parent.blur())});case"writesimpfunc":if(1<arguments.length)return this.each(function(){var t=x(this).attr(jt),e=t&&f[t],n=e&&e.cursor;n&&(n.selection?n.writeLatex(s+"{"+n.selection.latex()+"}").parent.blur():n.writeLatex(s+"{}").parent.blur(),n.moveLeft())});case"writefunc":if(1<arguments.length)return this.each(function(){var t=x(this).attr(jt),e=t&&f[t],n=e&&e.cursor;n&&(n.selection?n.writeLatex(s+"\\left("+n.selection.latex()+"\\right)").parent.blur():n.writeLatex(s+"\\left(\\right)").parent.blur(),n.moveLeft())});case"movecursor":if(1<arguments.length)return this.each(function(){var t=x(this).attr(jt),e=t&&f[t],n=e&&e.cursor;n&&("b"==s?n.backspace():(n.clearSelection().show(),"l"==s?n.moveLeft():"r"==s?n.moveRight():"u"==s?n.moveUp():"d"==s&&n.moveDown()))});case"writefrac":if(1<arguments.length)return this.each(function(){var t=x(this).attr(jt),e=t&&f[t],n=e&&e.cursor;n&&(n.selection?n.writeLatex("\\frac{"+n.selection.latex()+"}{}").parent.blur():(n.writeLatex("\\frac{}{}").parent.blur(),n.moveLeft()),n.moveLeft())});case"writeint":if(1<arguments.length)return this.each(function(){var t,e,n=x(this).attr(jt),i=n&&f[n],r=i&&i.cursor;e="["==s?(t="\\left[","\\right]"):"("==s?(t="\\left(","\\right)"):(t=s+"{","}"),r&&(r.selection?r.selection.latex().match(/,/)?r.writeLatex(t+r.selection.latex()+e).parent.blur():r.writeLatex(t+r.selection.latex()+","+e).parent.blur():(r.writeLatex(t+","+e).parent.blur(),r.moveLeft()),r.moveLeft())});case"writebracket":if(1<arguments.length)return this.each(function(){var t,e,n=x(this).attr(jt),i=n&&f[n],r=i&&i.cursor;"["==s?(t="\\left[",e="\\right]"):"("==s?(t="\\left(",e="\\right)"):"|"==s&&(t="\\left|",e="\\right|"),r&&(r.selection?r.writeLatex(t+r.selection.latex()+e).parent.blur():r.writeLatex(t+e).parent.blur(),r.moveLeft())});default:return r=(i="textbox"===t)||"editable"===t,a=i?u:l,this.each(function(){Et(x(this),a(),i,r)})}},wt(function(){wt(".mathquill-editable:not(.mathquill-rendered-math)").mathquill("editable"),wt(".mathquill-textbox:not(.mathquill-rendered-math)").mathquill("textbox"),wt(".mathquill-embedded-latex").mathquill()})}();
var mqarea,mqmousebase,mqeeddclosetimer,cureedd,lasteepos,eebasiccurel,eebasicinit,eebasicselstore,eebasicclosetimer,ddbasicclosetimer,cureebasicdd,eebasictype;function mqPrepTabs(i,o){$(".tab_content").hide(),$("ul.tabs li").removeClass("active").each(function(e,t){var s;0==e?($(t).addClass("active").show(),s=$(t).find("a").attr("href"),$(s).show()):1==e?$(t).hide():2==e?"int"==o?$(t).show():$(t).hide():3==e?"ineq"==o?$(t).show():$(t).hide():1==i?$(t).show():$(t).hide()})}function mqeemousemove(e){return $("#mqee").css("left",e.pageX-mqmousebase.left+lasteepos.left).css("top",e.pageY-mqmousebase.top+lasteepos.top),e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),!1}function mqeetouchmove(e){var t=e.originalEvent.changedTouches[0]||e.originalEvent.touches[0];return $("#mqee").css("left",t.pageX-mqmousebase.left+lasteepos.left).css("top",t.pageY-mqmousebase.top+lasteepos.top),e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),!1}function mqeeinsert(e){var t,s;return e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),t=$(this).attr("btntext"),s=$(this).attr("btntype"),t=t.replace("\\\\","\\"),0==s?mqarea.mathquill("cmd",t).find("input,textarea").focus():1==s?mqarea.mathquill("write",t).find("input,textarea").focus():2==s?mqarea.mathquill("writesimpfunc",t).find("input,textarea").focus():3==s?mqarea.mathquill("writefunc",t).find("input,textarea").focus():4==s?mqarea.mathquill("writeint",t).find("input,textarea").focus():5==s?mqarea.mathquill("movecursor",t).find("input,textarea").focus():6==s?mqarea.mathquill("writebracket",t).find("input,textarea").focus():7==s&&mqarea.mathquill("writefrac",t).find("input,textarea").focus(),!1}function showeedd(e,t,s){var i,o,l;mqeeddclosetimer&&(window.clearTimeout(mqeeddclosetimer),mqeeddclosetimer=null),hideee(),cureedd={id:e,type:t,extras:s},i=$("#mqeedd"),(l=(o=$("#"+e)).offset()).left+=o.outerWidth(),i.css("left",l.left+"px").css("top",l.top+"px").height(o.outerHeight()-2).show()}function updateeeddpos(){var e,t,s;cureedd&&(e=$("#mqeedd"),(s=(t=$("#"+cureedd.id)).offset()).left+=t.outerWidth(),e.css("left",s.left+"px").css("top",s.top+"px").height(t.outerHeight()-2).show())}function hideeedd(){mqeeddclosetimer=setTimeout(function(){$("#mqeedd").hide()},250)}function mqeetoggleactive(e){for(var t=1;t<=5;t++)e==t?($("#mqeetab"+t).addClass("mqeeactive").removeClass("mqeehighlight"),document.getElementById("mqee"+t).style.display=""):(document.getElementById("mqee"+t).style.display="none",$("#mqeetab"+t).removeClass("mqeeactive"));mqeeactivetab=e,mqarea.find("input,textarea").focus()}function showee(){var e,t;mqPrepTabs(cureedd.type-3,cureedd.extras),e=$("#mqee"),lasteepos?(t=$(window).scrollTop()-lasteepos.scroll,lasteepos.top=lasteepos.top+t,lasteepos.scroll=$(window).scrollTop()):lasteepos={left:($(window).width()-e.outerWidth())/2,top:$(window).scrollTop()+((window.innerHeight?window.innerHeight:$(window).height())-e.outerHeight())/2,scroll:$(window).scrollTop()},e.css("left",lasteepos.left).css("top",lasteepos.top).show(),mqarea.mathquill("latex",AMtoMQ($("#"+cureedd.id).val())),mqarea.find("input,textarea").focus()}function hideee(){$("#mqee").hide()}function savemathquill(){var e,t=MQtoAM(mqarea.mathquill("latex"));$("#"+cureedd.id).val(t),""!=t&&$("#"+cureedd.id).siblings("input[value=spec]").prop("checked",!0),(e=$("#pbtn"+cureedd.id.substr(2)))&&e.trigger("click"),hideee()}function eebasicinsert(e){var t,s,i;el=document.getElementById(eebasiccurel),el.setSelectionRange?t=el.selectionEnd-el.selectionStart:document.selection&&document.selection.createRange&&(el.focus(),t=(s=eebasicselstore).text.length),posshift=0,"("==e?(insb="(",insa=")",posshift=1):"sym"==e.substr(0,3)&&(insb="",insa=e.substr(3)),el.setSelectionRange?(i=el.selectionEnd+insa.length+insb.length,el.value=el.value.substring(0,el.selectionStart)+insb+el.value.substring(el.selectionStart,el.selectionEnd)+insa+el.value.substring(el.selectionEnd,el.value.length),el.focus(),0==t&&0<posshift&&(i-=posshift),el.setSelectionRange(i,i)):document.selection&&document.selection.createRange&&(s.text=insb+s.text+insa,0==t&&0<posshift&&s.move("character",-1*posshift),s.select()),eebasicselstore=null}function showeebasicselstore(e){null==eebasicselstore&&document.selection&&document.selection.createRange&&(document.getElementById(e).focus(),eebasicselstore=document.selection.createRange())}function showeebasic(e){var t,s,i,o;if(el=document.getElementById(e),el.setSelectionRange?(el.selectionEnd,el.selectionStart):document.selection&&document.selection.createRange&&(t=eebasicselstore).text.length,s=document.getElementById("eebasic"),0==eebasicinit){for(els=s.getElementsByTagName("td"),i=0;i<els.length;i++)els[i].onmouseover=eebasiccellhighlight,els[i].onmouseout=eebasiccellunhighlight,els[i].onmousedown=eebasiccellhighlightdown,els[i].onmouseup=eebasiccellhighlight;eebasicinit=!0}1==eebasictype?(document.getElementById("eenumber").style.display="none",document.getElementById("eeinterval").style.display=""):(document.getElementById("eenumber").style.display="",document.getElementById("eeinterval").style.display="none"),e!=eebasiccurel?(eebasiccurel=e,o=jQuery(el).offset(),s.style.top=o.top+el.offsetHeight+"px",s.style.display="block",s.offsetWidth<el.offsetWidth?s.style.left=o.left+el.offsetWidth+10-s.offsetWidth+"px":s.style.left=o.left+"px"):(s.style.display="none",eebasiccurel=null),unhideebasice(0),el.setSelectionRange?el.focus():document.selection&&document.selection.createRange&&t.select()}function unhideebasice(e){eebasiccancelclosetimer()}function hideebasice(e){null!=eebasiccurel&&(eebasicclosetimer=window.setTimeout(reallyhideebasice,250))}function hideebasicedd(){ddbasicclosetimer=window.setTimeout(function(){cureebasicdd=null,document.getElementById("eebasicdd").style.display="none"},250)}function reallyhideebasice(){document.getElementById("eebasic").style.display="none",eebasiccurel=null}function eebasiccancelclosetimer(){eebasicclosetimer&&(window.clearTimeout(eebasicclosetimer),eebasicclosetimer=null)}function eebasiccellhighlight(){this.style.background="#ccf"}function eebasiccellunhighlight(){this.style.background="#fff"}function eebasiccellhighlightdown(){this.style.background="#99f",null==eebasicselstore&&document.selection&&document.selection.createRange&&(document.getElementById(eebasiccurel).focus(),eebasicselstore=document.selection.createRange())}function showeebasicdd(e,t){var s,i,o;eebasictype=t,ddbasicclosetimer&&(window.clearTimeout(ddbasicclosetimer),ddbasicclosetimer=null),s=document.getElementById("eebasicdd"),i=document.getElementById(e),o=jQuery(i).offset(),s.style.left=o.left+i.offsetWidth+"px",s.style.top=o.top+"px",s.style.height=i.offsetHeight-2+"px",s.style.lineHeight=i.offsetHeight+"px",s.style.width="10px",s.style.display="block",cureebasicdd=e}$(function(){$(window).load(function(){document.documentElement;mqarea=$(".mathquill-editable"),$(".mathquill-rendered-math").mathquill("redraw"),mqarea.find("input,textarea").focus(),$("input,textarea").attr("autocapitalize","off"),$("#mqee td.mqeebtn").bind("mouseover mouseup",function(){$(this).hasClass("mqeeactive")||$(this).addClass("mqeehighlight")}).bind("mousedown",function(){$(this).addClass("mqeeclick")}).bind("mouseout",function(){$(this).removeClass("mqeehighlight"),$(this).removeClass("mqeeclick")}).bind("mouseup",function(){$(this).removeClass("mqeeclick")}).bind("click",mqeeinsert),$("#mqeeclosebutton").bind("click",hideee),$("#mqeetopbar").mousedown(function(e){e.preventDefault&&e.preventDefault(),$("body").addClass("unselectable"),mqmousebase={left:e.pageX,top:e.pageY},$("body").bind("mousemove",mqeemousemove),$("body").mouseup(function(e){var t=$("#mqee").offset();lasteepos.left=t.left,lasteepos.top=t.top,$("body").unbind("mousemove",mqeemousemove),$("body").removeClass("unselectable"),$(this).unbind(e)})}),$("#mqee td.mqeebtn").bind("touchstart",function(e){e.preventDefault&&e.preventDefault(),$(this).addClass("mqeeclick")}).bind("touchend",function(e){e.preventDefault&&e.preventDefault(),$(this).delay(500).removeClass("mqeeclick")}).bind("touchend",mqeeinsert),$("#mqeeclosebutton").bind("touchend",function(e){e.preventDefault&&e.preventDefault(),hideee()}),$("#mqeetopbar").bind("touchstart",function(e){e.preventDefault&&e.preventDefault();var t=e.originalEvent.changedTouches[0]||e.originalEvent.touches[0];mqmousebase={left:t.pageX,top:t.pageY},$("body").addClass("unselectable"),$("body").bind("touchmove",mqeetouchmove),$("body").bind("touchend",function(e){var t=$("#mqee").offset();lasteepos.left=t.left,lasteepos.top=t.top,$("body").unbind("touchmove",mqeetouchmove),$("body").removeClass("unselectable"),$(this).unbind(e)})})}),$(document).ready(function(){$(".tab_content").hide(),$("ul.tabs li").click(function(){$("ul.tabs li").removeClass("active"),$(this).addClass("active"),$(".tab_content").hide();var e=$(this).find("a").attr("href");return $(e).show(),!1})})}),eebasicinit=!1,cureebasicdd=eebasicselstore=eebasiccurel=lasteepos=cureedd=mqeeddclosetimer=null,eebasictype=ddbasicclosetimer=eebasicclosetimer=0;
var AMtoMQ=function(){var r,v,c,g,s=".",x=0,m=1,y=2,$=3,h=4,q=5,f=6,b=7,A=8,_=9,d=10,t={input:"sqrt",tag:"msqrt",output:"sqrt",tex:null,ttype:m},u={input:"root",tag:"mroot",output:"root",tex:null,ttype:y},e={input:"frac",tag:"mfrac",output:"/",tex:null,ttype:y},p={input:"/",tag:"mfrac",output:"/",tex:null,ttype:$},n={input:"stackrel",tag:"mover",output:"stackrel",tex:null,ttype:y},l={input:"_",tag:"msub",output:"_",tex:null,ttype:$},a={input:"^",tag:"msup",output:"^",tex:null,ttype:$},o={input:"text",tag:"mtext",output:"text",tex:null,ttype:d},i={input:"mbox",tag:"mtext",output:"mbox",tex:null,ttype:d},O={input:'"',tag:"mtext",output:"mbox",tex:null,ttype:d},w=[{input:"alpha",tag:"mi",output:"α",tex:null,ttype:x},{input:"beta",tag:"mi",output:"β",tex:null,ttype:x},{input:"chi",tag:"mi",output:"χ",tex:null,ttype:x},{input:"delta",tag:"mi",output:"δ",tex:null,ttype:x},{input:"Delta",tag:"mo",output:"Δ",tex:null,ttype:x},{input:"epsi",tag:"mi",output:"ε",tex:"epsilon",ttype:x},{input:"varepsilon",tag:"mi",output:"ɛ",tex:null,ttype:x},{input:"eta",tag:"mi",output:"η",tex:null,ttype:x},{input:"gamma",tag:"mi",output:"γ",tex:null,ttype:x},{input:"Gamma",tag:"mo",output:"Γ",tex:null,ttype:x},{input:"iota",tag:"mi",output:"ι",tex:null,ttype:x},{input:"kappa",tag:"mi",output:"κ",tex:null,ttype:x},{input:"lambda",tag:"mi",output:"λ",tex:null,ttype:x},{input:"Lambda",tag:"mo",output:"Λ",tex:null,ttype:x},{input:"mu",tag:"mi",output:"μ",tex:null,ttype:x},{input:"nu",tag:"mi",output:"ν",tex:null,ttype:x},{input:"omega",tag:"mi",output:"ω",tex:null,ttype:x},{input:"Omega",tag:"mo",output:"Ω",tex:null,ttype:x},{input:"phi",tag:"mi",output:"φ",tex:null,ttype:x},{input:"varphi",tag:"mi",output:"ϕ",tex:null,ttype:x},{input:"Phi",tag:"mo",output:"Φ",tex:null,ttype:x},{input:"pi",tag:"mi",output:"π",tex:null,ttype:x},{input:"Pi",tag:"mo",output:"Π",tex:null,ttype:x},{input:"psi",tag:"mi",output:"ψ",tex:null,ttype:x},{input:"Psi",tag:"mi",output:"Ψ",tex:null,ttype:x},{input:"rho",tag:"mi",output:"ρ",tex:null,ttype:x},{input:"sigma",tag:"mi",output:"σ",tex:null,ttype:x},{input:"Sigma",tag:"mo",output:"Σ",tex:null,ttype:x},{input:"tau",tag:"mi",output:"τ",tex:null,ttype:x},{input:"theta",tag:"mi",output:"θ",tex:null,ttype:x},{input:"vartheta",tag:"mi",output:"ϑ",tex:null,ttype:x},{input:"Theta",tag:"mo",output:"Θ",tex:null,ttype:x},{input:"upsilon",tag:"mi",output:"υ",tex:null,ttype:x},{input:"xi",tag:"mi",output:"ξ",tex:null,ttype:x},{input:"Xi",tag:"mo",output:"Ξ",tex:null,ttype:x},{input:"zeta",tag:"mi",output:"ζ",tex:null,ttype:x},{input:"*",tag:"mo",output:"⋅",tex:"cdot",ttype:x},{input:"xx",tag:"mo",output:"×",tex:"times",ttype:x},{input:"-:",tag:"mo",output:"÷",tex:"div",ttype:x},{input:"sum",tag:"mo",output:"∑",tex:null,ttype:b},{input:"nn",tag:"mo",output:"∩",tex:"cap",ttype:x},{input:"uu",tag:"mo",output:"∪",tex:"cup",ttype:x},{input:"U",tag:"mo",output:"∪",tex:"cup",ttype:x},{input:"!=",tag:"mo",output:"≠",tex:"ne",ttype:x},{input:"lt",tag:"mo",output:"<",tex:null,ttype:x},{input:"gt",tag:"mo",output:">",tex:null,ttype:x},{input:"<=",tag:"mo",output:"≤",tex:"le",ttype:x},{input:"lt=",tag:"mo",output:"≤",tex:"leq",ttype:x},{input:"gt=",tag:"mo",output:"≥",tex:"geq",ttype:x},{input:">=",tag:"mo",output:"≥",tex:"ge",ttype:x},{input:"geq",tag:"mo",output:"≥",tex:null,ttype:x},{input:"in",tag:"mo",output:"∈",tex:null,ttype:x},{input:"sub",tag:"mo",output:"⊂",tex:"subset",ttype:x},{input:"sube",tag:"mo",output:"⊆",tex:"subseteq",ttype:x},{input:"(",tag:"mo",output:"(",tex:null,ttype:h},{input:")",tag:"mo",output:")",tex:null,ttype:q},{input:"[",tag:"mo",output:"[",tex:null,ttype:h},{input:"]",tag:"mo",output:"]",tex:null,ttype:q},{input:"{",tag:"mo",output:"{",tex:"{",ttype:h,notexcopy:!0},{input:"}",tag:"mo",output:"}",tex:"}",ttype:q,notexcopy:!0},{input:"|",tag:"mo",output:"|",tex:null,ttype:_},{input:"(:",tag:"mo",output:"〈",tex:"langle",ttype:h},{input:":)",tag:"mo",output:"〉",tex:"rangle",ttype:q},{input:"<<",tag:"mo",output:"〈",tex:"langle",ttype:h},{input:">>",tag:"mo",output:"〉",tex:"rangle",ttype:q},{input:"int",tag:"mo",output:"∫",tex:null,ttype:x},{input:"+-",tag:"mo",output:"±",tex:"pm",ttype:x},{input:"O/",tag:"mo",output:"∅",tex:"emptyset",ttype:x},{input:"oo",tag:"mo",output:"∞",tex:"infty",ttype:x},{input:"rarr",tag:"mo",output:"→",tex:"rightarrow",ttype:x},{input:"->",tag:"mo",output:"→",tex:"to",ttype:x},{input:"RR",tag:"mo",output:"ℝ",tex:"mathbb{R}",ttype:x,notexcopy:!0},{input:"f",tag:"mi",output:"f",tex:null,ttype:m,func:!0,val:!0},{input:"sin",tag:"mo",output:"sin",tex:null,ttype:m,func:!0},{input:"cos",tag:"mo",output:"cos",tex:null,ttype:m,func:!0},{input:"tan",tag:"mo",output:"tan",tex:null,ttype:m,func:!0},{input:"arcsin",tag:"mo",output:"arcsin",tex:null,ttype:m,func:!0},{input:"arccos",tag:"mo",output:"arccos",tex:null,ttype:m,func:!0},{input:"arctan",tag:"mo",output:"arctan",tex:null,ttype:m,func:!0},{input:"sinh",tag:"mo",output:"sinh",tex:null,ttype:m,func:!0},{input:"cosh",tag:"mo",output:"cosh",tex:null,ttype:m,func:!0},{input:"tanh",tag:"mo",output:"tanh",tex:null,ttype:m,func:!0},{input:"cot",tag:"mo",output:"cot",tex:null,ttype:m,func:!0},{input:"coth",tag:"mo",output:"coth",tex:null,ttype:m,func:!0},{input:"sech",tag:"mo",output:"sech",tex:null,ttype:m,func:!0},{input:"csch",tag:"mo",output:"csch",tex:null,ttype:m,func:!0},{input:"sec",tag:"mo",output:"sec",tex:null,ttype:m,func:!0},{input:"csc",tag:"mo",output:"csc",tex:null,ttype:m,func:!0},{input:"log",tag:"mo",output:"log",tex:null,ttype:m,func:!0},{input:"ln",tag:"mo",output:"ln",tex:null,ttype:m,func:!0},{input:"abs",tag:"mo",output:"abs",tex:null,ttype:m},{input:"Sin",tag:"mo",output:"sin",tex:null,ttype:m,func:!0},{input:"Cos",tag:"mo",output:"cos",tex:null,ttype:m,func:!0},{input:"Tan",tag:"mo",output:"tan",tex:null,ttype:m,func:!0},{input:"Arcsin",tag:"mo",output:"arcsin",tex:null,ttype:m,func:!0},{input:"Arccos",tag:"mo",output:"arccos",tex:null,ttype:m,func:!0},{input:"Arctan",tag:"mo",output:"arctan",tex:null,ttype:m,func:!0},{input:"Sinh",tag:"mo",output:"sinh",tex:null,ttype:m,func:!0},{input:"Sosh",tag:"mo",output:"cosh",tex:null,ttype:m,func:!0},{input:"Tanh",tag:"mo",output:"tanh",tex:null,ttype:m,func:!0},{input:"Cot",tag:"mo",output:"cot",tex:null,ttype:m,func:!0},{input:"Sec",tag:"mo",output:"sec",tex:null,ttype:m,func:!0},{input:"Csc",tag:"mo",output:"csc",tex:null,ttype:m,func:!0},{input:"Log",tag:"mo",output:"log",tex:null,ttype:m,func:!0},{input:"Ln",tag:"mo",output:"ln",tex:null,ttype:m,func:!0},{input:"Abs",tag:"mo",output:"abs",tex:null,ttype:m,func:!0},t,u,e,p,n,l,a,{input:"Sqrt",tag:"msqrt",output:"sqrt",tex:null,ttype:m},{input:"hat",tag:"mover",output:"^",tex:null,ttype:m,acc:!0},{input:"bar",tag:"mover",output:"¯",tex:"overline",ttype:m,acc:!0},{input:"vec",tag:"mover",output:"→",tex:null,ttype:m,acc:!0},o,i,O];function R(t,u){return t.input>u.input?1:-1}function S(t,u){var e,p;for(e="\\"==t.charAt(u)&&"\\"!=t.charAt(u+1)&&" "!=t.charAt(u+1)?t.slice(u+1):t.slice(u),p=0;p<e.length&&e.charCodeAt(p)<=32;p+=1);return e.slice(p)}function z(t,u,e){var p,n,l;if(0==e){for(e=-1,p=t.length;e+1<p;)t[n=e+p>>1]<u?e=n:p=n;return p}for(l=e;l<t.length&&t[l]<u;l++);return l}function D(t){var u,e,p,n,l,a=0,o="",i=!0;for(n=1;n<=t.length&&i;n++)e=t.slice(0,n),(a=z(r,e,a))<r.length&&t.slice(0,r[a].length)==r[a]&&(n=(o=r[u=a]).length),i=a<r.length&&t.slice(0,r[a].length)>=r[a];if(c=g,""!=o)return g=w[u].ttype,w[u];for(g=x,a=1,e=t.slice(0,1),l=!0;"0"<=e&&e<="9"&&a<=t.length;)e=t.slice(a,a+1),a++;if(e==s&&"0"<=(e=t.slice(a,a+1))&&e<="9")for(l=!1,a++;"0"<=e&&e<="9"&&a<=t.length;)e=t.slice(a,a+1),a++;return p=l&&1<a||2<a?(e=t.slice(0,a-1),"mn"):(a=2,((e=t.slice(0,1))<"A"||"Z"<e)&&(e<"a"||"z"<e)?"mo":"mi"),"-"==e&&c==$?(g=$,{input:e,tag:p,output:e,ttype:m,func:!0,val:!0}):{input:e,tag:p,output:e,ttype:x,val:!0}}function E(t){var u,e;return"{"==t.charAt(0)&&"}"==t.charAt(t.length-1)&&(e=0,"\\left"==(u=t.substr(1,5))?"("==(u=t.charAt(6))||"["==u||"{"==u?e=7:"\\lbrace"==(u=t.substr(6,7))&&(e=13):"("!=(u=t.charAt(1))&&"["!=u||(e=2),0<e&&("\\right)}"==(u=t.substr(t.length-8))||"\\right]}"==u||"\\right.}"==u?t=(t="{"+t.substr(e)).substr(0,t.length-8)+"}":"\\rbrace}"==u&&(t=(t="{"+t.substr(e)).substr(0,t.length-14)+"}"))),t}function N(t){return pre="boolean"==typeof t.val&&t.val?"":"\\",null==t.tex?pre+t.input:pre+t.tex}function Z(t){return null==t.tex?t.input:"\\"+t.tex}function C(t){var u,e,p,n,l,a,o,i="";if(null==(u=D(t=S(t,0)))||u.ttype==q&&0<v)return[null,t];switch(u.ttype==A&&(u=D(t=u.output+S(t,u.input.length))),u.ttype){case b:case x:return t=S(t,u.input.length),"\\"==(l=N(u)).charAt(0)||"mo"==u.tag?[l,t]:["{"+l+"}",t];case h:return(v++,e=k(t=S(t,u.input.length),!0),v--,e[0].match(/bmatrix/))?[e[0].substring(0,e[0].length-7),e[1]]:("\\right"==e[a=0].substr(0,6)&&(")"==(n=e[0].charAt(6))||"]"==n||"}"==n?a=6:"."==n?a=7:"\\rbrace"==(n=e[0].substr(6,7))&&(a=13)),[0<a?(e[0]=e[0].substr(a),"boolean"==typeof u.invisible&&u.invisible?"{"+e[0]+"}":"{"+Z(u)+e[0]+"}"):"boolean"==typeof u.invisible&&u.invisible?"{\\left."+e[0]+"}":"{\\left"+Z(u)+e[0]+"}",e[1]]);case d:return u!=O&&(t=S(t,u.input.length)),-1==(p="{"==t.charAt(0)?t.indexOf("}"):"("==t.charAt(0)?t.indexOf(")"):"["==t.charAt(0)?t.indexOf("]"):u==O?t.slice(1).indexOf('"')+1:0)&&(p=t.length),[i+="\\text{"+(n=t.slice(1,p))+"}",t=S(t,p+1)];case m:return null==(e=C(t=S(t,u.input.length)))[0]?["{"+N(u)+"}",t]:"boolean"==typeof u.func&&u.func?"^"==(n=t.charAt(0))||"_"==n||"/"==n||"|"==n||","==n||1==u.input.length&&u.input.match(/\w/)&&"("!=n?["{"+N(u)+"}",t]:["{"+N(u)+"{"+e[0]+"}}",e[1]]:(e[0]=E(e[0]),"sqrt"==u.input?["\\sqrt{"+e[0]+"}",e[1]]:"abs"==u.input?["\\left|{"+e[0]+"}\\right|",e[1]]:"cancel"==u.input?["\\cancel{"+e[0]+"}",e[1]]:void 0!==u.rewriteleftright?["{\\left"+u.rewriteleftright[0]+e[0]+"\\right"+u.rewriteleftright[1]+"}",e[1]]:"boolean"==typeof u.acc&&u.acc?[N(u)+"{"+e[0]+"}",e[1]]:["{"+N(u)+"{"+e[0]+"}}",e[1]]);case y:return null==(e=C(t=S(t,u.input.length)))[0]?["{"+N(u)+"}",t]:(e[0]=E(e[0]),null==(o=C(e[1]))[0]?["{"+N(u)+"}",t]:(o[0]=E(o[0]),[i="color"==u.input?"{\\color{"+e[0].replace(/[\{\}]/g,"")+"}"+o[0]+"}":"root"==u.input?"{\\sqrt["+e[0]+"]{"+o[0]+"}}":"{"+N(u)+"{"+e[0]+"}{"+o[0]+"}}",o[1]]));case $:return t=S(t,u.input.length),[u.output,t];case f:return t=S(t,u.input.length),["{\\quad\\text{"+u.input+"}\\quad}",t];case _:return v++,e=k(t=S(t,u.input.length),!1),v--,n="","|"==(n=e[0].charAt(e[0].length-1))?["{\\left|"+e[0]+"}",e[1]]:["{\\mid}",t];default:return t=S(t,u.input.length),["{"+N(u)+"}",t]}}function M(t){var u,e,p,n,l,a;return e=D(t=S(t,0)),n=(l=C(t))[0],(u=D(t=l[1])).ttype==$&&"/"!=u.input&&(null==(l=C(t=S(t,u.input.length)))[0]?l[0]="{}":l[0]=E(l[0]),t=l[1],"_"==u.input?"^"==(p=D(t)).input?((a=C(t=S(t,p.input.length)))[0]=E(a[0]),t=a[1],n="{"+n,n+="_{"+l[0]+"}",n+="^{"+a[0]+"}",n+="}"):n+="_{"+l[0]+"}":n=n+"^{"+l[0]+"}",void 0!==e.func&&e.func&&(p=D(t)).ttype!=$&&p.ttype!=q&&(n="{"+n+(l=M(t))[0]+"}",t=l[1])),[n,t]}function k(t,u){for(var e,p,n,l,a,o,i,r,c,g,s,x,m,y,h,f,b,A="",d=!1;p=(n=M(t=S(t,0)))[0],(e=D(t=n[1])).ttype==$&&"/"==e.input?(null==(n=M(t=S(t,e.input.length)))[0]?n[0]="{}":n[0]=E(n[0]),t=n[1],p="\\frac{"+(p=E(p))+"}",A+=p+="{"+n[0]+"}",e=D(t)):null!=p&&(A+=p),(e.ttype!=q&&(e.ttype!=_||u)||0==v)&&null!=e&&""!=e.output;);if(e.ttype==q||e.ttype==_){if(2<(a=A.length)&&"{"==A.charAt(0)&&0<A.indexOf(",")&&(")"==(o=A.charAt(a-2))||"]"==o)&&("("==(i=A.charAt(6))&&")"==o&&"}"!=e.output||"["==i&&"]"==o)){for(r="\\begin{bmatrix}",(c=new Array).push(0),g=!0,(x=[])[s=0]=[0],y=m=0,l=1;l<a-1;l++)A.charAt(l)==i&&s++,A.charAt(l)==o&&0==--s&&","==A.charAt(l+2)&&"{"==A.charAt(l+3)&&(c.push(l+2),x[m=l+2]=[l+2]),"["!=A.charAt(l)&&"("!=A.charAt(l)&&"{"!=A.charAt(l)||y++,"]"!=A.charAt(l)&&")"!=A.charAt(l)&&"}"!=A.charAt(l)||y--,","==A.charAt(l)&&1==y&&x[m].push(l);if(c.push(a),h=-1,0==s&&0<c.length)for(l=0;l<c.length-1;l++){if(0<l&&(r+="\\\\"),0==l)if(1==x[c[l]].length)f=[A.substr(c[l]+7,c[l+1]-c[l]-15)];else{for(f=[A.substring(c[l]+7,x[c[l]][1])],b=2;b<x[c[l]].length;b++)f.push(A.substring(x[c[l]][b-1]+1,x[c[l]][b]));f.push(A.substring(x[c[l]][x[c[l]].length-1]+1,c[l+1]-8))}else if(1==x[c[l]].length)f=[A.substr(c[l]+8,c[l+1]-c[l]-16)];else{for(f=[A.substring(c[l]+8,x[c[l]][1])],b=2;b<x[c[l]].length;b++)f.push(A.substring(x[c[l]][b-1]+1,x[c[l]][b]));f.push(A.substring(x[c[l]][x[c[l]].length-1]+1,c[l+1]-8))}0<h&&f.length!=h?g=!1:-1==h&&(h=f.length),r+=f.join("&")}r+="\\end{bmatrix}",g&&(A=r)}t=S(t,e.input.length),d=("boolean"==typeof e.invisible&&e.invisible?A+="\\right.":A+=p="\\right"+Z(e),!0)}return 0<v&&!d&&(A+="\\right."),[A,t]}return r=[],function(){var t,u=[];for(t=0;t<w.length;t++)!w[t].tex||"boolean"==typeof w[t].notexcopy&&w[t].notexcopy||(u[u.length]={input:w[t].tex,tag:w[t].tag,output:w[t].output,ttype:w[t].ttype,acc:w[t].acc||!1});for((w=w.concat(u)).sort(R),t=0;t<w.length;t++)r[t]=w[t].input}(),function(t){return v=0,null==(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/(&nbsp;|\u00a0|&#160;)/g,"")).replace(/^\s*<([^<].*?[^>])>\s*$/,"<<$1>>")).replace(/&gt;/g,">")).replace(/&lt;/g,"<")).replace(/\s*\bor\b\s*/g,'" or "')).replace(/all\s+real\s+numbers/g,'"all real numbers"')).replace(/(\)|\])\s*u\s*(\(|\[)/g,"$1U$2")).replace(/\bDNE\b/gi,'"DNE"')).match(/\S/)?"":k(t.replace(/^\s+/g,""),!1)[0]}}();function MQtoAM(t,u){var e,p,n,l,a,o;if(t=t.replace(/\\:/g," "),u)t=t.replace(/\\Re/g,"RR");else{for(;-1!=(o=t.lastIndexOf("\\left|"));)t=-1!=(p=t.indexOf("\\right|",o+1))?(n=t.substring(0,o).match(/(arcsinh|arccosh|arctanh|arcsech|arccsch|arccoth|arcsin|arccos|arctan|arcsec|arccsc|arccot|sinh|cosh|tanh|sech|csch|coth|ln|log|exp|sin|cos|tan|sec|csc|cot)(\^\d+)?$/),(t=t.substring(0,p)+")"+(n?")":"")+t.substring(p+7)).substring(0,o)+(n?"(":"")+"abs("+t.substring(o+6)):t.substring(0,o)+"|"+t.substring(o+6);t=(t=(t=(t=(t=t.replace(/\\text{\s*or\s*}/g," or ")).replace(/\\text{all\s+real\s+numbers}/g,"all real numbers")).replace(/\\text{DNE}/g,"DNE")).replace(/\\varnothing/g,"DNE")).replace(/\\Re/g,"all real numbers")}for(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/\\begin{.?matrix}(.*?)\\end{.?matrix}/g,function(t,u){return"[("+u.replace(/\\\\/g,"),(").replace(/&/g,",")+")]"})).replace(/\\le(?!f)/g,"<=")).replace(/\\ge/g,">=")).replace(/\\pm/g,"+-")).replace(/\\approx/g,"~~")).replace(/(\\arrow|\\rightarrow)/g,"rarr")).replace(/\\cup/g,"U")).replace(/\\left\\{/g,"lbrace").replace(/\\right\\}/g,"rbrace")).replace(/\\left/g,"")).replace(/\\right/g,"")).replace(/\\langle/g,"<<")).replace(/\\rangle/g,">>")).replace(/\\cdot/g,"*")).replace(/\\infty/g,"oo")).replace(/\\nthroot/g,"root")).replace(/\\/g,"")).replace(/sqrt\[(.*?)\]/g,"root($1)")).replace(/(\d)frac/g,"$1 frac");-1!=(o=t.indexOf("frac{"));){for(e=1,l=o+5;0<e&&l<t.length-1;)l++,"{"==(a=t.charAt(l))?e++:"}"==a&&e--;t=0==e?t.substring(0,o)+"("+t.substring(o+5,l)+")/"+t.substring(l+1):t.substring(0,o)+t.substring(o+4)}return t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/_(\d)(\d)/g,"_$1 $2")).replace(/\^(\d)(\d)/g,"^$1 $2")).replace(/_{([\d\.]+)}\^/g,"_$1^")).replace(/_{([\d\.]+)}([^\^])/g,"_$1 $2")).replace(/_{([\d\.]+)}$/g,"_$1")).replace(/{/g,"(").replace(/}/g,")")).replace(/lbrace/g,"{").replace(/rbrace/g,"}")).replace(/\(([\d\.]+)\)\/\(([\d\.]+)\)/g,"$1/$2")).replace(/\/\(([\d\.]+)\)/g,"/$1")).replace(/\(([\d\.]+)\)\//g,"$1/")).replace(/\/\(([\a-zA-Z])\)/g,"/$1")).replace(/\(([\a-zA-Z])\)\//g,"$1/")).replace(/\^\(-1\)/g,"^-1")).replace(/\^\((-?[\d\.]+)\)/g,"^$1")).replace(/\/\(([\a-zA-Z])\^([\d\.]+)\)/g,"/$1^$2")).replace(/\(([\a-zA-Z])\^([\d\.]+)\)\//g,"$1^$2/")).replace(/\+\-/g,"+ -")}
