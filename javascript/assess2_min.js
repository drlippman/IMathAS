var canvases,drawla,imathasDraw,canvases=new Array,drawla=new Array,imathasDraw=function($){var mouseisdown,targets,imgs,targetOuts,lines,dots,odots,tplines,tptypes,ineqlines,ineqtypes,curLine,drawstyle,drawlocky,curTPcurve,curIneqcurve,ineqcolors,ineqacolors,asymcolor,dragObj,oldpointpos,curTarget,curCursor,nocanvaswarning,hasTouch,didMultiTouch,clickmightbenewcurve,hasTouchTimer,tpModeN,tpHasAsymp,clickcnt,lastdrawmouseup,mouseintarget,normslider,drawexport;function reset(){clearAllDrawListners(),targets.length=0,imgs.length=0,targetOuts.length=0,lines.length=0,dots.length=0,odots.length=0,tplines.length=0,tptypes.length=0,ineqlines.length=0,ineqtypes.length=0,drawstyle.length=0,drawlocky.length=0,curIneqcurve=curTPcurve=dragObj=curLine=curTarget=null}function clearcanvas(e,t){targetOuts[e]&&targetOuts[e].disabled&&!t||lines.hasOwnProperty(e)&&(lines[e].length=0,dots[e].length=0,odots[e].length=0,tplines[e].length=0,tptypes[e].length=0,ineqlines[e].length=0,ineqtypes[e].length=0,"canvas"==targets[curTarget=e].type&&drawTarget(),dragObj=curLine=curTarget=null)}function clearlastline(e){0<lines[e].length&&(lines[e].length=lines[e].length-1),curTarget=e,drawTarget(),dragObj=curLine=curTarget=null}function addA11yTarget(e,t,r){var n,a,i,s,u,g,l,o,c,d,T,p,h,m,y,w,f,v,b=e[0],q=e[13].split(","),x=!0;for("noprev"==q[q.length-1]&&(x=!1,q.pop()),n=e[2],a=e[3],(i=e[4])==(s=e[5])&&(i=-1,s=1),u=e[6],g=e[7],e=e[8],null==(l=document.getElementById("a11ydraw"+b))&&(c=document.getElementById("canvas"+b))&&!x&&(o=$("<div>").append($("<p>",{text:_("Drawn Elements:")})),(l=document.createElement("ul")).setAttribute("id","allydraw"+b),o.append(l),$(c).replaceWith(o)),targetOuts[b]=document.getElementById("qn"+b),c=!!document.getElementById("a11ydrawnew"+b),targetOuts[b].disabled&&(c&&(document.getElementById("a11ydrawnew"+b).disabled=!0),$(".a11ydrawadd[data-qn="+b+"]").prop("disabled",!0)),targets[b]={type:"a11y",el:l,vispreview:x,xmin:n,xmax:a,ymin:i,ymax:s,imgborder:u,imgwidth:g,imgheight:e},x&&(targets[b].canv=document.getElementById("canvas"+b)),targets[b].pixperx=(g-2*u)/(a-n),targets[b].pixpery=i==s?1:(e-2*u)/(s-i),"inequality"==q[0]?(d=q.shift(),0==q.length?q=["line"]:"both"==q[0]&&(q=["line","parab"])):"twopoint"==q[0]?(d=q.shift(),0==q.length&&(q=["line","parab","abs","circle","dot"])):"numberline"==q[0]?(d="basic",q.shift()):d="basic",targets[b].afgroup=d,T={inequality:{line:[{mode:10,descr:_("Linear inequality with solid line"),inN:3,input:_("Enter 2 points on the line, then a third point in the shaded region")},{mode:10.2,descr:_("Linear inequality with dashed line"),inN:3,input:_("Enter 2 points on the line, then a third point in the shaded region")}],parab:[{mode:10.3,descr:_("Parabolic inequality with solid line"),inN:3,input:_("Enter the vertex, then another point on the parabola, then a third point in the shaded region")},{mode:10.4,descr:_("Parabolic inequality with dashed line"),inN:3,input:_("Enter the vertex, then another point on the parabola, then a third point in the shaded region")}],abs:[{mode:10.5,descr:_("Absolute value inequality with solid line"),inN:3,input:_("Enter the corner point of the absolute value, then another point on the graph, then a third point in the shaded region")},{mode:10.6,descr:_("Absolute value inequality with dashed line"),inN:3,input:_("Enter the corner point of the absolute value, then another point on the graph, then a third point in the shaded region")}]},twopoint:{line:[{mode:5,descr:_("Line"),inN:2,input:_("Enter two points on the line")}],lineseg:[{mode:5.3,descr:_("Line segment"),inN:2,input:_("Enter the starting and ending point of the line segment")}],ray:[{mode:5.2,descr:_("Ray"),inN:2,input:_("Enter the starting point of the ray and another point on the ray")}],parab:[{mode:6,descr:_("Parabola"),inN:2,input:_("Enter the vertex, then another point on the parabola")}],horizparab:[{mode:6.1,descr:_("Parabola opening right or left"),inN:2,input:_("Enter the vertex, then another point on the parabola")}],halfparab:[{mode:6.2,descr:_("Half Parabola"),inN:2,input:_("Enter the vertex, then another point on the half parabola")}],cubic:[{mode:6.3,descr:_("Cubic"),inN:2,input:_("Enter the inflection point, then another point on the cubic")}],sqrt:[{mode:6.5,descr:_("Square root"),inN:2,input:_("Enter the starting point of the square root, then another point on the graph")}],cuberoot:[{mode:6.6,descr:_("Cube root"),inN:2,input:_("Enter the inflection point of the cube root, then another point on the graph")}],abs:[{mode:8,descr:_("Absolute value"),inN:2,input:_("Enter the corner point of the absolute value, then another point on the graph")}],rational:[{mode:8.2,descr:_("Rational"),inN:2,input:_("Enter the point where the vertical and horizontal asymptote cross, then a point on the graph")}],exp:[{mode:8.3,descr:_("Exponential"),inN:2,input:_("Enter two points on the graph")}],log:[{mode:8.4,descr:_("Logarithm"),inN:2,input:_("Enter two points on the graph")}],genexp:[{mode:8.5,descr:_("Shifted Exponential"),inN:3,input:_("Enter a point on the asymptote, then enter two points on the graph")}],genlog:[{mode:8.6,descr:_("Shifted Logarithm"),inN:3,input:_("Enter a point on the asymptote, then enter two points on the graph")}],circle:[{mode:7,descr:_("Circle"),inN:2,input:_("Enter the center point of the circle, then a point on the graph")}],ellipse:[{mode:7.2,descr:_("Ellipse"),inN:2,input:_("Enter the center point of the ellipse, then a point offset from the center by the horizontal radius and vertical radius")}],hyperbola:[{mode:7.4,descr:_("Vertical hyperbola"),inN:2,input:_("Enter the center point of the hyperbola, then a point (x,y) where x is the x-coordinate of the co-vertex and y is the y-coordinate of the vertex")},{mode:7.5,descr:_("Horizontal hyperbola"),inN:2,input:_("Enter the center point of the hyperbola, then a point (x,y) where x is the x-coordinate of the vertex and y is the y-coordinate of the co-vertex")}],dot:[{mode:1,descr:_("Solid dot"),inN:1,input:_("Enter the coordinates of the dot")}],opendot:[{mode:2,descr:_("Open dot"),inN:1,input:_("Enter the coordinates of the dot")}],trig:[{mode:9,descr:_("Cosine"),inN:2,input:_("Enter a point at the start of a phase, then a point half a phase further")},{mode:9.1,descr:_("Sine"),inN:2,input:_("Enter a point at the start of a phase, then a point a quarter phase further")}],vector:[{mode:5.4,descr:_("Vector"),inN:2,input:_("Enter the starting and ending point of the vector")}]},basic:{line:[{mode:0,descr:_("Lines"),inN:"list",input:_("Enter a list of points to connect with lines")}],lineseg:[{mode:.5,descr:_("Line segment"),inN:2,input:_("Enter the starting and ending point of the line segment")}],freehand:[{mode:.7,descr:_("Freehand"),inN:"list",input:_("Enter a list of points to connect with lines")}],dot:[{mode:1,descr:_("Solid dot"),inN:1,input:_("Enter the coordinates of the dot")}],opendot:[{mode:2,descr:_("Open dot"),inN:1,input:_("Enter the coordinates of the dot")}],polygon:[{mode:0,descr:_("Polygon"),inN:"list",input:_("Enter a list of points for dots to connect with lines"),dotline:1}],closedpolygon:[{mode:0,descr:_("Polygon"),inN:"list",input:_("Enter a list of points for dots to connect with lines"),dotline:2}]}},null==lines[b]&&(lines[b]=new Array),null==dots[b]&&(dots[b]=new Array),null==odots[b]&&(odots[b]=new Array),null==tplines[b]&&(tplines[b]=new Array),null==tptypes[b]&&(tptypes[b]=new Array),null==ineqlines[b]&&(ineqlines[b]=new Array),null==ineqtypes[b]&&(ineqtypes[b]=new Array),h=[],m=[],y=[],f=0;f<q.length;f++)if(T[d].hasOwnProperty(q[f]))for(0==f&&(p=T[d][q[f]][0].mode),v=0;v<T[d][q[f]].length;v++)y[T[d][q[f]][v].mode]=T[d][q[f]][v],h.push(T[d][q[f]][v].mode),w='<option value="'+T[d][q[f]][v].mode+'"',w+=' data-af="'+q[f]+'">'+T[d][q[f]][v].descr+"</option>",m.push(w);if(c&&(document.getElementById("a11ydrawnew"+b).innerHTML=m),targets[b].defmode=p,targets[b].inputmodes=h,targets[b].selects=m,targets[b].moderef=y,c||!x)if(null==t&&lines.hasOwnProperty(b)){for(f=0;f<lines[b].length;f++)adda11ydraw(b,0,pixcoordstopointlist(lines[b][f],b));for(f=0;f<dots[b].length;f++)adda11ydraw(b,1,pixcoordstopointlist(dots[b][f],b));for(f=0;f<odots[b].length;f++)adda11ydraw(b,2,pixcoordstopointlist(odots[b][f],b));for(f=0;f<tplines[b].length;f++)adda11ydraw(b,tptypes[b][f],pixcoordstopointlist(tplines[b][f][0],b)+","+pixcoordstopointlist(tplines[b][f][1],b));for(f=0;f<ineqlines[b].length;f++)adda11ydraw(b,ineqtypes[b][f],pixcoordstopointlist(ineqlines[b][f][0],b)+","+pixcoordstopointlist(ineqlines[b][f][1],b)+","+pixcoordstopointlist(ineqlines[b][f][2],b))}else if(null!=t)for(f=0;f<t.length;f++)adda11ydraw(b,t[f][0],t[f][1].replace(/\[/g,"(").replace(/\]/g,")"));x&&initBackground(targets[b].canv,b,r,g,e,!0)}function adda11ydraw(e,t,r){var n=targets[e],t=t||document.getElementById("a11ydrawnew"+e).value,a=r||"",i=(n.afgroup,n.el.getElementsByTagName("li").length+1),e=targetOuts[e].disabled?" disabled ":"",i='<span class="sr-only draweln">'+_("Drawing element ")+i+"</span>";html=(html=(html=(html=(html=i)+n.moderef[t].descr+'.<br/><label><span class="a11ydrawinstr"></span><br/>')+'<input type="text" value="'+a+'" data-n="'+n.moderef[t].inN+'" '+e)+'onblur="imathasDraw.updatea11ydraw(this)"/></label><button type="button" class="imgbutton" onclick="imathasDraw.removea11ydraw(this)"'+e+">")+_("Remove")+" "+i+"</button>",a=$("<li>",{class:"a11ydrawrow","data-mode":t}).html(html),$(n.el).append(a),a.find(".a11ydrawinstr").text(n.moderef[t].input),r||a.find("input").focus()}function removea11ydraw(e){setariastatus(_("Removed drawing element"));var t=$(e).closest("ul");$(e).parent().remove(),t.find("li").each(function(e,t){e=_("Drawing element ")+(e+1);$(t).find(".draweln").html(e)}),t.prev().focus(),encodea11ydraw(t.attr("id").substring(8))}function changea11ydraw(e,t){var r=$(e).val(),t=targets[t].moderef[r];$(e).closest("li").find(".a11ydrawinstr").text(t.input),encodea11ydraw()}function updatea11ydraw(e){var t,r,n,a,i,s=0,u=e.value.trim();for("("==u.charAt(0)&&")"==u.slice(-1)||(s|=1),t=u.slice(1,-1).split(/\)\s*,\s*\(/),(u=e.getAttribute("data-n")).match(/\d/)&&t.length!=parseInt(u)&&(s|=2),r=0;r<t.length;r++)for(2!=(n=t[r].split(/,/)).length&&(s|=1),a=0;a<n.length;a++)0==n[a].trim().length&&(s|=1);"noticetext"==e.parentNode.parentNode.lastChild.className&&e.parentNode.parentNode.removeChild(e.parentNode.parentNode.lastChild),s?(e.setAttribute("aria-invalid",!0),(i=document.createElement("span")).id=uniqid("a11ydrawerr"),i.className="noticetext",1==(1&s)?(i.innerHTML="<br>"+_("Error: Invalid format for points. Give points as open parenthesis number comma number close parenthesis. Separate points with a comma."),setariastatus(_("Error: Invalid format for points"))):(i.innerHTML="<br>"+_("Error: Incorrect number of points. Expecting ")+u,setariastatus(_("Error: Incorrect number of points"))),e.parentNode.parentNode.appendChild(i),e.setAttribute("aria-describedby",i.id)):(e.removeAttribute("aria-invalid"),e.removeAttribute("aria-describedby"),setariastatus("")),encodea11ydraw(parseInt($(e).closest(".a11ydraw").attr("id").substring(8)))}function pixcoordstopointlist(e,t){var t=targets[t],r=(e[0]-t.imgborder)/t.pixperx+t.xmin,e=(t.imgheight-e[1]-t.imgborder)/t.pixpery+t.ymin;return"("+Math.round(100*r)/100+","+Math.round(100*e)/100+")"}function encodea11ydraw(qn){var oldCurTarget,tarnum,thistarg,enclines,encdots,encodots,enctplines,enctpineq,saveinput,afgroup;for(tarnum in void 0===qn&&(qn=-1),oldCurTarget=curTarget,targets)-1<qn&&qn!=tarnum||(thistarg=targets[tarnum],"a11y"==thistarg.type&&(-1<qn&&qn==tarnum&&(curTarget=tarnum),lines[tarnum].length=0,dots[tarnum].length=0,odots[tarnum].length=0,tplines[tarnum].length=0,tptypes[tarnum].length=0,ineqlines[tarnum].length=0,ineqtypes[tarnum].length=0,enclines=[],encdots=[],encodots=[],enctplines=[],enctpineq=[],saveinput=[],afgroup=targets[tarnum].afgroup,$("#a11ydraw"+tarnum).find(".a11ydrawrow").each(function(i,el){var input,mode,expectedn,outpts,outptsraw,input=$(el).find("input").val(),mode=el.getAttribute("data-mode"),expectedn=$(el).find("input").attr("data-n");for(saveinput.push("["+mode+',"'+input+'"]'),input=input.replace(/[\(\)]/g,"").split(/\s*,\s*/),outpts=[],outptsraw=[],i=1;i<input.length;i+=2){try{input[i-1]=eval(prepWithMath(mathjs(input[i-1])))}catch(e){input[i-1]=NaN}try{input[i]=eval(prepWithMath(mathjs(input[i])))}catch(e){input[i]=NaN}input[i-1]=(input[i-1]-thistarg.xmin)*thistarg.pixperx+thistarg.imgborder,input[i]=thistarg.imgheight-(input[i]-thistarg.ymin)*thistarg.pixpery-thistarg.imgborder,outpts.push(Math.round(input[i-1])+","+Math.round(input[i])),outptsraw.push([input[i-1],input[i]])}"list"!==expectedn&&expectedn!=outpts.length||(1==mode?(encdots.push("("+outpts.join("),(")+")"),dots[tarnum].push(outptsraw)):2==mode?(encodots.push("("+outpts.join("),(")+")"),odots[tarnum].push(outptsraw)):mode<1?(enclines.push("("+outpts.join("),(")+")"),lines[tarnum].push(outptsraw)):5<=mode&&mode<10?(enctplines.push("("+mode+","+outpts.join(",")+")"),tplines[tarnum].push(outptsraw),tptypes[tarnum].push(mode)):10<=mode&&(enctpineq.push("("+mode+","+outpts.join(",")+")"),ineqlines[tarnum].push(outptsraw),ineqtypes[tarnum].push(mode)))}),targetOuts[tarnum].value=enclines.join(";")+";;"+encdots.join(",")+";;"+encodots.join(",")+";;"+enctplines.join(",")+";;"+enctpineq.join(",")+";;"+saveinput.join(","),$(targetOuts[tarnum]).trigger("input").trigger("change")));-1<qn&&targets[qn].vispreview&&drawTarget(null,null,!0),curTarget=oldCurTarget}function addTarget(e,t,r,n,a,i,s,u,g,l,o,c,d,T,p){var h=document.getElementById(t);$(h).is(":hidden")&&$(h).on("mouseover.imathasdrawwait touchstart.imathasdrawwait",function(){$(h).off("mouseover.imathasdrawwait touchstart.imathasdrawwait"),initCanvases(e)}),h.style.userSelect="none",h.style.webkitUserSelect="none",h.style.MozUserSelect="none",t=getPosition(h),targets[e]={type:"canvas",el:h,left:t.x,top:t.y,width:h.offsetWidth,height:h.offsetHeight,xmin:a,xmax:i,ymin:s,ymax:u,imgborder:g,imgwidth:l,imgheight:o,mode:c,dotline:d},"string"==typeof p&&-1!=p.indexOf(":")?(p=p.split(":"),targets[e].snaptogridx=+p[0],targets[e].snaptogridy=+p[1]):(targets[e].snaptogridx=+p,targets[e].snaptogridy=+p),targets[e].pixperx=(l-2*g)/(i-a),targets[e].pixpery=s==u?1:(o-2*g)/(u-s),targetOuts[e]=document.getElementById(n),null==lines[e]&&(lines[e]=new Array),null==dots[e]&&(dots[e]=new Array),null==odots[e]&&(odots[e]=new Array),null==tplines[e]&&(tplines[e]=new Array),null==tptypes[e]&&(tptypes[e]=new Array),null==ineqlines[e]&&(ineqlines[e]=new Array),null==ineqtypes[e]&&(ineqtypes[e]=new Array),drawstyle[e]=5<=c?1:0,drawlocky[e]=T,initBackground(h,e,r,l,o,!1)}function initBackground(e,t,r,n,a,i){var s;r.match(/initPicture/)?(0==$(e).closest(".drawcanvasholder").length&&($(e).removeClass("drawcanvas").wrap($("<div>",{class:"drawcanvas",style:"position:relative;width:"+n+"px;height:"+a+"px"})).wrap($("<div>",{class:"drawcanvasholder",style:"position:absolute;top:0;left:0;z-index:2"})),$(e).closest(".drawcanvas").prepend($("<div>",{class:"canvasbg",style:"position:absolute;top:0;left:0"}).append($("<embed>",{"data-nomag":1,type:"image/svg+xml",align:"middle",width:n,height:a,script:r}).attr("width",n).attr("height",a)))),imgs[t]=null,s=curTarget,curTarget=t,drawTarget(null,null,i),setTimeout(function(){window.drawPics($(e).closest(".drawcanvas")[0])},30),curTarget=s):""!==r?(imgs[t]=new Image,imgs[t].onload=function(){var e=curTarget;curTarget=t,drawTarget(null,null,i),curTarget=e},imgs[t].src=r):(imgs[t]=null,s=curTarget,curTarget=t,drawTarget(null,null,i),curTarget=s)}function settool(e,t,r){for(var n=document.getElementById("drawtools"+t),a=n.getElementsByTagName("span"),i=0;i<a.length;i++)a[i].className="";for(a=n.getElementsByTagName("img"),i=0;i<a.length;i++)a[i].className="";e.className="sel",setDrawMode(t,r),curTarget=t,drawTarget()}function setDrawMode(e,t){targets[e].mode=t}function setDotLine(e,t){targets[e].dotline=t}function drawTarget(e,t,C){var r,n,A,a,i,s,u,g,D,l,o,c,d,T,p,h,m,y,w,f,v,S,b,q,W,x,M,O,L,j,P,H,R,z,E,U,F,Y,I,X,V,G,J,Q,K,_,N,k,B,$;try{r=(targets[curTarget].canv||targets[curTarget].el).getContext("2d")}catch(e){nocanvaswarning||(nocanvaswarning=!0,alert("Your browser does not support drawing answer entry.  Please try again using Internet Explorer 6+ (Windows), FireFox 1.5+ (Win/Mac), Safari 1.3+ (Mac), Opera 9+ (Win/Mac), or Camino (Mac)"))}for(r.fillStyle="rgb(0,0,255)",r.lineWidth=2,r.strokeStyle="rgb(0,0,255)",r.clearRect(0,0,targets[curTarget].imgwidth,targets[curTarget].imgheight),null!==imgs[curTarget]&&r.drawImage(imgs[curTarget],0,0),r.beginPath(),n=0;n<ineqlines[curTarget].length;n++){if(r.strokeStyle=ineqcolors[A=n%3],r.fillStyle=ineqcolors[A],g=u=s=i=a=null,3==ineqlines[curTarget][n].length?(i=ineqlines[curTarget][n][1][0],u=ineqlines[curTarget][n][1][1],s=ineqlines[curTarget][n][2][0],g=ineqlines[curTarget][n][2][1]):2==ineqlines[curTarget][n].length?(i=ineqlines[curTarget][n][1][0],u=ineqlines[curTarget][n][1][1],s=e,g=t):curIneqcurve==n&&null!=e&&1==ineqlines[curTarget][n].length&&(i=e,u=t),null!=s&&(r.save(),r.fillStyle=ineqacolors[A],r.beginPath(),ineqtypes[curTarget][n]<=10.2?(i!=ineqlines[curTarget][n][0][0]&&(a=(u-ineqlines[curTarget][n][0][1])/(i-ineqlines[curTarget][n][0][0])),Math.abs(i-ineqlines[curTarget][n][0][0])<1||100<Math.abs(a)?(r.moveTo(ineqlines[curTarget][n][0][0],0),r.lineTo(ineqlines[curTarget][n][0][0],targets[curTarget].imgheight),i<s?(r.lineTo(targets[curTarget].imgwidth,targets[curTarget].imgheight),r.lineTo(targets[curTarget].imgwidth,0)):(r.lineTo(0,targets[curTarget].imgheight),r.lineTo(0,0))):(D=a*(s-i)+u,l=ineqlines[curTarget][n][0][1]-a*ineqlines[curTarget][n][0][0],o=ineqlines[curTarget][n][0][1]+a*(targets[curTarget].imgwidth-ineqlines[curTarget][n][0][0]),r.moveTo(0,l),r.lineTo(targets[curTarget].imgwidth,o),D<g?(r.lineTo(targets[curTarget].imgwidth,targets[curTarget].imgheight),r.lineTo(0,targets[curTarget].imgheight)):(r.lineTo(targets[curTarget].imgwidth,0),r.lineTo(0,0))),r.closePath()):ineqtypes[curTarget][n]<=10.4?shadeParabola(r,ineqlines[curTarget][n][0][0],ineqlines[curTarget][n][0][1],i,u,s,g,targets[curTarget].imgwidth,targets[curTarget].imgheight):1<Math.abs(i-ineqlines[curTarget][n][0][0])&&(a=(u-ineqlines[curTarget][n][0][1])/(i-ineqlines[curTarget][n][0][0]),i<ineqlines[curTarget][n][0][0]&&(a*=-1),D=a*Math.abs(s-ineqlines[curTarget][n][0][0])+ineqlines[curTarget][n][0][1],l=ineqlines[curTarget][n][0][1]+a*ineqlines[curTarget][n][0][0],o=ineqlines[curTarget][n][0][1]+a*(targets[curTarget].imgwidth-ineqlines[curTarget][n][0][0]),D<g?(r.moveTo(targets[curTarget].imgwidth,targets[curTarget].imgheight),r.lineTo(0,targets[curTarget].imgheight)):(r.moveTo(targets[curTarget].imgwidth,0),r.lineTo(0,0)),r.lineTo(0,l),r.lineTo(ineqlines[curTarget][n][0][0],ineqlines[curTarget][n][0][1]),r.lineTo(targets[curTarget].imgwidth,o)),r.fill(),r.restore()),r.beginPath(),null!=i&&(ineqtypes[curTarget][n]<=10.2?(i!=ineqlines[curTarget][n][0][0]&&(a=(u-ineqlines[curTarget][n][0][1])/(i-ineqlines[curTarget][n][0][0])),Math.abs(i-ineqlines[curTarget][n][0][0])<1||100<Math.abs(a)?10.2==ineqtypes[curTarget][n]?null!=dragObj&&10<=dragObj.mode&&dragObj.mode<11&&dragObj.num==n&&0==dragObj.subnum?(r.dashedLine(ineqlines[curTarget][n][1][0],ineqlines[curTarget][n][1][1],ineqlines[curTarget][n][1][0],targets[curTarget].imgheight),r.dashedLine(ineqlines[curTarget][n][1][0],ineqlines[curTarget][n][1][1],ineqlines[curTarget][n][1][0],0)):(r.dashedLine(ineqlines[curTarget][n][0][0],ineqlines[curTarget][n][0][1],ineqlines[curTarget][n][0][0],targets[curTarget].imgheight),r.dashedLine(ineqlines[curTarget][n][0][0],ineqlines[curTarget][n][0][1],ineqlines[curTarget][n][0][0],0)):(r.moveTo(ineqlines[curTarget][n][0][0],0),r.lineTo(ineqlines[curTarget][n][0][0],targets[curTarget].imgheight),r.stroke()):(l=ineqlines[curTarget][n][0][1]-a*ineqlines[curTarget][n][0][0],o=ineqlines[curTarget][n][0][1]+a*(targets[curTarget].imgwidth-ineqlines[curTarget][n][0][0]),10.2==ineqtypes[curTarget][n]?null!=dragObj&&10<=dragObj.mode&&dragObj.mode<11&&dragObj.num==n&&0==dragObj.subnum?(r.dashedLine(ineqlines[curTarget][n][1][0],ineqlines[curTarget][n][1][1],targets[curTarget].imgwidth,o),r.dashedLine(ineqlines[curTarget][n][1][0],ineqlines[curTarget][n][1][1],0,l)):(r.dashedLine(ineqlines[curTarget][n][0][0],ineqlines[curTarget][n][0][1],targets[curTarget].imgwidth,o),r.dashedLine(ineqlines[curTarget][n][0][0],ineqlines[curTarget][n][0][1],0,l)):(r.moveTo(0,l),r.lineTo(targets[curTarget].imgwidth,o),r.stroke()))):ineqtypes[curTarget][n]<=10.4?10.3==ineqtypes[curTarget][n]?(i!=ineqlines[curTarget][n][0][0]&&(u==ineqlines[curTarget][n][0][1]?(r.moveTo(0,u),r.lineTo(targets[curTarget].imgwidth,u)):(c=(u-ineqlines[curTarget][n][0][1])/((i-ineqlines[curTarget][n][0][0])*(i-ineqlines[curTarget][n][0][0])),h=u>ineqlines[curTarget][n][0][1]?(d=Math.sqrt((targets[curTarget].imgheight-ineqlines[curTarget][n][0][1])/c)+ineqlines[curTarget][n][0][0],T=-1*Math.sqrt((targets[curTarget].imgheight-ineqlines[curTarget][n][0][1])/c)+ineqlines[curTarget][n][0][0],p=ineqlines[curTarget][n][0][1]-(targets[curTarget].imgheight-ineqlines[curTarget][n][0][1]),targets[curTarget].imgheight):(d=Math.sqrt((0-ineqlines[curTarget][n][0][1])/c)+ineqlines[curTarget][n][0][0],T=-1*Math.sqrt((0-ineqlines[curTarget][n][0][1])/c)+ineqlines[curTarget][n][0][0],p=2*ineqlines[curTarget][n][0][1],0),w=(m=d+2/3*(ineqlines[curTarget][n][0][0]-d))+(T-d)/3,f=y=h+2/3*(p-h),r.moveTo(d,h),r.bezierCurveTo(m,y,w,f,T,h))),r.stroke()):i!=ineqlines[curTarget][n][0][0]&&dashedParabola(r,ineqlines[curTarget][n][0][0],ineqlines[curTarget][n][0][1],i,u,targets[curTarget].imgwidth,targets[curTarget].imgheight):i!=ineqlines[curTarget][n][0][0]&&(a=(u-ineqlines[curTarget][n][0][1])/(i-ineqlines[curTarget][n][0][0]),i<ineqlines[curTarget][n][0][0]&&(a*=-1),l=ineqlines[curTarget][n][0][1]+a*ineqlines[curTarget][n][0][0],o=ineqlines[curTarget][n][0][1]+a*(targets[curTarget].imgwidth-ineqlines[curTarget][n][0][0]),10.6==ineqtypes[curTarget][n]?(null!=dragObj&&10<=dragObj.mode&&dragObj.mode<11&&dragObj.num==n&&dragObj.subnum,r.dashedLine(ineqlines[curTarget][n][0][0],ineqlines[curTarget][n][0][1],targets[curTarget].imgwidth,o),r.dashedLine(ineqlines[curTarget][n][0][0],ineqlines[curTarget][n][0][1],0,l)):(r.moveTo(0,l),r.lineTo(ineqlines[curTarget][n][0][0],ineqlines[curTarget][n][0][1]),r.lineTo(targets[curTarget].imgwidth,o),r.stroke()))),ineqtypes[curTarget][n]==targets[curTarget].mode){for(r.beginPath(),v=0;v<ineqlines[curTarget][n].length;v++)2==v?(r.arc(ineqlines[curTarget][n][v][0],ineqlines[curTarget][n][v][1],4,0,2*Math.PI,!0),r.fill()):r.fillRect(ineqlines[curTarget][n][v][0]-3,ineqlines[curTarget][n][v][1]-3,6,6);1==ineqlines[curTarget][n].length&&null!=i&&r.fillRect(i-3,u-3,6,6)}r.beginPath()}for(r.fillStyle="rgb(0,0,255)",1==drawlocky[curTarget]?r.lineWidth=4:r.lineWidth=2,r.strokeStyle="rgb(0,0,255)",n=0;n<tplines[curTarget].length;n++){if(5<=tptypes[curTarget][n]&&tptypes[curTarget][n]<6)u=i=a=null,2==tplines[curTarget][n].length?(i=tplines[curTarget][n][1][0],u=tplines[curTarget][n][1][1]):curTPcurve==n&&null!=e&&1==tplines[curTarget][n].length&&(i=e,u=t),null!=i&&(5.3==tptypes[curTarget][n]||5.4==tptypes[curTarget][n]?(r.moveTo(tplines[curTarget][n][0][0],tplines[curTarget][n][0][1]),r.lineTo(i,u),5.4==tptypes[curTarget][n]&&(b=[i-tplines[curTarget][n][0][0],u-tplines[curTarget][n][0][1]],1e-4<(O=Math.sqrt(b[0]*b[0]+b[1]*b[1])))&&(r.moveTo(i-15*(b=[b[0]/O,b[1]/O])[0]-4*(O=[-b[1],b[0]])[0],u-15*b[1]-5*O[1]),r.lineTo(i,u),r.moveTo(i-15*b[0]+4*O[0],u-15*b[1]+5*O[1]),r.lineTo(i,u))):(i!=tplines[curTarget][n][0][0]&&(a=(u-tplines[curTarget][n][0][1])/(i-tplines[curTarget][n][0][0])),Math.abs(i-tplines[curTarget][n][0][0])<1||100<Math.abs(a)?5.2==tptypes[curTarget][n]?(r.moveTo(tplines[curTarget][n][0][0],tplines[curTarget][n][0][1]),u>tplines[curTarget][n][0][1]?r.lineTo(tplines[curTarget][n][0][0],targets[curTarget].imgheight):r.lineTo(tplines[curTarget][n][0][0],0)):(r.moveTo(tplines[curTarget][n][0][0],0),r.lineTo(tplines[curTarget][n][0][0],targets[curTarget].imgheight)):(l=tplines[curTarget][n][0][1]-a*tplines[curTarget][n][0][0],o=tplines[curTarget][n][0][1]+a*(targets[curTarget].imgwidth-tplines[curTarget][n][0][0]),l=tplines[curTarget][n][0][1]-a*tplines[curTarget][n][0][0],o=tplines[curTarget][n][0][1]+a*(targets[curTarget].imgwidth-tplines[curTarget][n][0][0]),5.2==tptypes[curTarget][n]?(r.moveTo(tplines[curTarget][n][0][0],tplines[curTarget][n][0][1]),i>tplines[curTarget][n][0][0]?r.lineTo(targets[curTarget].imgwidth,o):r.lineTo(0,l)):(r.moveTo(0,l),r.lineTo(targets[curTarget].imgwidth,o)))));else if(6==tptypes[curTarget][n]||6.1==tptypes[curTarget][n]||6.2==tptypes[curTarget][n])i=u=null,2==tplines[curTarget][n].length?(i=tplines[curTarget][n][1][0],u=tplines[curTarget][n][1][1]):curTPcurve==n&&null!=e&&1==tplines[curTarget][n].length&&(i=e,u=t),null!=i&&(6==tptypes[curTarget][n]?u==tplines[curTarget][n][0][1]?(r.moveTo(0,u),r.lineTo(targets[curTarget].imgwidth,u)):i==tplines[curTarget][n][0][0]?(r.moveTo(i,tplines[curTarget][n][0][1]),u>tplines[curTarget][n][0][1]?r.lineTo(i,targets[curTarget].imgheight):r.lineTo(i,0)):(c=(u-tplines[curTarget][n][0][1])/((i-tplines[curTarget][n][0][0])*(i-tplines[curTarget][n][0][0])),h=u>tplines[curTarget][n][0][1]?(d=Math.sqrt((targets[curTarget].imgheight-tplines[curTarget][n][0][1])/c)+tplines[curTarget][n][0][0],T=-1*Math.sqrt((targets[curTarget].imgheight-tplines[curTarget][n][0][1])/c)+tplines[curTarget][n][0][0],p=tplines[curTarget][n][0][1]-(targets[curTarget].imgheight-tplines[curTarget][n][0][1]),targets[curTarget].imgheight):(d=Math.sqrt((0-tplines[curTarget][n][0][1])/c)+tplines[curTarget][n][0][0],T=-1*Math.sqrt((0-tplines[curTarget][n][0][1])/c)+tplines[curTarget][n][0][0],p=2*tplines[curTarget][n][0][1],0),w=(m=d+2/3*(tplines[curTarget][n][0][0]-d))+(T-d)/3,f=y=h+2/3*(p-h),r.moveTo(d,h),r.bezierCurveTo(m,y,w,f,T,h)):6.1==tptypes[curTarget][n]?i==tplines[curTarget][n][0][0]?(r.moveTo(i,0),r.lineTo(i,targets[curTarget].imgheight)):u==tplines[curTarget][n][0][1]?(r.moveTo(tplines[curTarget][n][0][0],u),i>tplines[curTarget][n][0][0]?r.lineTo(targets[curTarget].imgwidth,u):r.lineTo(0,u)):(c=(i-tplines[curTarget][n][0][0])/((u-tplines[curTarget][n][0][1])*(u-tplines[curTarget][n][0][1])),b=i>tplines[curTarget][n][0][0]?(d=Math.sqrt((targets[curTarget].imgwidth-tplines[curTarget][n][0][0])/c)+tplines[curTarget][n][0][1],T=-1*Math.sqrt((targets[curTarget].imgwidth-tplines[curTarget][n][0][0])/c)+tplines[curTarget][n][0][1],S=tplines[curTarget][n][0][0]-(targets[curTarget].imgwidth-tplines[curTarget][n][0][0]),targets[curTarget].imgwidth):(d=Math.sqrt((0-tplines[curTarget][n][0][0])/c)+tplines[curTarget][n][0][1],T=-1*Math.sqrt((0-tplines[curTarget][n][0][0])/c)+tplines[curTarget][n][0][1],S=2*tplines[curTarget][n][0][0],0),f=(y=d+2/3*(tplines[curTarget][n][0][1]-d))+(T-d)/3,w=m=b+2/3*(S-b),r.moveTo(b,d),r.bezierCurveTo(m,y,w,f,b,T)):6.2==tptypes[curTarget][n]&&(u==tplines[curTarget][n][0][1]?(r.moveTo(tplines[curTarget][n][0][0],u),r.lineTo(i<tplines[curTarget][n][0][0]?0:targets[curTarget].imgwidth,u)):i==tplines[curTarget][n][0][0]?(r.moveTo(i,tplines[curTarget][n][0][1]),u>tplines[curTarget][n][0][1]?r.lineTo(i,targets[curTarget].imgheight):r.lineTo(i,0)):(c=(u-tplines[curTarget][n][0][1])/((i-tplines[curTarget][n][0][0])*(i-tplines[curTarget][n][0][0])),tplines[curTarget][n][0][0],h=u>tplines[curTarget][n][0][1]?(q=Math.sqrt((targets[curTarget].imgheight-tplines[curTarget][n][0][1])/c),targets[curTarget].imgheight):(q=Math.sqrt((0-tplines[curTarget][n][0][1])/c),0),i<tplines[curTarget][n][0][0]&&(q*=-1),m=tplines[curTarget][n][0][0]+1/3*q,y=tplines[curTarget][n][0][1],w=tplines[curTarget][n][0][0]+2/3*q,f=tplines[curTarget][n][0][1]+1/3*c*q*q,r.moveTo(tplines[curTarget][n][0][0],tplines[curTarget][n][0][1]),r.bezierCurveTo(m,y,w,f,tplines[curTarget][n][0][0]+q,h))));else if(6.5==tptypes[curTarget][n]){if(i=u=null,2==tplines[curTarget][n].length?(i=tplines[curTarget][n][1][0],u=tplines[curTarget][n][1][1]):curTPcurve==n&&null!=e&&1==tplines[curTarget][n].length&&(i=e,u=t),null!=i&&i!=tplines[curTarget][n][0][0])if(u==tplines[curTarget][n][0][1])r.moveTo(tplines[curTarget][n][0][0],u),i>tplines[curTarget][n][0][0]?r.lineTo(targets[curTarget].imgwidth,u):r.lineTo(0,u);else for(W=i<tplines[curTarget][n][0][0]?-1:1,c=(u-tplines[curTarget][n][0][1])/Math.sqrt(W*(i-tplines[curTarget][n][0][0])),r.moveTo(tplines[curTarget][n][0][0],tplines[curTarget][n][0][1]),M=tplines[curTarget][n][0][0],x=tplines[curTarget][n][0][1];M+=3*W,x=c*Math.sqrt(W*(M-tplines[curTarget][n][0][0]))+tplines[curTarget][n][0][1],r.lineTo(M,x),0<M&&M<targets[curTarget].imgwidth&&0<x&&x<targets[curTarget].imgheight;);}else if(6.3==tptypes[curTarget][n]){if(i=u=null,2==tplines[curTarget][n].length?(i=tplines[curTarget][n][1][0],u=tplines[curTarget][n][1][1]):curTPcurve==n&&null!=e&&1==tplines[curTarget][n].length&&(i=e,u=t),null!=i&&i!=tplines[curTarget][n][0][0])if(u==tplines[curTarget][n][0][1])r.moveTo(0,u),r.lineTo(targets[curTarget].imgwidth,u);else for(c=(u-tplines[curTarget][n][0][1])/safepow(i-tplines[curTarget][n][0][0],3),M=x=0;M<targets[curTarget].imgwidth+4;M+=1)(x=(x=c*safepow(M-tplines[curTarget][n][0][0],3)+tplines[curTarget][n][0][1])<-100?-100:x)>targets[curTarget].imgheight+100&&(x=targets[curTarget].imgheight+100),0==M?r.moveTo(M,x):r.lineTo(M,x)}else if(6.6==tptypes[curTarget][n]){if(i=u=null,2==tplines[curTarget][n].length?(i=tplines[curTarget][n][1][0],u=tplines[curTarget][n][1][1]):curTPcurve==n&&null!=e&&1==tplines[curTarget][n].length&&(i=e,u=t),null!=i&&i!=tplines[curTarget][n][0][0])if(u==tplines[curTarget][n][0][1])r.moveTo(0,u),r.lineTo(targets[curTarget].imgwidth,u);else for(c=(u-tplines[curTarget][n][0][1])/safepow(i-tplines[curTarget][n][0][0],1/3),M=x=0;M<targets[curTarget].imgwidth+4;M+=1)(x=(x=c*safepow(M-tplines[curTarget][n][0][0],1/3)+tplines[curTarget][n][0][1])<-100?-100:x)>targets[curTarget].imgheight+100&&(x=targets[curTarget].imgheight+100),0==M?r.moveTo(M,x):r.lineTo(M,x)}else if(7<=tptypes[curTarget][n]&&tptypes[curTarget][n]<8){if(i=u=null,2==tplines[curTarget][n].length?(i=tplines[curTarget][n][1][0],u=tplines[curTarget][n][1][1]):curTPcurve==n&&null!=e&&1==tplines[curTarget][n].length&&(i=e,u=t),null!=i&&(i!=tplines[curTarget][n][0][0]||u!=tplines[curTarget][n][0][1]))if(7==tptypes[curTarget][n])O=Math.sqrt((i-tplines[curTarget][n][0][0])*(i-tplines[curTarget][n][0][0])+(u-tplines[curTarget][n][0][1])*(u-tplines[curTarget][n][0][1])),r.arc(tplines[curTarget][n][0][0],tplines[curTarget][n][0][1],O,0,2*Math.PI,!0);else if(7.2==tptypes[curTarget][n])R=Math.abs(i-tplines[curTarget][n][0][0]),X=Math.abs(u-tplines[curTarget][n][0][1]),(curTPcurve==n||null!=dragObj&&dragObj.num==n)&&(r.strokeStyle="rgb(0,255,255)",r.lineWidth=1,r.dashedLine(i,u,i-2*(i-tplines[curTarget][n][0][0]),u,5),r.dashedLine(i,u,i,u-2*(u-tplines[curTarget][n][0][1]),5),r.dashedLine(i,u-2*(u-tplines[curTarget][n][0][1]),i-2*(i-tplines[curTarget][n][0][0]),u-2*(u-tplines[curTarget][n][0][1]),5),r.dashedLine(i-2*(i-tplines[curTarget][n][0][0]),u,i-2*(i-tplines[curTarget][n][0][0]),u-2*(u-tplines[curTarget][n][0][1]),5),r.lineWidth=2),r.strokeStyle="rgb(0,0,255)",r.save(),r.beginPath(),r.translate(tplines[curTarget][n][0][0]-R,tplines[curTarget][n][0][1]-X),r.scale(R,X),r.arc(1,1,1,0,2*Math.PI,!1),r.restore();else if(7.4==tptypes[curTarget][n]){for(L=Math.abs(i-tplines[curTarget][n][0][0]),j=Math.abs(u-tplines[curTarget][n][0][1]),P=Math.abs(j/L),r.strokeStyle=asymcolor,r.dashedLine(tplines[curTarget][n][0][0],tplines[curTarget][n][0][1],targets[curTarget].imgwidth,tplines[curTarget][n][0][1]+P*(targets[curTarget].imgwidth-tplines[curTarget][n][0][0])),r.dashedLine(tplines[curTarget][n][0][0],tplines[curTarget][n][0][1],targets[curTarget].imgwidth,tplines[curTarget][n][0][1]-P*(targets[curTarget].imgwidth-tplines[curTarget][n][0][0])),r.dashedLine(tplines[curTarget][n][0][0],tplines[curTarget][n][0][1],0,tplines[curTarget][n][0][1]-P*tplines[curTarget][n][0][0]),r.dashedLine(tplines[curTarget][n][0][0],tplines[curTarget][n][0][1],0,tplines[curTarget][n][0][1]+P*tplines[curTarget][n][0][0]),(curTPcurve==n||null!=dragObj&&dragObj.num==n)&&(r.strokeStyle="rgb(0,255,255)",r.lineWidth=1,r.dashedLine(i,u,i-2*(i-tplines[curTarget][n][0][0]),u,5),r.dashedLine(i,u,i,u-2*(u-tplines[curTarget][n][0][1]),5),r.dashedLine(i,u-2*(u-tplines[curTarget][n][0][1]),i-2*(i-tplines[curTarget][n][0][0]),u-2*(u-tplines[curTarget][n][0][1]),5),r.dashedLine(i-2*(i-tplines[curTarget][n][0][0]),u,i-2*(i-tplines[curTarget][n][0][0]),u-2*(u-tplines[curTarget][n][0][1]),5),r.lineWidth=2),r.beginPath(),r.strokeStyle="rgb(0,0,255)",M=0;M<targets[curTarget].imgwidth+4;M+=3)(x=(x=tplines[curTarget][n][0][1]+Math.sqrt((Math.pow(M-tplines[curTarget][n][0][0],2)/(L*L)+1)*j*j))<-100?-100:x)>targets[curTarget].imgheight+100&&(x=targets[curTarget].imgheight+100),0==M?r.moveTo(M,x):r.lineTo(M,x);for(r.stroke(),r.beginPath(),M=0;M<targets[curTarget].imgwidth+4;M+=3)(x=(x=tplines[curTarget][n][0][1]-Math.sqrt((Math.pow(M-tplines[curTarget][n][0][0],2)/(L*L)+1)*j*j))<-100?-100:x)>targets[curTarget].imgheight+100&&(x=targets[curTarget].imgheight+100),0==M?r.moveTo(M,x):r.lineTo(M,x)}else if(7.5==tptypes[curTarget][n]){for(j=Math.abs(i-tplines[curTarget][n][0][0]),L=Math.abs(u-tplines[curTarget][n][0][1]),P=Math.abs(L/j),r.strokeStyle=asymcolor,r.dashedLine(tplines[curTarget][n][0][0],tplines[curTarget][n][0][1],targets[curTarget].imgwidth,tplines[curTarget][n][0][1]+P*(targets[curTarget].imgwidth-tplines[curTarget][n][0][0])),r.dashedLine(tplines[curTarget][n][0][0],tplines[curTarget][n][0][1],targets[curTarget].imgwidth,tplines[curTarget][n][0][1]-P*(targets[curTarget].imgwidth-tplines[curTarget][n][0][0])),r.dashedLine(tplines[curTarget][n][0][0],tplines[curTarget][n][0][1],0,tplines[curTarget][n][0][1]-P*tplines[curTarget][n][0][0]),r.dashedLine(tplines[curTarget][n][0][0],tplines[curTarget][n][0][1],0,tplines[curTarget][n][0][1]+P*tplines[curTarget][n][0][0]),(curTPcurve==n||null!=dragObj&&dragObj.num==n)&&(r.strokeStyle="rgb(0,255,255)",r.lineWidth=1,r.dashedLine(i,u,i-2*(i-tplines[curTarget][n][0][0]),u,5),r.dashedLine(i,u,i,u-2*(u-tplines[curTarget][n][0][1]),5),r.dashedLine(i,u-2*(u-tplines[curTarget][n][0][1]),i-2*(i-tplines[curTarget][n][0][0]),u-2*(u-tplines[curTarget][n][0][1]),5),r.dashedLine(i-2*(i-tplines[curTarget][n][0][0]),u,i-2*(i-tplines[curTarget][n][0][0]),u-2*(u-tplines[curTarget][n][0][1]),5),r.lineWidth=2),r.beginPath(),r.strokeStyle="rgb(0,0,255)",x=0;x<targets[curTarget].imgwidth+4;x+=3)(M=(M=tplines[curTarget][n][0][0]+Math.sqrt((Math.pow(x-tplines[curTarget][n][0][1],2)/(L*L)+1)*j*j))<-100?-100:M)>targets[curTarget].imgwidth+100&&(M=targets[curTarget].imgwidth+100),0==x?r.moveTo(M,x):r.lineTo(M,x);for(r.stroke(),r.beginPath(),x=0;x<targets[curTarget].imgwidth+4;x+=3)(M=(M=tplines[curTarget][n][0][0]-Math.sqrt((Math.pow(x-tplines[curTarget][n][0][1],2)/(L*L)+1)*j*j))<-100?-100:M)>targets[curTarget].imgwidth+100&&(M=targets[curTarget].imgwidth+100),0==x?r.moveTo(M,x):r.lineTo(M,x)}}else if(8==tptypes[curTarget][n])u=i=a=null,2==tplines[curTarget][n].length?(i=tplines[curTarget][n][1][0],u=tplines[curTarget][n][1][1]):curTPcurve==n&&null!=e&&1==tplines[curTarget][n].length&&(i=e,u=t),null!=i&&(i!=tplines[curTarget][n][0][0]&&(a=(u-tplines[curTarget][n][0][1])/(i-tplines[curTarget][n][0][0]),i<tplines[curTarget][n][0][0])&&(a*=-1),Math.abs(i-tplines[curTarget][n][0][0])<1||100<Math.abs(a)?(r.moveTo(tplines[curTarget][n][0][0],tplines[curTarget][n][0][1]),u>tplines[curTarget][n][0][1]?r.lineTo(tplines[curTarget][n][0][0],targets[curTarget].imgheight):r.lineTo(tplines[curTarget][n][0][0],0)):(l=tplines[curTarget][n][0][1]+a*tplines[curTarget][n][0][0],o=tplines[curTarget][n][0][1]+a*(targets[curTarget].imgwidth-tplines[curTarget][n][0][0]),r.moveTo(0,l),r.lineTo(tplines[curTarget][n][0][0],tplines[curTarget][n][0][1]),r.lineTo(targets[curTarget].imgwidth,o)));else if(8.3==tptypes[curTarget][n]){if(i=u=null,2==tplines[curTarget][n].length?(i=tplines[curTarget][n][1][0],u=tplines[curTarget][n][1][1]):curTPcurve==n&&null!=e&&1==tplines[curTarget][n].length&&(i=e,u=t),null!=i&&i!=tplines[curTarget][n][0][0])if(u==tplines[curTarget][n][0][1])r.moveTo(0,u),r.lineTo(targets[curTarget].imgwidth,u);else if(0<(R=(H=targets[curTarget].ymax*targets[curTarget].pixpery+targets[curTarget].imgborder)-tplines[curTarget][n][0][1])*(z=H-u)&&i!=tplines[curTarget][n][0][0])for(E=safepow(z/R,1/(i-tplines[curTarget][n][0][0])),c=z/safepow(E,i),r.moveTo(tplines[curTarget][n][0][0],tplines[curTarget][n][0][1]),M=x=0;M<targets[curTarget].imgwidth+4;M+=3)(x=(x=H-c*safepow(E,M))<-100?-100:x)>targets[curTarget].imgheight+100&&(x=targets[curTarget].imgheight+100),0==M?r.moveTo(M,x):r.lineTo(M,x)}else if(8.4==tptypes[curTarget][n]){if(i=u=null,2==tplines[curTarget][n].length?(i=tplines[curTarget][n][1][0],u=tplines[curTarget][n][1][1]):curTPcurve==n&&null!=e&&1==tplines[curTarget][n].length&&(i=e,u=t),null!=i&&i!=tplines[curTarget][n][0][0]&&u!=tplines[curTarget][n][0][1]&&0<(F=(U=-targets[curTarget].xmin*targets[curTarget].pixperx+targets[curTarget].imgborder)-tplines[curTarget][n][0][0])*(Y=U-i)&&u!=tplines[curTarget][n][0][1])for(E=safepow(Y/F,1/(u-tplines[curTarget][n][0][1])),c=Y/safepow(E,u),r.moveTo(tplines[curTarget][n][0][0],tplines[curTarget][n][0][1]),x=x=0;x<targets[curTarget].imgheight+4;x+=3)(M=(M=U-c*safepow(E,x))<-100?-100:M)>targets[curTarget].imgwidth+100&&(M=targets[curTarget].imgwidth+100),0==x?r.moveTo(M,x):r.lineTo(M,x)}else if(8.5==tptypes[curTarget][n]){if(s=g=i=u=null,3==tplines[curTarget][n].length?(i=tplines[curTarget][n][1][0],u=tplines[curTarget][n][1][1],s=tplines[curTarget][n][2][0],g=tplines[curTarget][n][2][1]):2==tplines[curTarget][n].length?(i=tplines[curTarget][n][1][0],u=tplines[curTarget][n][1][1],s=e,g=t):curTPcurve==n&&null!=e&&1==tplines[curTarget][n].length&&(i=e,u=t),I=tplines[curTarget][n][0][1],r.strokeStyle=asymcolor,r.dashedLine(5,I,targets[curTarget].imgwidth,I),r.beginPath(),r.strokeStyle="rgb(0,0,255)",null!=s&&s!=i)if(g==u)r.moveTo(0,g),r.lineTo(targets[curTarget].imgwidth,g);else if(0<(z=I-u)*(X=I-g)&&s!=i)for(E=safepow(X/z,1/(s-i)),c=X/safepow(E,s),r.moveTo(i,u),M=x=0;M<targets[curTarget].imgwidth+4;M+=3)(x=(x=I-c*safepow(E,M))<-100?-100:x)>targets[curTarget].imgheight+100&&(x=targets[curTarget].imgheight+100),0==M?r.moveTo(M,x):r.lineTo(M,x)}else if(8.6==tptypes[curTarget][n]){if(s=g=i=u=null,3==tplines[curTarget][n].length?(i=tplines[curTarget][n][1][0],u=tplines[curTarget][n][1][1],s=tplines[curTarget][n][2][0],g=tplines[curTarget][n][2][1]):2==tplines[curTarget][n].length?(i=tplines[curTarget][n][1][0],u=tplines[curTarget][n][1][1],s=e,g=t):curTPcurve==n&&null!=e&&1==tplines[curTarget][n].length&&(i=e,u=t),V=tplines[curTarget][n][0][0],r.strokeStyle=asymcolor,r.dashedLine(V,5,V,targets[curTarget].imgheight),r.beginPath(),r.strokeStyle="rgb(0,0,255)",null!=s&&s!=i&&g!=u&&0<(Y=i-V)*(G=s-V))for(E=safepow(G/Y,1/(g-u)),c=G/safepow(E,g),r.moveTo(i,u),x=M=0;x<targets[curTarget].imgheight+4;x+=3)(M=(M=V+c*safepow(E,x))<-100?-100:M)>targets[curTarget].imgwidth+100&&(M=targets[curTarget].imgwidth+100),0==x?r.moveTo(M,x):r.lineTo(M,x)}else if(8.2==tptypes[curTarget][n]){if(i=u=null,2==tplines[curTarget][n].length?(i=tplines[curTarget][n][1][0],u=tplines[curTarget][n][1][1]):curTPcurve==n&&null!=e&&1==tplines[curTarget][n].length&&(i=e,u=t),r.strokeStyle=asymcolor,r.dashedLine(5,tplines[curTarget][n][0][1],targets[curTarget].imgwidth,tplines[curTarget][n][0][1]),r.dashedLine(tplines[curTarget][n][0][0],5,tplines[curTarget][n][0][0],targets[curTarget].imgheight),r.beginPath(),r.strokeStyle="rgb(0,0,255)",null!=i&&i!=tplines[curTarget][n][0][0]&&u!=tplines[curTarget][n][0][1]){for(c=(u-tplines[curTarget][n][0][1])*(i-tplines[curTarget][n][0][0]),M=tplines[curTarget][n][0][0]-1;-4<M;M-=3)(x=(x=c/(M-tplines[curTarget][n][0][0])+tplines[curTarget][n][0][1])<-100?-100:x)>targets[curTarget].imgheight+100&&(x=targets[curTarget].imgheight+100),M==tplines[curTarget][n][0][0]-1?r.moveTo(M,x):r.lineTo(M,x);for(M=tplines[curTarget][n][0][0]+1;M<targets[curTarget].imgwidth+4;M+=3)(x=(x=c/(M-tplines[curTarget][n][0][0])+tplines[curTarget][n][0][1])<-100?-100:x)>targets[curTarget].imgheight+100&&(x=targets[curTarget].imgheight+100),M==tplines[curTarget][n][0][0]+1?r.moveTo(M,x):r.lineTo(M,x);r.stroke()}}else if((9==tptypes[curTarget][n]||9.1==tptypes[curTarget][n])&&(i=u=null,2==tplines[curTarget][n].length?(i=tplines[curTarget][n][1][0],u=tplines[curTarget][n][1][1]):curTPcurve==n&&null!=e&&1==tplines[curTarget][n].length&&(i=e,u=t),null!=i)&&i!=tplines[curTarget][n][0][0])if(u==tplines[curTarget][n][0][1])r.moveTo(0,u),r.lineTo(targets[curTarget].imgwidth,u);else for(9==tptypes[curTarget][n]?(J=-1*Math.abs(u-tplines[curTarget][n][0][1])/2,Q=(u+tplines[curTarget][n][0][1])/2,c=Math.PI/Math.abs(i-tplines[curTarget][n][0][0]),K=u<tplines[curTarget][n][0][1]?i:tplines[curTarget][n][0][0]):9.1==tptypes[curTarget][n]&&(J=-1*Math.abs(u-tplines[curTarget][n][0][1]),Q=tplines[curTarget][n][0][1],c=.5*Math.PI/Math.abs(i-tplines[curTarget][n][0][0]),K=u<tplines[curTarget][n][0][1]?i:i+2*Math.abs(i-tplines[curTarget][n][0][0])),M=x=0;M<targets[curTarget].imgwidth+4;M+=3)x=J*Math.cos(c*(M-K))+Q,0==M?r.moveTo(M,x):r.lineTo(M,x);r.stroke(),r.beginPath()}for(null===curTPcurve&&tpHasAsymp.hasOwnProperty(targets[curTarget].mode)&&(r.strokeStyle="rgb(200,200,200)",8.5==targets[curTarget].mode?r.dashedLine(5,t,targets[curTarget].imgwidth,t):8.6==targets[curTarget].mode?r.dashedLine(e,5,e,targets[curTarget].imgwidth):8.2==targets[curTarget].mode?(r.dashedLine(5,t,targets[curTarget].imgwidth,t),r.dashedLine(e,5,e,targets[curTarget].imgheight)):7.4!=targets[curTarget].mode&&7.5!=targets[curTarget].mode||(r.dashedLine(e,t,targets[curTarget].imgwidth,t+(targets[curTarget].imgwidth-e)),r.dashedLine(e,t,targets[curTarget].imgwidth,t-(targets[curTarget].imgwidth-e)),r.dashedLine(e,t,0,t-e),r.dashedLine(e,t,0,t+e)),r.beginPath(),r.strokeStyle="rgb(0,0,255)"),r.fillStyle="rgba(0,0,255,.5)",n=0;n<lines[curTarget].length;n++){for(r.beginPath(),v=0;v<lines[curTarget][n].length;v++)0==v?(r.moveTo(lines[curTarget][n][v][0],lines[curTarget][n][v][1]),_=lines[curTarget][n][v][0],N=lines[curTarget][n][v][1]):(r.lineTo(lines[curTarget][n][v][0],lines[curTarget][n][v][1]),k=lines[curTarget][n][v][0],B=lines[curTarget][n][v][1]);if(n==curLine&&null!=e&&(r.lineTo(e,t),k=e,B=t),$=.02*targets[curTarget].imgwidth,1==drawlocky[curTarget]&&k>.98*targets[curTarget].imgwidth?(r.moveTo(k,B),r.lineTo(k-$,B+$),r.moveTo(k,B),r.lineTo(k-$,B-$)):1==drawlocky[curTarget]&&_>.98*targets[curTarget].imgwidth&&(r.moveTo(_,N),r.lineTo(_-$,N+$),r.moveTo(_,N),r.lineTo(_-$,N-$)),1==drawlocky[curTarget]&&k<.02*targets[curTarget].imgwidth?(r.moveTo(k,B),r.lineTo(k+$,B+$),r.moveTo(k,B),r.lineTo(k+$,B-$)):1==drawlocky[curTarget]&&_<.02*targets[curTarget].imgwidth&&(r.moveTo(_,N),r.lineTo(_+$,N+$),r.moveTo(_,N),r.lineTo(_+$,N-$)),r.stroke(),1<targets[curTarget].dotline&&!(lines[curTarget][n].length-1<1)&&Math.pow(k-_,2)+Math.pow(B-N,2)<25){for(r.moveTo(lines[curTarget][n][0][0],lines[curTarget][n][0][1]),v=1;v<lines[curTarget][n].length;v++)r.lineTo(lines[curTarget][n][v][0],lines[curTarget][n][v][1]);r.closePath(),r.fill()}}for(r.fillStyle="rgb(0,0,255)",r.beginPath(),n=0;n<dots[curTarget].length;n++)r.moveTo(dots[curTarget][n][0]+5,dots[curTarget][n][1]),r.arc(dots[curTarget][n][0],dots[curTarget][n][1],5,0,2*Math.PI,!0);if(r.fill(),0<targets[curTarget].dotline){for(r.beginPath(),n=0;n<lines[curTarget].length;n++)for(v=0;v<lines[curTarget][n].length;v++)(0==v||25<Math.pow(lines[curTarget][n][v][0]-lines[curTarget][n][v-1][0],2)+Math.pow(lines[curTarget][n][v][1]-lines[curTarget][n][v-1][1],2))&&(r.moveTo(lines[curTarget][n][v][0]+5,lines[curTarget][n][v][1]),r.arc(lines[curTarget][n][v][0],lines[curTarget][n][v][1],5,0,2*Math.PI,!0));r.fill()}for(r.fillStyle="rgb(255,255,255)",r.beginPath(),n=0;n<odots[curTarget].length;n++)r.moveTo(odots[curTarget][n][0]+5,odots[curTarget][n][1]),r.arc(odots[curTarget][n][0],odots[curTarget][n][1],4,0,2*Math.PI,!0);for(targets[curTarget].mode<3?r.fill():r.stroke(),r.lineWidth=2,r.beginPath(),n=0;n<odots[curTarget].length;n++)r.moveTo(odots[curTarget][n][0]+5,odots[curTarget][n][1]),r.arc(odots[curTarget][n][0],odots[curTarget][n][1],4,0,2*Math.PI,!0);for(r.stroke(),n=0;n<tplines[curTarget].length;n++)if(tptypes[curTarget][n]==targets[curTarget].mode){for(r.fillStyle="rgb(255,0,0)",v=0;v<tplines[curTarget][n].length;v++)r.fillRect(tplines[curTarget][n][v][0]-3,tplines[curTarget][n][v][1]-3,6,6);tplines[curTarget][n].length<tpModeN[targets[curTarget].mode]&&null!=e&&curTPcurve==n&&r.fillRect(e-3,t-3,6,6),r.fillStyle="rgb(0,0,255)"}!0!==C&&encodeDraw()}function deleteCurve(e,t){1==e?dots[curTarget].splice(t,1):2==e?odots[curTarget].splice(t,1):0<=e&&e<1?lines[curTarget].splice(t,1):5<=e&&e<10?(tplines[curTarget].splice(t,1),tptypes[curTarget].splice(t,1),curTPcurve=null):10<=e&&e<11&&(ineqlines[curTarget].splice(t,1),ineqtypes[curTarget].splice(t,1),curIneqcurve=null),drawTarget()}function roundToDec(e,t){return Math.round(e)}function encodeDraw(){for(var e,t,r,n,a,i="",s=[],u=0;u<lines[curTarget].length;u++)for(lines[curTarget][u].length,s=0==targets[curTarget].dotline?pathsimplify(lines[curTarget][u]):lines[curTarget][u],0!=u&&(i+=";"),e=0;e<s.length;e++)0!=e&&(i+=","),i+="("+roundToDec(s[e][0],4)+","+roundToDec(s[e][1],4)+")";for(i+=";;",u=0;u<dots[curTarget].length;u++)0!=u&&(i+=","),i+="("+roundToDec(dots[curTarget][u][0],4)+","+roundToDec(dots[curTarget][u][1],4)+")";for(i+=";;",u=0;u<odots[curTarget].length;u++)0!=u&&(i+=","),i+="("+roundToDec(odots[curTarget][u][0],4)+","+roundToDec(odots[curTarget][u][1],4)+")";for(i+=";;",t=[],r="",u=0;u<tplines[curTarget].length;u++)if(tplines[curTarget][u].length==tpModeN[tptypes[curTarget][u]]){for(r="("+tptypes[curTarget][u],e=0;e<tplines[curTarget][u].length;e++)r+=","+roundToDec(tplines[curTarget][u][e][0],4)+","+roundToDec(tplines[curTarget][u][e][1],4);t.push(r+")")}for(i=i+t.join(",")+";;",n=[],u=0;u<ineqlines[curTarget].length;u++)2<ineqlines[curTarget][u].length&&n.push("("+ineqtypes[curTarget][u]+","+roundToDec(ineqlines[curTarget][u][0][0],4)+","+roundToDec(ineqlines[curTarget][u][0][1],4)+","+roundToDec(ineqlines[curTarget][u][1][0],4)+","+roundToDec(ineqlines[curTarget][u][1][1],4)+","+roundToDec(ineqlines[curTarget][u][2][0],4)+","+roundToDec(ineqlines[curTarget][u][2][1],4)+")");i+=n.join(","),targetOuts[curTarget].value!=i&&(a=""!=targetOuts[curTarget].value||";;;;;;;;"!=i,targetOuts[curTarget].value=i,a)&&$(targetOuts[curTarget]).trigger("input").trigger("change")}function drawMouseDown(e){var t,r,n,a;if(clickcnt++,clearAllDrawListners(),hasTouch&&1<e.originalEvent.touches.length)return didMultiTouch=!0,$(document).on("touchend.imathasdraw",drawMouseUp),!0;if(hasTouch?(window.clearTimeout(hasTouchTimer),$(document).off("mousemove.imathasdraw"),$(".drawcanvas").on("touchstart.imathasdraw",function(e){hasTouch=!0,drawMouseDown(e)}),$(".drawcanvas").on("touchmove.imathasdraw",drawMouseMove),$(document).on("touchend.imathasdraw",drawMouseUp),$(document).on("touchcancel.imathasdraw",drawMouseUp)):($(document).on("mousemove.imathasdraw",drawMouseMove),$(document).on("mouseup.imathasdraw",drawMouseUp)),t=mouseCoords(e),null==curTarget||null==curLine&&null==curTPcurve&&null==curIneqcurve)for(i in targets)if(!$(targets[i].el).is(":hidden")&&"canvas"==targets[i].type&&(r=getPosition(targets[i].el)).x<t.x&&r.x+targets[i].width>t.x&&r.y<t.y&&r.y+targets[i].height>t.y&&e.target==targets[i].el){curTarget=i;break}if(null!=curTarget&&!targetOuts[curTarget].disabled)if(e.preventDefault(),mouseisdown=!0,r=getPosition(targets[curTarget].el),-1<(n={x:t.x-r.x,y:t.y-r.y}).x&&n.x<targets[curTarget].width&&-1<n.y&&n.y<targets[curTarget].height){if(0<targets[curTarget].snaptogridx&&(n=snaptogrid(n,curTarget)),1==drawlocky[curTarget]&&(n.y=targets[curTarget].imgheight/2),null!=(a=findnearpoint(curTarget,n))){if(-1==targets[curTarget].mode)return void deleteCurve(a[0],a[1]);(null!=curLine&&a[0]<1&&curLine!=a[1]||null!=curTPcurve&5<=a[0]&&a[0]<10&&curTPcurve!=a[1]||null!=curIneqcurve&&10<=a[0]&&a[0]<11&&curIneqcurve!=a[1])&&(a=null)}null==a?(setCursor("pendown"),1==targets[curTarget].mode?(dots[curTarget].push([n.x,n.y]),dragObj={mode:1,num:dots[curTarget].length-1}):2==targets[curTarget].mode?(odots[curTarget].push([n.x,n.y]),dragObj={mode:2,num:odots[curTarget].length-1}):0==targets[curTarget].mode||.7==targets[curTarget].mode?null==curLine?(lines[curTarget].push([[n.x,n.y]]),curLine=lines[curTarget].length-1):lines[curTarget][curLine].push([n.x,n.y]):.5==targets[curTarget].mode?null==curLine?(lines[curTarget].push([[n.x,n.y]]),curLine=lines[curTarget].length-1):(lines[curTarget][curLine].push([n.x,n.y]),dragObj=curLine=null):5<=targets[curTarget].mode&&targets[curTarget].mode<10?null==curTPcurve?(tplines[curTarget].push([[n.x,n.y]]),curTPcurve=tplines[curTarget].length-1,tptypes[curTarget][curTPcurve]=targets[curTarget].mode,mouseisdown=!1):(tplines[curTarget][curTPcurve].push([n.x,n.y]),tplines[curTarget][curTPcurve].length==tpModeN[targets[curTarget].mode]?(dragObj={mode:targets[curTarget].mode,num:curTPcurve,subnum:tpModeN[targets[curTarget].mode]-1},curTPcurve=null):mouseisdown=!1):10<=targets[curTarget].mode&&targets[curTarget].mode<11&&(null==curIneqcurve?(ineqlines[curTarget].push([[n.x,n.y]]),curIneqcurve=ineqlines[curTarget].length-1,ineqtypes[curTarget][curIneqcurve]=targets[curTarget].mode,mouseisdown=!1):(ineqlines[curTarget][curIneqcurve].push([n.x,n.y]),2==ineqlines[curTarget][curIneqcurve].length?dragObj={mode:targets[curTarget].mode,num:curIneqcurve,subnum:1}:3==ineqlines[curTarget][curIneqcurve].length&&(dragObj={mode:targets[curTarget].mode,num:curIneqcurve,subnum:2},curIneqcurve=null)))):0==a[0]||.5==a[0]?null==curLine?(setCursor("move"),dragObj={mode:targets[curTarget].mode,num:a[1],subnum:a[2]},oldpointpos=lines[curTarget][a[1]][a[2]],a[2]==lines[curTarget][a[1]].length-1&&0==targets[curTarget].mode?curLine=a[1]:0==a[2]&&0==targets[curTarget].mode&&(curLine=a[1],lines[curTarget][curLine].reverse(),dragObj.subnum=lines[curTarget][curLine].length-1),clickmightbenewcurve=!0):a[1]==curLine&&a[2]==lines[curTarget][a[1]].length-1?(lines[curTarget][curLine].length<2&&lines[curTarget].splice(curLine,1),curLine=null):1<targets[curTarget].dotline&&a[1]==curLine&&0==a[2]?(lines[curTarget][curLine].push(lines[curTarget][curLine][0]),curLine=null):(setCursor("pendown"),lines[curTarget][curLine].push([n.x,n.y])):1==a[0]?(setCursor("move"),dragObj={mode:1,num:a[1]}):2==a[0]?(setCursor("move"),dragObj={mode:2,num:a[1]}):5<=a[0]&&a[0]<10?null==curTPcurve&&(setCursor("move"),dragObj={mode:a[0],num:a[1],subnum:a[2]},oldpointpos=tplines[curTarget][a[1]][a[2]],clickmightbenewcurve=!0):10<=a[0]&&a[0]<11&&null==curIneqcurve&&(setCursor("move"),dragObj={mode:a[0],num:a[1],subnum:a[2]},oldpointpos=ineqlines[curTarget][a[1]][a[2]],clickmightbenewcurve=!0),drawTarget()}else null!=curLine&&(lines[curTarget][curLine].length<2&&lines[curTarget].splice(curLine,1),setCursor("pen")),null!=curTPcurve&&(tplines[curTarget][curTPcurve].length<tpModeN[targets[curTarget].mode]&&(tplines[curTarget].splice(curTPcurve,1),tptypes[curTarget].splice(curTPcurve,1)),setCursor("pen")),null!=curIneqcurve&&(ineqlines[curTarget][curIneqcurve].length<3&&(ineqlines[curTarget].splice(curIneqcurve,1),ineqtypes[curTarget].splice(curIneqcurve,1)),setCursor("pen")),dragObj=curIneqcurve=curTPcurve=curLine=null,drawTarget(),curTarget=null}function findnearpoint(e,t){var r,n,a;if(hasTouch?(r=Math.max(15*window.innerWidth/screen.width,15),r*=r):r=-1==targets[e].mode?50:25,0==targets[e].mode||.5==targets[e].mode||-1==targets[e].mode)for(n=lines[e].length-1;0<=n;n--)for(a=lines[e][n].length-1;0<=a;a--)if(Math.pow(lines[e][n][a][0]-t.x,2)+Math.pow(lines[e][n][a][1]-t.y,2)<r)return[-1==targets[e].mode?0:targets[e].mode,n,a];if(1==targets[e].mode||-1==targets[e].mode)for(n=dots[e].length-1;0<=n;n--)if(Math.pow(dots[e][n][0]-t.x,2)+Math.pow(dots[e][n][1]-t.y,2)<r)return[1,n];if(2==targets[e].mode||-1==targets[e].mode)for(n=odots[e].length-1;0<=n;n--)if(Math.pow(odots[e][n][0]-t.x,2)+Math.pow(odots[e][n][1]-t.y,2)<r)return[2,n];if(5<=targets[e].mode&&targets[e].mode<10||-1==targets[e].mode)for(n=tplines[e].length-1;0<=n;n--)for(a=tplines[e][n].length-1;0<=a;a--)if((tptypes[e][n]==targets[e].mode||-1==targets[e].mode)&&Math.pow(tplines[e][n][a][0]-t.x,2)+Math.pow(tplines[e][n][a][1]-t.y,2)<r)return[tptypes[e][n],n,a];if(10<=targets[e].mode&&targets[e].mode<11||-1==targets[e].mode)for(n=ineqlines[e].length-1;0<=n;n--)for(a=ineqlines[e][n].length-1;0<=a;a--)if((ineqtypes[e][n]==targets[e].mode||-1==targets[e].mode)&&Math.pow(ineqlines[e][n][a][0]-t.x,2)+Math.pow(ineqlines[e][n][a][1]-t.y,2)<r)return[ineqtypes[e][n],n,a];return null}function drawMouseUp(e){var t,r,n,a=mouseCoords(e);if(mouseisdown=!1,null!=curTarget){if(targetOuts[curTarget].disabled)return;t=getPosition(targets[curTarget].el),r={x:a.x-t.x,y:a.y-t.y},n=-1<(r=0<targets[curTarget].snaptogridx?snaptogrid(r,curTarget):r).x&&r.x<targets[curTarget].width&&-1<r.y&&r.y<targets[curTarget].height,1==clickmightbenewcurve&&(5<=targets[curTarget].mode&&targets[curTarget].mode<10?(tplines[curTarget].push([[r.x,r.y]]),curTPcurve=tplines[curTarget].length-1,tptypes[curTarget][curTPcurve]=targets[curTarget].mode):10<=targets[curTarget].mode&&targets[curTarget].mode<11&&(ineqlines[curTarget].push([[r.x,r.y]]),curIneqcurve=ineqlines[curTarget].length-1,ineqtypes[curTarget][curIneqcurve]=targets[curTarget].mode)),null!=lastdrawmouseup&&a.x==lastdrawmouseup.x&&a.y==lastdrawmouseup.y&&null!=curLine&&null==dragObj&&(lines[curTarget][curLine].length<2&&lines[curTarget].splice(curLine,1),dragObj=curLine=null,drawTarget()),null!=curLine&&null==dragObj&&(.5==targets[curTarget].mode&&1<lines[curTarget][curLine].length||.7==targets[curTarget].mode)&&(dragobj=curLine=null,drawTarget()),null!=curTPcurve&&tplines[curTarget][curTPcurve].length<tpModeN[targets[curTarget].mode]&&(didMultiTouch||!n?(tplines[curTarget].splice(curTPcurve,1),tptypes[curTarget].splice(curTPcurve,1),curTPcurve=null,drawTarget()):null==findnearpoint(curTarget,r)&&(tplines[curTarget][curTPcurve].push([r.x,r.y]),tplines[curTarget][curTPcurve].length==tpModeN[targets[curTarget].mode]&&(curTPcurve=null),drawTarget())),null!=curIneqcurve&&1==ineqlines[curTarget][curIneqcurve].length&&(didMultiTouch||!n?(ineqlines[curTarget].splice(curIneqcurve,1),ineqtypes[curTarget].splice(curIneqcurve,1),curIneqcurve=null,drawTarget()):null==findnearpoint(curTarget,r)&&(ineqlines[curTarget][curIneqcurve].push([r.x,r.y]),drawTarget())),setCursor(null==curLine&&null==curTPcurve?"move":"pen"),void 0!==e&&e.preventDefault()}lastdrawmouseup=a,null!=curTarget&&null!=dragObj&&(t=getPosition(targets[curTarget].el),-1<r.x&&r.x<targets[curTarget].width&&-1<r.y&&r.y<targets[curTarget].height?(0==dragObj.mode&&1<targets[curTarget].dotline&&(0!=dragObj.subnum&&dragObj.subnum!=lines[curTarget][dragObj.num].length-1||Math.pow(lines[curTarget][dragObj.num][0][0]-lines[curTarget][dragObj.num][lines[curTarget][dragObj.num].length-1][0],2)+Math.pow(lines[curTarget][dragObj.num][0][1]-lines[curTarget][dragObj.num][lines[curTarget][dragObj.num].length-1][1],2)<25&&(0==dragObj.subnum?(lines[curTarget][dragObj.num][lines[curTarget][dragObj.num].length-1][0]=lines[curTarget][dragObj.num][0][0],lines[curTarget][dragObj.num][lines[curTarget][dragObj.num].length-1][1]=lines[curTarget][dragObj.num][0][1]):(lines[curTarget][dragObj.num][0][0]=lines[curTarget][dragObj.num][lines[curTarget][dragObj.num].length-1][0],lines[curTarget][dragObj.num][0][1]=lines[curTarget][dragObj.num][lines[curTarget][dragObj.num].length-1][1]),curLine=null,drawTarget())),dragObj=null):(1==drawlocky[curTarget]&&(r.y=targets[curTarget].imgheight/2),1==dragObj.mode?dots[curTarget].splice(dragObj.num,1):2==dragObj.mode?odots[curTarget].splice(dragObj.num,1):.5==dragObj.mode?lines[curTarget].splice(dragObj.num,1):0==dragObj.mode?lines[curTarget][dragObj.num][dragObj.subnum]=oldpointpos:5<=dragObj.mode&&dragObj.mode<10?(tplines[curTarget].splice(dragObj.num,1),tptypes[curTarget].splice(dragObj.num,1),curTPcurve=null):10<=dragObj.mode&&dragObj.mode<11&&(ineqlines[curTarget].splice(dragObj.num,1),ineqtypes[curTarget].splice(dragObj.num,1),curIneqcurve=null),dragObj=null,drawTarget())),didMultiTouch=!1,hasTouch?hasTouchTimer=window.setTimeout(function(){hasTouch=!1,clearAllDrawListners(),$(document).on("mousemove.imathasdraw",drawMouseMove),$(".drawcanvas").on("touchstart.imathasdraw",function(e){hasTouch=!0,drawMouseDown(e)}),$(document).on("mousedown.imathasdraw",drawMouseDown)},350):(clearAllDrawListners(),$(document).on("mousemove.imathasdraw",drawMouseMove),$(".drawcanvas").on("touchstart.imathasdraw",function(e){hasTouch=!0,drawMouseDown(e)}),$(document).on("mousedown.imathasdraw",drawMouseDown))}function drawMouseMove(e){var t,r,n,a,s,u=null;for(i in clickmightbenewcurve=!1,t=mouseCoords(e),targets)if(!$(targets[i].el).is(":hidden")&&"canvas"==targets[i].type&&(r=getPosition(targets[i].el)).x<t.x&&r.x+targets[i].width>t.x&&r.y<t.y&&r.y+targets[i].height>t.y&&e.target==targets[i].el){u=i;break}if(null!=u){if(targetOuts[u].disabled)return;r=getPosition(targets[mouseintarget=u].el),n={x:t.x-r.x,y:t.y-r.y},0<targets[u].snaptogridx&&(n=snaptogrid(n,u)),1==drawlocky[u]&&(n.y=targets[u].imgheight/2),-1<n.x&&n.x<targets[u].width&&-1<n.y&&n.y<targets[u].height&&null==dragObj&&null==curLine&&(null==(a=findnearpoint(u,n))?setCursor("pen",u):-1!=targets[u].mode&&setCursor("move",u))}else null!=mouseintarget&&-1!=mouseintarget&&(null!=curTarget?drawTarget():(curTarget=mouseintarget,drawTarget(),curTarget=null),mouseintarget=-1);if(null!=curTarget){if(e.originalEvent.touches&&1<e.originalEvent.touches.length)return didMultiTouch=!0;if(void 0!==e&&e.preventDefault(),r=getPosition(targets[curTarget].el),n={x:t.x-r.x,y:t.y-r.y},0<targets[curTarget].snaptogridx&&(n=snaptogrid(n,curTarget)),1==drawlocky[curTarget]&&(n.y=targets[curTarget].imgheight/2),-1<n.x&&n.x<targets[curTarget].width&&-1<n.y&&n.y<targets[curTarget].height){if(null==dragObj){if(mouseisdown&&-1==targets[curTarget].mode)return void(null!=(a=findnearpoint(curTarget,n))&&deleteCurve(a[0],a[1]));null!=curLine?!mouseisdown||0!=targets[curTarget].mode&&.7!=targets[curTarget].mode?mouseisdown&&.5==targets[curTarget].mode?0==(s=lines[curTarget][curLine].length-1)?25<Math.pow(lines[curTarget][curLine][s][0]-n.x,2)+Math.pow(lines[curTarget][curLine][s][1]-n.y,2)?(lines[curTarget][curLine].push([n.x,n.y]),drawTarget()):drawTarget(n.x,n.y):(lines[curTarget][curLine][s]=[n.x,n.y],drawTarget()):drawTarget(n.x,n.y):(s=lines[curTarget][curLine].length-1,25<Math.pow(lines[curTarget][curLine][s][0]-n.x,2)+Math.pow(lines[curTarget][curLine][s][1]-n.y,2)?(lines[curTarget][curLine].push([n.x,n.y]),drawTarget()):drawTarget(n.x,n.y)):null!=curTPcurve||null!=curIneqcurve?mouseisdown?drawTarget():drawTarget(n.x,n.y):null==(a=findnearpoint(curTarget,n))?(setCursor("pen"),tpHasAsymp.hasOwnProperty(targets[curTarget].mode)&&null!==u&&drawTarget(n.x,n.y)):(drawTarget(),-1!=targets[curTarget].mode&&setCursor("move"))}else setCursor("move"),0==dragObj.mode||.5==dragObj.mode?lines[curTarget][dragObj.num][dragObj.subnum]=[n.x,n.y]:1==dragObj.mode?dots[curTarget][dragObj.num]=[n.x,n.y]:2==dragObj.mode?odots[curTarget][dragObj.num]=[n.x,n.y]:5<=dragObj.mode&&dragObj.mode<10?tplines[curTarget][dragObj.num][dragObj.subnum]=[n.x,n.y]:10<=dragObj.mode&&dragObj.mode<11&&(ineqlines[curTarget][dragObj.num][dragObj.subnum]=[n.x,n.y]),drawTarget();return!1}null==curIneqcurve||mouseisdown||drawTarget()}else null!=u&&-1!=mouseintarget&&(curTarget=u,tpHasAsymp.hasOwnProperty(targets[curTarget].mode)&&drawTarget(n.x,n.y),curTarget=null)}function setCursor(e,t){targets[t=t||curTarget].cursor!=e&&(targets[t].el.style.cursor="move"==e?e:"url("+staticroot+"/img/"+e+".cur), auto",targets[t].cursor=e)}function mouseCoords(e){var t,r,n;return e=e||window.event,hasTouch?{x:(n=e.originalEvent.changedTouches[0]||e.originalEvent.touches[0]).pageX,y:n.pageY}:e.pageX||e.pageY?{x:e.pageX,y:e.pageY}:(n=document.documentElement,t=document.body,n=n&&(n.scrollTop||n.scrollLeft)?(r=n.scrollLeft,n.scrollTop):t?(r=t.scrollLeft,t.scrollTop):r=0,{x:e.clientX+r,y:e.clientY+n})}function snaptogrid(e,t){var r=e.x-targets[t].imgborder+targets[t].xmin*targets[t].pixperx,e=e.y-targets[t].imgborder-targets[t].ymax*targets[t].pixpery;return{x:Math.round(Math.round(r/(targets[t].pixperx*targets[t].snaptogridx))*targets[t].pixperx*targets[t].snaptogridx+targets[t].imgborder-targets[t].xmin*targets[t].pixperx),y:Math.round(Math.round(e/(targets[t].pixpery*targets[t].snaptogridy))*targets[t].pixpery*targets[t].snaptogridy+targets[t].imgborder+targets[t].ymax*targets[t].pixpery)}}function getMouseOffset(e,t){e=getPosition(e),t=mouseCoords(t);return{x:t.x-e.x,y:t.y-e.y}}function getPosition(e){return e.className.match(/hidden/)?{x:-1e4,y:-1e4}:{x:(e=$(e).offset()).left,y:e.top}}function clearAllDrawListners(){$(document).off("mousedown.imathasdraw").off("mousemove.imathasdraw").off("mouseup.imathasdraw"),$(document).off("touchstart.imathasdraw").off("touchmove.imathasdraw").off("touchend.imathasdraw").off("touchcancel.imathasdraw"),$(".drawcanvas").off("touchstart.imathasdraw").off("touchmove.imathasdraw").off("touchend.imathasdraw").off("touchcancel.imathasdraw")}function initCanvases(e){var t,r,n,a,i;clearAllDrawListners(),$(document).on("mousemove.imathasdraw",drawMouseMove),$(".drawcanvas").on("touchstart.imathasdraw",function(e){hasTouch=!0,drawMouseDown(e)}),$(document).on("mousedown.imathasdraw",drawMouseDown);try{CanvasRenderingContext2D.prototype.dashedLine=function(e,t,r,n,a){var i,s,u,g,l,o;for(null==a&&(a=10),this.beginPath(),this.moveTo(e,t),s=n-t,g=(i=r-e)/(u=Math.sqrt(i*i+s*s)/a),l=s/u,u=Math.floor(u),o=0;o++<u&&-1<t&&t<targets[curTarget].imgheight+1&&-1<e&&e<targets[curTarget].imgwidth+1;)this[o%2==0?"moveTo":"lineTo"](e+=g,t+=l);this[o%2==0?"moveTo":"lineTo"](r,n),this.stroke(),this.closePath()}}catch(e){}for(t in canvases)if(void 0===e||e==t){if((r=null)!=drawla[t]&&2<drawla[t].length){if(lines[canvases[t][0]]=drawla[t][0],dots[canvases[t][0]]=drawla[t][1],odots[canvases[t][0]]=drawla[t][2],tptypes[canvases[t][0]]=[],tplines[canvases[t][0]]=[],3<drawla[t].length&&0<drawla[t][3].length)for(n=0;n<drawla[t][3].length;n++)for(tptypes[canvases[t][0]][n]=drawla[t][3][n][0],tplines[canvases[t][0]][n]=[],a=0;a<tpModeN[tptypes[canvases[t][0]][n]];a++)tplines[canvases[t][0]][n].push(drawla[t][3][n].slice(1+2*a,3+2*a));if(ineqtypes[canvases[t][0]]=[],ineqlines[canvases[t][0]]=[],4<drawla[t].length&&0<drawla[t][4].length)for(n=0;n<drawla[t][4].length;n++)ineqtypes[canvases[t][0]][n]=drawla[t][4][n][0],ineqlines[canvases[t][0]][n]=[drawla[t][4][n].slice(1,3),drawla[t][4][n].slice(3,5),drawla[t][4][n].slice(5)];5<drawla[t].length&&(r=drawla[t][5])}else null!=drawla[t]&&"[[]]"==JSON.stringify(drawla[t])&&clearcanvas(canvases[t][0],!0);i="",canvases[t][1].match(/initPicture/)?i=canvases[t][1]:""!==canvases[t][1]&&(i=imasroot+"/filter/graph/imgs/"+canvases[t][1]),""!==canvases[t][13]?addA11yTarget(canvases[t],r,i):addTarget(canvases[t][0],"canvas"+canvases[t][0],i,"qn"+canvases[t][0],canvases[t][2],canvases[t][3],canvases[t][4],canvases[t][5],canvases[t][6],canvases[t][7],canvases[t][8],canvases[t][9],canvases[t][10],canvases[t][11],canvases[t][12])}}function addnormslider(e,t){(-1!=arraysearch(e,normslider.idnums)||(normslider.idnums.push(e),!0===t))&&slideronpageload(e)}function slideronpageload(e){for(var t,r=0;r<normslider.idnums.length;r++)void 0!==e&&e!=normslider.idnums[r]||(initnormslider(t=normslider.idnums[r]),$("#slid1"+t).on("touchstart.normslider mousedown.normslider",onsliderstart),$("#slid2"+t).on("touchstart.normslider mousedown.normslider",onsliderstart))}function initnormslider(e){var t,r,n,a=document.getElementById("qn"+e).value,a=(n=a.match(/\(-oo,([\-\d\.]+)\)U\(([\-\d\.]+),oo\)/))?(t=3,r=n[1],n[2]):(n=a.match(/\(-oo,([\-\d\.]+)\)/))?(t=0,r=n[1],2.5):(n=a.match(/\(([\-\d\.]+),oo\)/))?(r=n[t=1],2.5):(n=a.match(/\(([\-\d\.]+),([\-\d\.]+)\)/))?(r=n[1],n[t=2]):(t=0,r=-1.5,2.5);document.getElementById("slid1"+e).style.left=60*r+250-6+"px",document.getElementById("slid2"+e).style.left=60*a+250-6+"px",document.getElementById("shaderegions"+e).selectedIndex=t,normslider.curslider.type=document.getElementById("shaderegions"+e).value,chgnormtype(e)}function onsliderstart(e){(e=e||window.event).originalEvent.touches&&0<e.originalEvent.touches.length?(hasTouch=!0,$(document).on("touchmove.normslider",onsliderchange),$(document).on("touchend.normslider",onsliderstop)):($(document).on("mousemove.normslider",onsliderchange),$(document).on("mouseup.normslider",onsliderstop)),normslider.curslider.el=e.target||e.srcElement,normslider.curslider.id=normslider.curslider.el.id.substring(5),normslider.curslider.type=document.getElementById("shaderegions"+normslider.curslider.id).value,normslider.curslider.outnode=document.getElementById(normslider.outputid),normslider.curslider.startpos=getMouseOffset(normslider.curslider.el,e),normslider.curslider.el.parentNode.style.cursor="pointer";getPosition(normslider.curslider.el.parentNode);return e.preventDefault&&e.preventDefault(),!1}function onsliderchange(e){var t,r=normslider.curslider.id;if(e=e||window.event,!((t=getMouseOffset(normslider.curslider.el.parentNode,e)).x<5||t.x>normslider.curslider.el.parentNode.offsetWidth-5||t.y<5||t.y>normslider.curslider.el.parentNode.offsetHeight-5))return t=6*Math.round((t.x-normslider.curslider.startpos.x-10)/6)+10,normslider.curslider.el.style.left=t+"px",normupdatevalues(r),e.preventDefault&&e.preventDefault(),!1}function onsliderstop(e){null!==normslider.curslider.el&&(hasTouch=!1,$(document).off("touchmove.normslider touchend.normslider"),$(document).off("mousemove.normslider mouseup.normslider"),normslider.curslider.el.parentNode.style.cursor="",normslider.curslider.el=null)}function normupdatevalues(e){var t,r,n=parseInt(document.getElementById("slid1"+e).style.left)+6,a=parseInt(document.getElementById("slid2"+e).style.left)+6,i=Math.min(n,a),s=Math.max(n,a);"2O"==normslider.curslider.type?document.getElementById("normleft"+e).style.width=i+1+"px":"1L"==normslider.curslider.type?document.getElementById("normleft"+e).style.width=n+1+"px":"2B"==normslider.curslider.type&&(document.getElementById("normleft"+e).style.left=i+"px",document.getElementById("normleft"+e).style.width=s-i+1+"px"),"2O"==normslider.curslider.type?document.getElementById("normright"+e).style.width=500-s+"px":"1R"==normslider.curslider.type&&(document.getElementById("normright"+e).style.width=500-n+"px"),i=((n-10)/60-4).toFixed(1),s=((a-10)/60-4).toFixed(1),(t=document.getElementById("slid1txt"+e)).innerHTML=i,t.style.left=n-6+"px",(t=document.getElementById("slid2txt"+e)).innerHTML=s,t.style.left=a-6+"px",n=Math.min(i,s),t=Math.max(i,s),"2O"==normslider.curslider.type?r="(-oo,"+n+")U("+t+",oo)":"2B"==normslider.curslider.type?r="("+n+","+t+")":"1L"==normslider.curslider.type?r="(-oo,"+i+")":"1R"==normslider.curslider.type&&(r="("+i+",oo)"),document.getElementById("qn"+e).value=r,$("#qn"+e).trigger("input").trigger("change")}function chgnormtype(e){var t,r,n,a=document.getElementById("shaderegions"+e).value;normslider.curslider.type=a,t=parseInt(document.getElementById("slid1"+e).style.left)+6,n=parseInt(document.getElementById("slid2"+e).style.left)+6,r=Math.min(t,n),n=Math.max(t,n),"1R"==a||"1L"==a?(document.getElementById("slid2"+e).style.display="none",document.getElementById("slid2txt"+e).style.display="none","1R"==a?(document.getElementById("normleft"+e).style.display="none",document.getElementById("normright"+e).style.display="",document.getElementById("normright"+e).style.right="0px",document.getElementById("normright"+e).style.width=500-t+"px"):(document.getElementById("normright"+e).style.display="none",document.getElementById("normleft"+e).style.display="",document.getElementById("normleft"+e).style.left="0px",document.getElementById("normleft"+e).style.width=t+"px")):"2O"==a?(document.getElementById("slid2"+e).style.display="",document.getElementById("slid2txt"+e).style.display="",document.getElementById("normleft"+e).style.display="",document.getElementById("normright"+e).style.display="",document.getElementById("normright"+e).style.right="0px",document.getElementById("normleft"+e).style.left="0px",document.getElementById("normright"+e).style.width=500-n+"px",document.getElementById("normleft"+e).style.width=r+"px"):"2B"==a&&(document.getElementById("slid2"+e).style.display="",document.getElementById("slid2txt"+e).style.display="",document.getElementById("normleft"+e).style.display="",document.getElementById("normright"+e).style.display="none",document.getElementById("normleft"+e).style.left=r+"px",document.getElementById("normleft"+e).style.width=n-r+"px"),normupdatevalues(e)}function dashedParabola(e,t,r,n,a,i,s){var u,g,l,o,c,d,T,p,h;if(a==r)e.moveTo(0,a),e.dashedLine(0,a,i,a);else{for(l=0,o=(u=(a-r)/((n-t)*(n-t)))*t*t+r-(l=r<a?s:l),c=(-(g=-2*u*t)-(n=Math.sqrt(g*g-4*u*o)))/(2*u),o+=l,(d=(-g+n)/(2*u))<c&&(a=c,c=d,d=a),T=t,p=r,h=0;c-5<T&&-5<T;)h%2==0?e.moveTo(T,p):e.lineTo(T,p),p=u*(T-=Math.min(Math.sqrt(64/(1+Math.pow(2*u*(T-t),2))),Math.sqrt(8/Math.abs(u))))*T+g*T+o,h++;for(T=t,p=r,h=0;T<d+5&&T<i+5;)h%2==0?e.moveTo(T,p):e.lineTo(T,p),p=u*(T+=Math.min(Math.sqrt(64/(1+Math.pow(2*u*(T-t),2))),Math.sqrt(8/Math.abs(u))))*T+g*T+o,h++}e.stroke()}function shadeParabola(e,t,r,n,a,i,s,u,g){var l,o,c,d,T,p;e.beginPath(),a==r?(e.moveTo(0,a),e.lineTo(u,a),s<r?(e.lineTo(u,0),e.lineTo(0,0)):(e.lineTo(u,g),e.lineTo(0,g))):(o=0,r=(n=(a-r)/((n-t)*(n-t)))*t*t+r-(o=r<a?g:o),o=n*(l=(-(a=-2*n*t)-(c=Math.sqrt(a*a-4*n*r)))/(2*n))*l+a*l+(r+=o),(c=(-a+c)/(2*n))<l&&(T=l,l=c,c=T),T=(T=2*n*(l-t))*(d=((p=(t=o)-T*l)-(t-(d=-T)*c))/(d-T))+p,n<0&&s<n*i*i+a*i+r||0<n&&n*i*i+a*i+r<s?(e.moveTo(l,o),e.quadraticCurveTo(d,T,c,t)):(p=g,Math.abs(o-g)<2&&(p=0),e.moveTo(0,o),e.lineTo(l,o),e.quadraticCurveTo(d,T,c,t),e.lineTo(u,t),e.lineTo(u,p),e.lineTo(0,p))),e.closePath()}return mouseisdown=!1,targets=new Array,imgs=new Array,targetOuts=new Array,lines=new Array,dots=new Array,odots=new Array,tplines=new Array,tptypes=new Array,ineqlines=new Array,ineqtypes=new Array,curLine=null,drawstyle=[],drawlocky=[],curTPcurve=null,curIneqcurve=null,ineqcolors=["rgb(0,0,255)","rgb(255,0,0)","rgb(0,255,0)"],ineqacolors=["rgba(0,0,255,.4)","rgba(255,0,0,.4)","rgba(0,255,0,.4)"],asymcolor="rgb(0,200,0)",dragObj=null,oldpointpos=null,curTarget=null,curCursor=null,nocanvaswarning=!1,hasTouch=!1,didMultiTouch=!1,clickmightbenewcurve=!1,hasTouchTimer=null,tpModeN={5:2,5.2:2,5.3:2,5.4:2,6:2,6.1:2,6.2:2,6.3:2,6.5:2,6.6:2,7:2,7.2:2,7.4:2,7.5:2,8:2,8.2:2,8.3:2,8.4:2,8.5:3,8.6:3,9:2,9.1:2,10:3,10.2:3,10.3:3,10.4:3},tpHasAsymp={7.4:1,7.5:1,8.2:1,8.5:1,8.6:1},clickcnt=0,lastdrawmouseup=null,mouseintarget=-1,"undefined"!=typeof initstack?initstack.push(initCanvases):$(function(){initCanvases()}),normslider={idnums:[],curslider:{el:null,startpos:[0,0],outnode:null}},"undefined"!=typeof initstack&&initstack.push(slideronpageload),drawexport={reset:reset,initCanvases:initCanvases,clearcanvas:clearcanvas,clearlastline:clearlastline,settool:settool,addnormslider:addnormslider,chgnormtype:chgnormtype,adda11ydraw:adda11ydraw,changea11ydraw:changea11ydraw,encodea11ydraw:encodea11ydraw,updatea11ydraw:updatea11ydraw,removea11ydraw:removea11ydraw},drawexport}(jQuery);!function(){"use strict";function n(e,t){var r=e.length-1,n=[e[0]];return function e(t,r,n,a,i){for(var s,u,g,l,o,c,d,T,p=a,h=r+1;h<n;h++)u=t[h],g=t[r],l=t[n],T=d=c=o=void 0,c=g[0],g=g[1],d=l[0]-c,T=l[1]-g,0==d&&0==T||(1<(o=((u[0]-c)*d+(u[1]-g)*T)/(d*d+T*T))?(c=l[0],g=l[1]):0<o&&(c+=d*o,g+=T*o)),p<(l=(d=u[0]-c)*d+(T=u[1]-g)*T)&&(s=h,p=l);a<p&&(1<s-r&&e(t,r,s,a,i),i.push(t[s]),1<n-s)&&e(t,s,n,a,i)}(e,0,r,t,n),n.push(e[r]),n}window.pathsimplify=function(e,t,r){return e.length<=2||(t=void 0!==t?t*t:1,e=n(e=r?e:function(e,t){for(var r,n,a,i,s=e[0],u=[s],g=1,l=e.length;g<l;g++)r=e[g],a=s,i=void 0,i=(n=r)[0]-a[0],n=n[1]-a[1],t<i*i+n*n&&(u.push(r),s=r);return s!==r&&u.push(r),u}(e,t),t)),e}}();
var initstack,loadedscripts,scriptqueue,processingscriptsqueue,callbackstack,imathasAssess,seqgroupcollapsed,AutoSuggestIdCounter,autoSuggestLists,autoSuggestObjects;function prepWithMath(e){return e=(e=(e=e.replace(/\b(abs|acos|asin|atan|ceil|floor|cos|sin|tan|sqrt|exp|max|min|pow)\(/g,"Math.$1(")).replace(/\(E\)/g,"(Math.E)")).replace(/\((PI|pi)\)/g,"(Math.PI)")}function toggleinlinebtn(e,t){var t=document.getElementById(t),e=document.getElementById(e);"none"==e.style.display?(e.style.display="",e.setAttribute("aria-hidden",!1),t.setAttribute("aria-expanded",!0)):(e.style.display="none",e.setAttribute("aria-hidden",!0),t.setAttribute("aria-expanded",!1)),e=t.innerHTML,t.innerHTML=e.match(/\[\+\]/)?e.replace(/\[\+\]/,"[-]"):e.replace(/\[\-\]/,"[+]")}function setupSeqPartToggles(e){var t,a,r;if(e.id&&e.id.match(/questionwrap/)&&(t=parseInt(e.id.substr(12)),a=$(e).find(".seqsep"),seqgroupcollapsed[t]&&1!=a.length||(seqgroupcollapsed[t]={}),1<a.length))for(r=0;r<a.length-1;r++)$(a[r]).next().attr("id","seqgrp"+t+"-"+r),seqgroupcollapsed[t][r]&&$(a[r]).next().hide(),$(a[r]).prepend($("<button>",{class:"plain slim",style:"color: inherit","aria-expanded":!seqgroupcollapsed[t][r],"aria-controls":"seqgrp"+t+"-"+r,"aria-label":seqgroupcollapsed[t][r]?_("Expand"):_("Collapse"),html:seqgroupcollapsed[t][r]?"&#x25B6;":"&#x25BC;",type:"button",click:function(e){var t="true"==this.getAttribute("aria-expanded"),a=this.getAttribute("aria-controls");t?(this.setAttribute("aria-expanded","false"),this.setAttribute("aria-label",_("Expand")),this.innerHTML="&#x25B6;"):(this.setAttribute("aria-expanded","true"),this.setAttribute("aria-label",_("Collapse")),this.innerHTML="&#x25BC;"),$("#"+a).slideToggle(300),a=a.substr(6).split("-"),seqgroupcollapsed[a[0]][a[1]]=t}}))}function AutoSuggest(e,t){var n=this;this.elem=e,this.suggestions=t,this.eligible=new Array,this.inputText=null,this.highlighted=-1,this.div=document.getElementById("autosuggest"),null==this.div&&(this.div=document.createElement("div"),this.div.id="autosuggest",document.getElementsByTagName("body")[0].appendChild(this.div),this.div.appendChild(document.createElement("ul"))),e.setAttribute("autocomplete","off"),e.id||(t="autosuggest"+AutoSuggestIdCounter,AutoSuggestIdCounter++,e.id=t),e.onkeydown=function(e){var t=n.getKeyCode(e);switch(t){case 9:n.useSuggestion("tab");break;case 13:return-1<n.highlighted&&e.stopImmediatePropagation(),n.useSuggestion("enter"),!1;case 27:n.hideDiv();break;case 38:0<n.highlighted&&n.highlighted--,n.changeHighlight(t);break;case 40:n.highlighted<n.eligible.length-1&&n.highlighted++,n.changeHighlight(t)}},e.onkeyup=function(e){switch(n.getKeyCode(e)){case 9:case 27:case 38:case 40:return;default:1<this.value.length?(n.inputText=this.value,n.getEligible(),0<n.eligible.length?n.highlighted=0:n.highlighted=-1,n.createDiv(),n.positionDiv(),n.showDiv()):(n.hideDiv(),0==this.value.length&&(n.inputText=""))}},e.onblur=function(e){n.hideDiv()},this.useSuggestion=function(e){-1<this.highlighted&&(this.elem.value=this.eligible[this.highlighted]),this.hideDiv()},this.showDiv=function(){this.div.style.display="block"},this.hideDiv=function(){n.div.style.display="none",n.highlighted=-1},this.changeHighlight=function(){var e,t=this.div.getElementsByTagName("LI");for(i in t)e=t[i],this.highlighted==i?e.className="selected":e.className=""},this.positionDiv=function(){var e=this.elem,t=findPos(e);t[1]+=e.offsetHeight,this.div.style.left=t[0]+"px",this.div.style.top=t[1]+"px"},this.createDiv=function(){var e,t,a,r=document.createElement("ul");for(i in this.eligible)e=this.eligible[i],t=document.createElement("li"),(a=document.createElement("a")).href="#",a.onclick=function(){return!1},a.innerHTML=e,t.appendChild(a),n.highlighted==i&&(t.className="selected"),r.appendChild(t);this.div.replaceChild(r,this.div.childNodes[0]),this.setHighlight=function(e){for(var t,a=n.getEventSource(e);a.parentNode&&"LI"!=a.tagName.toUpperCase();)a=a.parentNode;for(i in t=n.div.getElementsByTagName("LI"))if(t[i]==a){n.highlighted=i;break}n.changeHighlight()},r.onmouseover=n.setHighlight,r.onmousedown=r.ontouchstart=function(e){return n.setHighlight(e),n.useSuggestion("click"),n.hideDiv(),n.cancelEvent(e),!1},this.div.className="suggestion_list",this.div.style.position="absolute"},this.getEligible=function(){var e,t;if(this.eligible=new Array,-1==this.inputText.indexOf(" "))for(i in e=new RegExp("\\b"+this.inputText.toLowerCase()),this.suggestions)(t=this.suggestions[i]).toLowerCase().match(e)&&(this.eligible[this.eligible.length]=t,i)},this.getKeyCode=function(e){return e?e.keyCode:window.event?window.event.keyCode:void 0},this.getEventSource=function(e){return e?e.target:window.event?window.event.srcElement:void 0},this.cancelEvent=function(e){e&&(e.preventDefault(),e.stopPropagation()),window.event&&(window.event.returnValue=!1)}}initstack=[],loadedscripts=[],scriptqueue=[],processingscriptsqueue=!1,callbackstack={},imathasAssess=function($){var allParams,allKekule,LivePreviews,MQsyntaxtimer,greekletters,onlyAscii;function clearparams(e){for(var t in e)delete allParams[t]}function toMQwVars(e,t){var a=t.substr(2).split(/-/)[0],r=allParams[a].qtype;return("numfunc"===r||"calcinterval"===r&&-1!=allParams[a].calcformat.indexOf("inequality"))&&(e=AMnumfuncPrepVar(a,e)[1]),AMtoMQ(e,t,!("matrix"===r||"calcmatrix"===r||"string"===r))}function fromMQwText(e,t){return e=(e=MQtoAM(e)).replace(/\(text\((.*?)\)\)/g,"($1)").replace(/text\((.*?)\)/g," $1 ")}function init(e,t,a){var r,i,n,s,l,c;for(r in MQeditor.setConfig({toMQ:toMQwVars,fromMQ:fromMQwText}),0==$("#arialive").length&&$("body").append($("<p>",{id:"arialive","aria-live":"assertive","aria-atomic":"true",class:"sr-only"})),e)if(!isNaN(parseInt(r))){if(allParams[r]=e[r],(i=e[r]).helper&&i.qtype.match(/^(calc|numfunc|string|interval|matrix|chemeqn)/)){if(!(s=document.getElementById("qn"+r))&&!i.matrixsize)continue;l=i.qtype,i.calcformat&&(l+=","+i.calcformat),i.displayformat&&(l+=","+i.displayformat),i.matrixsize?(l+=",matrixsized",$("input[id^=qn"+r+"-]").attr("data-mq",l)):(s.setAttribute("data-mq",l),i.vars&&s.setAttribute("data-mq-vars",i.vars)),t&&(i.matrixsize?MQeditor.toggleMQAll("input[id^=qn"+r+"-]",!0,!0):MQeditor.toggleMQ(s,!0,!0),$("#pbtn"+r).hide())}if(i.preview?(document.getElementById("pbtn"+r).addEventListener("click",function(e){return function(){showPreview(e)}}(r)),1!=i.preview||i.qtype.match(/matrix/)||(LivePreviews.hasOwnProperty(r)&&delete LivePreviews[r],setupLivePreview(r,t),document.getElementById("qn"+r).addEventListener("keyup",updateLivePreview),t&&showSyntaxCheckMQ(r))):i.matrixsize?$("input[id^=qn"+r+"-]").on("input",function(e){return function(){syntaxCheckMQ(e)}}(r)):document.getElementById("qn"+r)&&document.getElementById("qn"+r).addEventListener("keyup",function(e){return function(){syntaxCheckMQ(e)}}(r)),"debit"===i.format?document.getElementById("qn"+r).addEventListener("keyup",editdebit):"credit"===i.format?(document.getElementById("qn"+r).addEventListener("keyup",editcredit),initcreditboxes()):"normslider"===i.format&&imathasDraw.addnormslider(r,!0),i.autosuggest&&(!autoSuggestLists.hasOwnProperty(i.autosuggest)&&i.hasOwnProperty(i.autosuggest)&&(autoSuggestLists[i.autosuggest]=i[i.autosuggest]),autoSuggestLists.hasOwnProperty(i.autosuggest))&&(autoSuggestObjects[r]=new AutoSuggest(document.getElementById("qn"+r),autoSuggestLists[i.autosuggest])),i.tip)if(s=document.getElementById("qn"+r+"-0"))for(n=0;document.getElementById("qn"+r+"-"+n);)setupTips("qn"+r+"-"+n,i.tip,i.longtip),n++;else setupTips("qn"+r,i.tip,i.longtip);"draw"===i.qtype&&setupDraw(r),"file"===i.qtype&&initFileAlt(document.getElementById("qn"+r)),"multans"===i.qtype&&initMultAns(r),"molecule"===i.qtype&&initMolecule(r),i.usetinymce&&(document.getElementById("qn"+r).disabled&&!document.getElementById("tinyprev"+r)?(l=$("#qn"+r).val(),(c=$("<div>",{id:"tinyprev"+r,class:"introtext"})).html(l),$("#qn"+r).hide().after(c)):(c=null,i.nopaste&&(c={paste_preprocess:function(e,t){t.content=""}}),initeditor("selector","#qn"+r+".mceEditor",null,!1,function(e){e.on("blur",function(e){tinymce.triggerSave(),jQuery(e.target.targetElm).triggerHandler("change")}).on("focus",function(e){jQuery(e.target.targetElm).triggerHandler("focus")})},c))),"essay"==i.qtype&&$("#qnwrap"+r+".introtext img").on("click",rotateimg),initEnterHandler(r),$("input[id^=qn"+r+"]:not([type=file])").attr("maxlength",8e3)}if(initDupRubrics(),initShowAnswer2(),a&&setScoreMarkers(a),initqsclickchange(),initClearScoreMarkers(),e.scripts){for(n in e.scripts)"code"==e.scripts[n][0]?scriptqueue.push(e.scripts[n]):-1==loadedscripts.indexOf(e.scripts[n][1])&&(scriptqueue.push(e.scripts[n]),loadedscripts.push(e.scripts[n][1]));0<scriptqueue.length&&!1===processingscriptsqueue&&processScriptQueue()}}function processScriptQueue(){if(processingscriptsqueue=!0,0!=scriptqueue.length){var t=scriptqueue.shift();if("code"==t[0]){try{window.eval(t[1])}catch(e){console.log("Error executing question script:"+t[1])}processScriptQueueNext()}else jQuery.getScript(t[1]).always(function(){processScriptQueueNext()})}}function processScriptQueueNext(){for(var e=0;e<initstack.length;e++)initstack[e]();(initstack.length=0)==scriptqueue.length?processingscriptsqueue=!1:processScriptQueue()}function setupTips(e,t,a){var r,i=document.getElementById(e);i&&(i.setAttribute("data-tip",t),r=e.substr(2).split(/-/)[0],document.getElementById("tips"+r)||$("body").append($("<div>",{class:"hidden",id:"tips"+r}).html(a)),i.setAttribute("aria-describedby","tips"+r),i.addEventListener("focus",function(){showehdd(e,t,r)}),i.addEventListener("blur",hideeh),i.addEventListener("click",function(){reshrinkeh(e)}))}function clearTips(){hideAllEhTips()}function initqsclickchange(){$("input[id^=qs][value=spec]").each(function(e,t){$(t).siblings("input[type=text]").off("keyup.qsclickchange").on("keyup.qsclickchange",function(e){8!=e.keyCode&&46!=e.keyCode&&$(t).prop("checked",!0)})})}function clearScoreMarkers(e){var t,e=e.currentTarget;null!==(t=e.className.match(/(ansgrn|ansred|ansyel|ansorg)/))?($(e).removeClass(t[0]),$(e).nextAll(".scoremarker.sr-only").first().remove(),"ansorg"==t[0]&&$(e).nextAll(".scoremarker").first().remove(),"select"==e.tagName.toLowerCase()&&$(e).nextAll("svg.scoremarker").first().remove(),"hidden"==e.type&&$("#mqinput-"+e.id).removeClass(t[0])):0<(e=$(e).closest("[id^=qnwrap]")).length&&null!==(t=e[0].className.match(/(ansgrn|ansred|ansyel|ansorg)/))&&(e.removeClass(t[0]),e.find(".scoremarker").remove())}function setScoreMarkers(e){var t,a,r,i='<svg class="scoremarker" viewBox="0 0 24 24" width="16" height="16" stroke="green" stroke-width="3" fill="none" role="img" aria-hidden=true>';i=(i+='<polyline points="20 6 9 17 4 12"></polyline></svg>')+'<span class="sr-only scoremarker">'+_("Correct")+"</span>",t='<svg class="scoremarker" viewBox="0 0 24 24" width="16" height="16" stroke="rgb(255,187,0)" stroke-width="3" fill="none" role="img" aria-hidden=true>',t=(t+='<path d="M 5.3,10.6 9,14.2 18.5,4.6 21.4,7.4 9,19.8 2.7,13.5 z" /></svg>')+'<span class="sr-only scoremarker">'+_("Partially correct")+"</span>",a='<svg class="scoremarker" viewBox="0 0 24 24" width="16" height="16" stroke="rgb(153,0,0)" stroke-width="3" fill="none" role="img" aria-hidden=true>',a=(a+='<path d="M18 6 L6 18 M6 6 L18 18" /></svg>')+'<span class="sr-only scoremarker">'+_("Incorrect")+"</span>",r='<svg class="scoremarker" viewBox="0 0 24 24" width="16" height="16" stroke="rgb(255,85,0)" stroke-width="3" fill="none" role="img" aria-hidden=true>',r=(r+='<path d="M18 6 L6 18 M6 6 L18 18" /></svg>')+'<span class="sr-only scoremarker">'+_("Incorrect, wrong format")+"</span>",$(e).find(".scoremarker").remove(),$(e).find("div.ansgrn,table.ansgrn").append(i),$(e).find("div.ansyel,table.ansyel").append(t),$(e).find("div.ansred,table.ansred").append(a),$(e).find("div.ansorg,table.ansorg").append(r),$(e).find("select.ansgrn").after(i),$(e).find("select.ansyel").after(t),$(e).find("select.ansred").after(a),$(e).find("select.ansorg").after(r),$(e).find("span[id^=mqinput-].ansgrn,input[type=text].ansgrn").after('<span class="scoremarker sr-only">'+_("Correct")+"</span>"),$(e).find("span[id^=mqinput-].ansyel,input[type=text].ansyel").after('<span class="scoremarker sr-only">'+_("Partially correct")+"</span>"),$(e).find("span[id^=mqinput-].ansred,input[type=text].ansred").after('<span class="scoremarker sr-only">'+_("Incorrect")+"</span>"),$(e).find("span[id^=mqinput-].ansorg,input[type=text].ansorg").after('<span class="scoremarker sr-only">'+_("Incorrect, wrong format")+"</span>"),$(e).find("span[id^=mqinput-].ansorg,input[type=text].ansorg").after($("<span>",{role:"button",class:"scoremarker",tabindex:0,"aria-label":_("Incorrect, wrong format"),"data-tip":_("Your answer is equivalent to the correct answer, but is not simplified or is in the wrong format"),"data-tooltipclass":"dropdown-pane tooltip-pane"}).on("mouseover focus",function(){tipshow(this)}).on("mouseleave blur",tipout).html('<svg style="vertical-align:middle;margin-left:3px;" viewBox="0 0 24 24" width="18" height="18" stroke="rgb(255,85,0)" stroke-width="2" stroke-linecap="round" fill="none" role="img" aria-hidden=true><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12" y2="16"></line></svg>'))}function initClearScoreMarkers(){$("input[id^=qn]").off("input.clearmarkers").on("input.clearmarkers",clearScoreMarkers),$("input[id^=qs],select[id^=qn]").off("change.clearmarkers").on("change.clearmarkers",clearScoreMarkers)}function initEnterHandler(e){$("input[type=text][name=qn"+e+"]").off("keydown.enterhandler").on("keydown.enterhandler",function(e){var t;13==e.which&&(0<(t=$(this).closest(".questionwrap").find(".submitbtnwrap .primary")).length&&e.preventDefault(),t.is(":disabled")||t.trigger("click"))})}function handleMQenter(e){e=$("#"+e).closest(".questionwrap").find(".submitbtnwrap .primary");e.is(":disabled")||e.trigger("click")}function initDupRubrics(){$(".rubriclink").each(function(e,t){var a,r;$(t).removeClass("rubriclink"),-1!==(a=t.id.substring(16)).indexOf("-")&&(a=1e3*(+(r=a.split("-"))[0]+1)+ +r[1]),0<(r=$("#mqinput-qn"+a+",input[type=text]#qn"+a+",select#qn"+a+",textarea#qn"+a+",div.introtext#qnwrap"+a)).length&&(r.after(t),$(t).show())})}function initShowAnswer2(){$("input.sabtn + span.hidden, input.sabtn + div.hidden").each(function(e,t){var a,r=t.id.substring(3),i=r,n=-1!==i.indexOf("-")?(i=1e3*(+(n=i.split("-"))[0]+1)+ +n[1],_("Question ")+(+n[0]+1)+_(" Part ")+(+n[1]+1)):_("Question ")+(+i+1),n=$("<span>",{class:"keywrap"}).append($("<button>",{type:"button","aria-controls":"ans"+r,"aria-expanded":"false",class:"keybtn","aria-label":_("View Key for ")+n,title:_("View Key")}).on("click",function(e){var t="true"==e.currentTarget.getAttribute("aria-expanded");e.currentTarget.setAttribute("aria-expanded",t?"false":"true"),$("#ans"+r).toggleClass("hidden",t),t||$("#ans"+r).attr("tabindex","-1").focus()}).html('<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"></path></svg>'));if(0<$(t).closest(".autoshowans").length){if(0<(a=$("#qnwrap"+i)).length)return $(t).prev(".sabtn").remove(),n.append($(t)).addClass("inwrap"),void a.append(n);if(0<(a=$("#mqinput-qn"+i+",input[type=text]#qn"+i+",select#qn"+i+",textarea#qn"+i)).length)return $(t).prev(".sabtn").remove(),n.append($(t)),void a.after(n)}i=$(t).parent(),n.append($(t)),i.empty().append(n)}),$("input.dsbtn + div.hidden").attr("aria-hidden",!0).attr("aria-expanded",!1),$("input.dsbtn").each(function(){var e=$(this).siblings("div:first-of-type").attr("id");$(this).attr("aria-expanded",!1).attr("aria-controls",e).off("click.sashow").on("click.sashow",function(){var e="true"==$(this).attr("aria-expanded");$(this).attr("aria-expanded",!e).siblings("div:first-of-type").attr("aria-expanded",!e).attr("aria-hidden",e).toggleClass("hidden",e)})})}function initShowAnswer(){$("input.sabtn + span.hidden").attr("aria-hidden",!0).attr("aria-expanded",!1),$("input.sabtn").each(function(){var e=$(this).siblings("span:first-of-type").attr("id");$(this).attr("aria-expanded",!1).attr("aria-controls",e).off("click.sashow").on("click.sashow",function(){$(this).attr("aria-expanded",!0).siblings("span:first-of-type").attr("aria-expanded",!0).attr("aria-hidden",!1).removeClass("hidden")})}),$("input.dsbtn + div.hidden").attr("aria-hidden",!0).attr("aria-expanded",!1),$("input.dsbtn").each(function(){var e=$(this).siblings("div:first-of-type").attr("id");$(this).attr("aria-expanded",!1).attr("aria-controls",e).off("click.sashow").on("click.sashow",function(){$(this).attr("aria-expanded",!0).siblings("div:first-of-type").attr("aria-expanded",!0).attr("aria-hidden",!1).removeClass("hidden")})})}function setupDraw(e){for(var t,a=document.getElementById("qn"+e).value.split(";;"),r=[],i=0;i<a.length;i++)if(5==i?a[i]="["+a[i].replace(/&quot;/g,'"')+"]":(a[i]="["+a[i].replace(/\(/g,"[").replace(/\)/g,"]")+"]",0==i&&2<a[i].length&&(a[i]="["+a[i].replace(/;/g,"],[")+"]")),""===a[i])r[i]=[];else try{r[i]=JSON.parse(a[i])}catch(e){r[i]=[]}window.drawla[e]=r,window.canvases[e]=allParams[e].canvas,imathasDraw.initCanvases(e),(t=document.getElementById("drawtools"+e))&&t.addEventListener("click",function(e){var t,a,e=e.target;e.hasAttribute("data-drawaction")&&(a=e.getAttribute("data-drawaction"),t=e.getAttribute("data-qn"),"clearcanvas"===a?imathasDraw.clearcanvas(t):"settool"===a&&(a=e.getAttribute("data-val"),imathasDraw.settool(e,t,a)))}),$("#qn"+e).parent().find(".a11ydrawadd:not(.inited)").off("click.adda11ydraw").on("click.adda11ydraw",function(e){var t=e.target.getAttribute("data-qn");$(e.target).addClass("inited"),imathasDraw.adda11ydraw(t)})}function initMultAns(e){var t;"hasnone"==$("#qnwrap"+e).attr("data-multans")&&(t=$('input[name^="qn'+e+'["]')).on("change",function(){this.checked&&this.value==t.length-1?t.not(":last").prop("checked",!1):this.checked&&t.last().prop("checked",!1)})}function initMolecule(t){var e,a;"undefined"==typeof Kekule?(e=t,setTimeout(function(){initMolecule(e)}.bind(this),100)):(allKekule[t]=new Kekule.Editor.Composer(document.getElementById("chemdraw"+t)),allKekule[t].setEnableOperHistory(!0).setEnableLoadNewFile(!1).setEnableCreateNewDoc(!1).setAllowCreateNewChild(!1).setCommonToolButtons(["undo","redo","copy","cut","paste","zoomIn","reset","zoomOut"]).setChemToolButtons(["manipulate","erase","bond","atomAndFormula","ring","charge"]).setStyleToolComponentNames([]),allKekule[t].getEditor().on("editObjsUpdated",function(e){processMolecule(t)}),allParams[t].chemla&&(allKekule[t].setChemObj(Kekule.IO.loadFormatData(allParams[t].chemla,"cml")),window.setTimeout(function(){var e=allKekule[t].getEditor();e.scrollClientToObject(e.getChemObj().getChildren())},100)),(a=document.getElementById("chemsa"+t))&&new Kekule.ChemWidget.Viewer(a,null,Kekule.Render.RendererType.R2D).setEnableToolbar(!1).setPadding(20).setChemObj(Kekule.IO.loadFormatData(a.getAttribute("data-cmldata"),"cml")))}function isBlank(e){return!e||0===e.length||/^\s*$/.test(e)}function editdebit(e){var e=e.target,t=$(e).closest("tr").find("input").first();!isBlank(e.value)&&t.hasClass("iscredit")&&(t.css("padding-left"),t.is("select")?t.css("margin-right",20):t.width(""),t.css("padding-left",""),t.removeClass("iscredit"))}function editcredit(e){var e=e.target,t=$(e).closest("tr").find("input").first();isBlank(e.value)||t.hasClass("iscredit")||(e=parseInt(t.css("padding-left")),t.is("select")?t.css("margin-right",0):t.width(t.width()-20),t.css("padding-left",20+e),t.addClass("iscredit"))}function initcreditboxes(){$(".creditbox").each(function(e,t){editcredit({target:t})})}function setupLivePreview(r,e){var t,a;"MathJax"!=mathRenderer||window.MathJax&&(window.MathJax.Hub||window.MathJax.typesetPromise)?LivePreviews.hasOwnProperty(r)||("MathJax"==mathRenderer||"Katex"==mathRenderer?(LivePreviews[r]={delay:"MathJax"==mathRenderer?100:0,finaldelay:1e3,preview:null,buffer:null,timeout:null,finaltimeout:null,mjRunning:!1,mjPending:!1,oldText:null,mjPromise:null,Init:function(e){$("#p"+r).css("positive","relative").append('<span id="lpbuf1'+r+'" style="visibility:hidden;position:absolute;"></span>').append('<span id="lpbuf2'+r+'" style="visibility:hidden;position:absolute;"></span>'),this.preview=document.getElementById("lpbuf1"+r),this.buffer=document.getElementById("lpbuf2"+r),"MathJax"==mathRenderer&&MathJax.typesetPromise&&(this.mjPromise=Promise.resolve()),e||showPreview(r)},SwapBuffers:function(){var e=this.preview,t=this.buffer;this.buffer=e,this.preview=t,e.style.visibility="hidden",e.style.position="absolute",t.style.position="",t.style.visibility=""},Update:function(e){this.timeout&&clearTimeout(this.timeout),this.finaltimeout&&clearTimeout(this.finaltimeout),this.timeout=setTimeout(this.callback,this.delay),this.finaltimeout=setTimeout(this.DoFinalPreview,this.finaldelay)},RenderNow:function(e){this.oldtext=e,this.buffer.innerHTML=this.preformat(e),this.mjRunning=!0,this.RenderBuffer()},RenderBuffer:function(){"MathJax"==mathRenderer?MathJax.typesetPromise&&this.mjPromise?this.mjPromise=this.mjPromise.then(function(){MathJax.typesetPromise([this.buffer]).then(this.PreviewDone.bind(this))}.bind(this)):MathJax.Hub.Queue(["Typeset",MathJax.Hub,this.buffer],["PreviewDone",this]):"Katex"==mathRenderer&&(renderMathInElement(this.buffer),"undefined"!=typeof MathJax&&MathJax.Hub&&!MathJax.typesetPromise&&0<$(this.buffer).children(".mj").length?MathJax.Hub.Queue(["PreviewDone",this]):this.PreviewDone())},DoFinalPreview:function(){$("#pbtn"+r).trigger("click")},preformat:function(e){var t=allParams[r].qtype,a=allParams[r].calcformat;return preformat(r,e,t,a)},CreatePreview:function(){var e;this.timeout=null,this.mjPending||(e=document.getElementById("qn"+r).value)!==this.oldtext&&(this.mjRunning?(this.mjPending=!0,this.mjPromise?this.mjPromise=this.mjPromise.then(this.CreatePreview().bind(this)):MathJax.Hub&&MathJax.Hub.Queue(["CreatePreview",this])):(this.oldtext=e,this.buffer.innerHTML="`"+htmlEntities(this.preformat(e))+"`",this.mjRunning=!0,this.RenderBuffer()))},PreviewDone:function(){this.mjRunning=this.mjPending=!1,this.SwapBuffers(),updateehpos()}},"undefined"==typeof MathJax||MathJax.typesetPromise?LivePreviews[r].callback=function(){LivePreviews[r].CreatePreview()}:(LivePreviews[r].callback=MathJax.Callback(["CreatePreview",LivePreviews[r]]),LivePreviews[r].callback.autoReset=!0),LivePreviews[r].Init(e)):LivePreviews[r]={finaldelay:1e3,finaltimeout:null,Update:function(e){this.finaltimeout&&clearTimeout(this.finaltimeout),this.finaltimeout=setTimeout(this.DoFinalPreview,this.finaldelay)},RenderNow:function(e){var t=document.getElementById("p"+r);t.innerHTML=htmlEntities(e),rendermathnode(t)},DoFinalPreview:function(){$("#pbtn"+r).trigger("click")}}):(t=r,a=e,setTimeout(100,function(){setupLivePreview(t,a)}))}function updateLivePreview(e){e=e.target.id.substr(2);setupLivePreview(e),LivePreviews[e].Update()}function clearLivePreviewTimeouts(){for(var e in LivePreviews)clearTimeout(LivePreviews[e].finaltimeout)}function normalizemathunicode(e){return e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/[\x00-\x09\x0B\x0C\x0E-\x1F\x7F]/g,"")).replace(/\u2013|\u2014|\u2015|\u2212/g,"-")).replace(/\u2044|\u2215/g,"/")).replace(/∞/g,"oo").replace(/≤/g,"<=").replace(/≥/g,">=").replace(/∪/g,"U")).replace(/±/g,"+-").replace(/÷/g,"/").replace(/·|✕|×|⋅/g,"*")).replace(/√/g,"sqrt").replace(/∛/g,"root(3)")).replace(/⁰/g,"^0").replace(/¹/g,"^1").replace(/²/g,"^2").replace(/³/g,"^3").replace(/⁴/g,"^4").replace(/⁵/g,"^5").replace(/⁶/g,"^6").replace(/⁷/g,"^7").replace(/⁸/g,"^8").replace(/⁹/g,"^9")).replace(/\u2329/g,"<").replace(/\u232a/g,">")).replace(/₀/g,"_0").replace(/₁/g,"_1").replace(/₂/g,"_2").replace(/₃/g,"_3")).replace(/\b(OO|infty)\b/gi,"oo").replace(/°/g,"degree")).replace(/θ/g,"theta").replace(/ϕ/g,"phi").replace(/φ/g,"phi").replace(/π/g,"pi").replace(/σ/g,"sigma").replace(/μ/g,"mu")).replace(/α/g,"alpha").replace(/β/g,"beta").replace(/γ/g,"gamma").replace(/δ/g,"delta").replace(/ε/g,"epsilon").replace(/κ/g,"kappa")).replace(/λ/g,"lambda").replace(/ρ/g,"rho").replace(/τ/g,"tau").replace(/χ/g,"chi").replace(/ω/g,"omega")).replace(/Ω/g,"Omega").replace(/Γ/g,"Gamma").replace(/Φ/g,"Phi").replace(/Δ/g,"Delta").replace(/Σ/g,"Sigma")).replace(/&(ZeroWidthSpace|nbsp);/g," ").replace(/\u200B/g," ")).replace(/degree\s+s\b/g,"degree")).replace(/\(\((-?\d+)\)\)/g,"($1)")}function htmlEntities(e){return e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/&/g,"&amp;")}function showPreview(e){var t=allParams[e],a="",r=processByType(e);r.str&&(a="`"+htmlEntities(r.str)+"`"),r.dispvalstr&&""!=r.dispvalstr&&-1!=t.calcformat.indexOf("showval")&&(a+=(""==a?"":" = ")+"`"+htmlEntities(r.dispvalstr)+"`"),r.err&&""!=r.err&&""!=r.str&&(a+="``"==a?"":". <span class=noticetext>"+r.err+"</span>"),LivePreviews.hasOwnProperty(e)?LivePreviews[e].RenderNow(a):((t=document.getElementById("p"+e)).innerHTML=a,rendermathnode(t)),a11ypreview(a)}function a11ypreview(e){var t=$("<div>",{class:"inactive"}).html(e).appendTo("body")[0];rendermathnode(t,function(){var e=document.getElementById("arialive");e.innerHTML="",t.className="",$(t).find("[aria-label]").each(function(e,t){$(t).html($(t).attr("aria-label"))}),e.appendChild(t)})}function syntaxCheckMQ(e,t){clearTimeout(MQsyntaxtimer);var a=parseInt(e.replace(/.*qn(\d+)\b.*/g,"$1"));MQsyntaxtimer=setTimeout(function(){showSyntaxCheckMQ(a)},1e3)}function showSyntaxCheckMQ(e){var t,a=allParams[e],r=processByType(e),i="";r.dispvalstr&&""!=r.dispvalstr&&"NaN"!=r.dispvalstr&&a.calcformat&&-1!=a.calcformat.indexOf("showval")&&("calcmatrix"==a.qtype?i+=" = `"+htmlEntities(r.dispvalstr)+"` ":i+=" = "+htmlEntities(r.dispvalstr)+" "),r.err&&""!=r.err&&""!=r.str&&(i+="<span class=noticetext>"+r.err+"</span>"),!LivePreviews.hasOwnProperty(e)||"MathJax"!=mathRenderer&&"Katex"!=mathRenderer?(t=document.getElementById("p"+e))&&(t.innerHTML=i,rendermathnode(t)):((t=document.getElementById("p"+e).firstChild).innerHTML=i,t.style.visibility="",t.style.position=""),document.getElementById("qn"+e)?a11ypreview("`"+htmlEntities(document.getElementById("qn"+e).value)+"` "+i):a11ypreview(i)}function preSubmitForm(e){var t,a,r;for(a in allParams)!1!==(t=preSubmit(a))&&((r=document.getElementById("qn"+a+"-val"))?r.value=t:((r=document.createElement("input")).type="hidden",r.name="qn"+a+"-val",r.value=t,e.appendChild(r)))}function preSubmit(e){e=processByType(e);return e.submitstr||!1}function preSubmitString(e,t){var a,e=parseInt(e.substr(2));return t=allParams.hasOwnProperty(e)&&(a=allParams[e],t=(t=normalizemathunicode(t)).replace(/^\s+/,"").replace(/\s+$/,""),3e4<(t="numfunc"==a.qtype?AMnumfuncPrepVar(e,t)[3]:t).length)?t.substr(0,3e4):t}function processByType(e){var t,a,r,i;if(!allParams.hasOwnProperty(e))return!1;if(a={},"draw"==(t=allParams[e]).qtype)return imathasDraw.encodea11ydraw(),{};if("choices"==t.qtype||"multans"==t.qtype||"matching"==t.qtype)return{};if(t.hasOwnProperty("matrixsize"))a=processSizedMatrix(e);else{if("molecule"==t.qtype)return processMolecule(e),{};if(!(r=document.getElementById("qn"+e)))return!1;if((i=(i=normalizemathunicode(i=r.value)).replace(/^\s+/,"").replace(/\s+$/,"")).match(/^\s*$/))return{str:"",displvalstr:"",submitstr:""};if(i.match(/^\s*DNE\s*$/i))return{str:"DNE",displvalstr:"",submitstr:"DNE"};if(i.match(/^\s*oo\s*$/i))return{str:"oo",displvalstr:"",submitstr:"oo"};if(i.match(/^\s*\+oo\s*$/i))return{str:"+oo",displvalstr:"",submitstr:"+oo"};if(i.match(/^\s*-oo\s*$/i))return{str:"-oo",displvalstr:"",submitstr:"-oo"};switch(t.qtype){case"number":a=processNumber(i,t.calcformat);break;case"calculated":a=processCalculated(i,t.calcformat);break;case"interval":case"calcinterval":a=processCalcInterval(i,t.calcformat,t.vars);break;case"ntuple":case"calcntuple":a=processCalcNtuple(i,t.calcformat);break;case"complex":case"calccomplex":a=processCalcComplex(i,t.calcformat);break;case"calcmatrix":a=processCalcMatrix(i,t.calcformat);break;case"numfunc":a=processNumfunc(e,i,t.calcformat);break;case"matrix":a=processCalcMatrix(i,"decimal")}a.str=preformat(e,i,t.qtype,t.calcformat)}return a}function preformat(e,t,a,r){return t=normalizemathunicode(t),a.match(/interval/)?r.match(/inequality/)?(t=(t=AMnumfuncPrepVar(e,t)[1]).replace(/<=/g," le ").replace(/>=/g," ge ").replace(/</g," lt ").replace(/>/g," gt ")).match(/all\s*real/i)&&(t="text("+t+")"):t=t.replace(/U/g,"uu"):"numfunc"==a?t=AMnumfuncPrepVar(e,t)[1]:"calcntuple"==a?t=t.replace(/<+/g,"(:").replace(/>+/g,":)"):"calculated"==a&&(-1==r.indexOf("list")&&-1==r.indexOf("set")&&(t=t.replace(/(\d)\s*,\s*(?=\d{3}\b)/g,"$1")),-1!=r.indexOf("scinot"))&&(t=t.replace(/(x|X|\u00D7)/,"xx")),t=t.replace(/[^\u0000-\u007f]/g,"?")}function AMnumfuncPrepVar(e,t){var r,a,i,n,s,l,c,o,u,d,p="",h="string"==typeof allParams[e].vars?[allParams[e].vars]:allParams[e].vars.slice(),g=h.map(escapeRegExp).join("|");for(allParams[e].fvars&&(p=allParams[e].fvars.map(escapeRegExp).join("|")),h.push("DNE"),g.match(/lambda/)&&(t=t.replace(/lamda/,"lambda")),r=[],a=(a=t).replace(/(arcsinh|arccosh|arctanh|arcsech|arccsch|arccoth|argsinh|argcosh|argtanh|argsech|argcsch|argcoth|arsinh|arcosh|artanh|arsech|arcsch|arcoth|arcsin|arccos|arctan|arcsec|arccsc|arccot|sinh|cosh|tanh|sech|csch|coth|sqrt|ln|log|exp|sin|cos|tan|sec|csc|cot|abs|root|pi)/g,functoindex),t=t.replace(/(arcsinh|arccosh|arctanh|arcsech|arccsch|arccoth|argsinh|argcosh|argtanh|argsech|argcsch|argcoth|arsinh|arcosh|artanh|arsech|arcsch|arcoth|arcsin|arccos|arctan|arcsec|arccsc|arccot|sinh|cosh|tanh|sech|csch|coth|sqrt|ln|log|exp|sin|cos|tan|sec|csc|cot|abs|root|pi)/g,functoindex),i=0;i<h.length;i++)if(h[i].match(/\(.+\)/)&&(t=t.replace(/\(\((.*?)\)\)/g,"($1)")),"E"==h[i]||"e"==h[i])r[i]=!0;else for(r[i]=!1,n=0;n<h.length;n++)if(i!=n&&h[n].toLowerCase()==h[i].toLowerCase()&&h[n]!=h[i]){r[i]=!0;break}for(t=(t=t.replace(new RegExp("("+g+")","gi"),function(e,t){for(var a=0;a<h.length;a++)if(h[a]==t||!r[a]&&h[a].toLowerCase()==t.toLowerCase())return"@v"+a+"@";return t})).replace(/@v(\d+)@/g,function(e,t){return h[t]}),a=(a=(a=(a=(a=a.replace(new RegExp("("+g+")","gi"),function(e,t){for(var a=0;a<h.length;a++)if(h[a]==t||!r[a]&&h[a].toLowerCase()==t.toLowerCase())return"@v"+a+"@";return t})).replace(/(@v\d+@)(@v\d+@)/g,"$1 $2")).replace(/(@v\d+@)(@v\d+@)/g,"$1 $2")).replace(/(@v(\d+)@|\d+(\.\d+)?)!(?!=)/g,"{:$&:}")).replace(/@v(\d+)@/g,function(e,t){return h[t]}),s=t,l=new Array,i=0;i<h.length;i++)1<h[i].length&&(o=!1,-1!=greekletters.indexOf(h[i].toLowerCase())&&(o=!0),h[i].match(/^\w+_\w+$/)?(c=r[i]?"g":"gi",u=new RegExp(/^(\w+)_(\w+)$/,c).exec(h[i]),d=new RegExp(u[1]+"_\\("+u[2]+"\\)",c),a=a.replace(d,h[i]),t=t.replace(d,h[i]),s=(s=s.replace(new RegExp(u[0],c),u[1]+"_"+u[2])).replace(new RegExp(u[1]+"_\\("+u[2]+"\\)",c),u[1]+"_("+u[2]+")"),1<u[1].length&&-1==greekletters.indexOf(u[1].toLowerCase())&&(u[1]='"'+u[1]+'"'),1<u[2].length&&-1==greekletters.indexOf(u[2].toLowerCase())&&(u[2]='"'+u[2]+'"'),a=a.replace(new RegExp(u[0],c),u[1]+"_"+u[2]),t=t.replace(new RegExp(u[0],"g"),"repvars"+i),h[i]="repvars"+i):!o&&1<h[i].replace(/[^\w_]/g,"").length&&l.push(h[i]),h[i].match(/[^\w_]/)||h[i].match(/^(break|case|catch|continue|debugger|default|delete|do|else|finally|for|function|if|in|instanceof|new|return|switch|this|throw|try|typeof|var|void|while|and with)$/))&&(t=t.replace(new RegExp(escapeRegExp(h[i]),"g"),"repvars"+i),h[i]="repvars"+i);return 0<l.length&&(vltq=l.join("|"),e=new RegExp("("+vltq+")","g"),a=a.replace(e,'"$1"')),a=(a=a.replace(/(@\d+@)/g," $1")).replace(/@(\d+)@/g,indextofunc),t=t.replace(/@(\d+)@/g,indextofunc),s=s.replace(/@(\d+)@/g,indextofunc),g.match(/\bf\b/)&&!p.match(/\bf\b/)&&(a=(a=a.replace(/([^a-zA-Z])f\^([\d\.]+)([^\d\.])/g,"$1f^$2{::}$3")).replace(/([^a-zA-Z])f\(/g,"$1f{::}(")),[t,a=g.match(/\bg\b/)&&!p.match(/\bg\b/)?(a=a.replace(/([^a-zA-Z])g\^([\d\.]+)([^\d\.])/g,"$1g^$2{::}$3")).replace(/([^a-zA-Z])g\(/g,"$1g{::}("):a,h.join("|"),s]}function processNumber(e,t){var a,r,i,n,s,l,c,o,u,d,p,h,g,m,f="";for(e=e.replace(/^\s+|\s+$/g,""),-1!==t.indexOf("set")&&("{"!==e.charAt(0)||"}"!==e.substr(-1)?f+=_("Invalid set notation"):e=e.slice(1,-1)),a=-1!==t.indexOf("list")||-1!==t.indexOf("set")?e.split(/\s*,\s*/):[e.replace(/,/g,"")],i=0;i<a.length;i++)if(r=a[i],-1!=t.indexOf("units"))if(_("Units must be given as [decimal number]*[unit]^[power]*[unit]^[power].../[unit]^[power]*[unit]^[power]..."),r.match(/^\s*(-?\s*\d+\.?\d*|-?\s*\.\d+|-?\s*\d\.?\d*\s*(E|\*\s*10\s*\^)\s*[\-\+]?\d+)/)||(f+=_("Answer must start with a number. ")),r.match(/\b(sq|square|cu|cubic|squared|cubed)\s*\^\s*[\-\+]?\s*\d+/)&&(f+=_("Invalid base for exponent. "),r=r.replace(/\^/,"")),r.match(/\b(sq|square|cu|cubic)\s+per\b/)&&(f+=_('Missing unit before "per". '),r=r.replace(/per\b/,"")),r.match(/\bper\s+(squared|cubed)/)&&(f+=_('Missing unit after "per". '),r=r.replace(/\bper/,"")),(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=r.replace(/([a-zA-Z]\w*\s*)(\^\s*[\-\+]?\s*\d+\s*)(?:squared|cubed)\b/g,"$1")).replace(/(?:sq|square|cu|cubic)\s+([a-zA-Z]\w*)/g,"$1")).replace(/([a-zA-Z]\w*)\s+(?:squared|cubed)/g,"$1")).replace(/\sper\s/g,"/")).replace(/^\s*(-?\s*\d\.?\d*\s*(E|\*\s*10\s*\^)\s*[\-\+]?\d+|-?\s*\d+\.?\d*|-?\s*\.\d+)\s*[\-\*]?\s*/,"")).replace(/\s*\-\s*([a-zA-Z])/g,"*$1")).replace(/\*\*/g,"^")).replace(/\s*(\/|\^|\-)\s*/g,"$1")).replace(/\(\s*(.*?)\s*\)\s*\//,"$1/").replace(/\/\s*\(\s*(.*?)\s*\)/,"/$1")).replace(/\s*[\*\s]\s*/g,"*")).replace(/([a-zA-Z]\w*)\^[\-\+]?\d+/g,"$1")).match(/\^/)&&(f+=_("Invalid exponents. "),r=r.replace(/\^/g,"")),1<(r.match(/\//g)||[]).length&&(f+=_("Only one division symbol allowed in the units. ")),0<(r=r.replace(/\//g,"*").replace(/^\s*\*/,"").trim()).length)for(n="(yotta|zetta|exa|peta|tera|giga|mega|kilo|hecto|deka|deca|deci|centi|milli|micro|nano|pico|fempto|atto|zepto|yocto)",s="(Y|Z|E|P|T|G|M|k|h|da|d|c|m|u|n|p|f|a|z|y)",l=/^(m|meter|metre|micron|angstrom|fermi|in|inch|inches|ft|foot|feet|mi|mile|furlong|yd|yard|s|sec|second|min|minute|h|hr|hour|day|week|mo|month|yr|year|fortnight|acre|ha|hectare|b|barn|L|liter|litre|cc|gal|gallon|cup|pt|pint|qt|quart|tbsp|tablespoon|tsp|teaspoon|rad|radian|deg|degree|arcminute|arcsecond|grad|gradian|knot|kt|c|mph|kph|g|gram|gramme|t|tonne|Hz|hertz|rev|revolution|cycle|N|newton|kip|dyn|dyne|lb|pound|lbf|ton|J|joule|erg|lbft|ftlb|cal|calorie|eV|electronvolt|Wh|Btu|therm|W|watt|hp|horsepower|Pa|pascal|atm|atmosphere|bar|Torr|mmHg|umHg|cmWater|psi|ksi|Mpsi|C|coulomb|V|volt|farad|F|ohm|amp|ampere|A|T|tesla|G|gauss|Wb|weber|H|henry|lm|lumen|lx|lux|amu|dalton|Da|me|mol|mole|Ci|curie|R|roentgen|sr|steradian|Bq|becquerel|ls|lightsecond|ly|lightyear|AU|au|parsec|pc|solarmass|solarradius|degF|degC|degK|K)$/,c=new RegExp("^"+s+"?(m|ft|s|b|cc|g|t|N|dyn|J|cal|eV|Wh|W|hp|Pa|C|V|F|A|T|G|Wb|H|lm|lx|Da|mol|M|Ci|sr|Bq|ls|ly|pc)$"),o=new RegExp("^(inch|inches|lbft|ftlb|solarmass|solarradius)$","i"),u=new RegExp("^"+s+"?(L|Hz|Btu)$","i"),d=new RegExp("^"+n+"?(fermi|foot|feet|sec|hertz|horsepower|Torr|gauss|lux)$","i"),p=new RegExp("^(micron|mile|furlong|yard|minute|hour|day|week|month|year|fortnight|acre|hectare|gallon|cup|pint|quart|tablespoon|teaspoon|radian|degree|gradian|knot|revolution|cycle|kip|lb|therm|atmosphere|roentgen)s?$","i"),h=new RegExp("^"+n+"?(meter|metre|angstrom|second|barn|liter|litre|arcminute|arcsecond|gram|gramme|tonne|newton|dyne|pound|ton|joule|erg|calorie|electronvolt|watt|pascal|coulomb|volt|farad|ohm|amp|ampere|tesla|weber|henry|lumen|dalton|mole|curie|steradian|becquerel|lightsecond|lightyear|parsec)s?$","i"),g=r.split(/\s*\*\s*/),m=0;m<g.length;m++){let e=!1;!(unitsregexmatch=g[m].match(u))||3!=unitsregexmatch.length||new RegExp("^"+s+"$").test(unitsregexmatch[1])||(e=!0),(l.test(g[m])||c.test(g[m])||o.test(g[m])||u.test(g[m])||d.test(g[m])||p.test(g[m])||h.test(g[m]))&&!e||(f+=_("Unknown unit ")+'"'+g[m]+'". ')}else f+=_("Missing units");else-1!=t.indexOf("integer")?r.match(/^\s*\-?\d+\s*$/)||(f+=_("This is not an integer.")):r.match(/^\s*(\+|\-)?(\d+\.?\d*|\.\d+|\d*\.?\d*\s*E\s*[\-\+]?\d+)\s*$/)||(f+=_("This is not a decimal or integer value."));return{err:f,dispvalstr:e}}function processCalculated(e,t){var a,r,i,n,s;for(-1!=t.indexOf("allowplusminus")&&(e=e.replace(/(.*?)\+\-(.*?)(,|$)/g,"$1+$2,$1-$2$3")),a=-1!=t.indexOf("list")?e.split(/,/):-1!=t.indexOf("set")?e.replace(/[\{\}]/g,"").split(/,/):[e],r="",n=[],s=0;s<a.length;s++)r=(r=(r+=singlevalsyntaxcheck(str=a[s],t))+syntaxcheckexpr(str,t))+(i=singlevaleval(str,t))[1],n.push(i[0]);return e=n.join(", "),{err:r,dispvalstr:e=-1!=t.indexOf("set")?"{"+e+"}":e,submitstr:n.join(",")}}function processCalcInterval(e,t,a){var r,n,s,l,c,o,u,d,p,h,g;if(e=e.replace(/cup/g,"U"),-1!=t.indexOf("inequality")){if(1<(l=ineqtointerval(e=e.replace(/or/g," or "),a)).length)return{err:"wrongvar"==l[1]?_("you may have used the wrong variable"):_("invalid inequality notation")};e=l[0]}if(r=[],n=[],s=[],l="U",-1!=t.indexOf("list")){for(e=e.replace(/\s*,\s*/g,",").replace(/(^,|,$)/g,""),l=",",c=0,o=1;o<e.length-1;o++)","!=e.charAt(o)||")"!=e.charAt(o-1)&&"]"!=e.charAt(o-1)||"("!=e.charAt(o+1)&&"["!=e.charAt(o+1)||(r.push(e.substring(c,o)),c=o+1);r.push(e.substring(c))}else r=e.split(/\s*U\s*/i);for(u="",g=[],i=0;i<r.length;i++){if(d=r[i],sm=d.charAt(0),em=d.charAt(d.length-1),2!=(p=(p=d.substring(1,d.length-1)).split(/,/)).length||"("!=sm&&"["!=sm||")"!=em&&"]"!=em){-1!=t.indexOf("inequality")?u+=_("invalid inequality notation")+". ":u+=_("invalid interval notation")+". ";break}for(j=0;j<2;j++)-1!=t.indexOf("decimal")&&p[j].match(/[\d\.]e\-?\d/)&&(p[j]=p[j].replace(/e/,"E")),u=(u+=singlevalsyntaxcheck(p[j],t))+syntaxcheckexpr(p[j],t),p[j].match(/^\s*\-?\+?oo\s*$/)?g[j]=p[j]:(u+=(h=singlevaleval(p[j],t))[1],g[j]=h[0]);n[i]=sm+g[0]+","+g[1]+em,-1!=t.indexOf("inequality")&&(g[0].toString().match(/oo/)?g[1].toString().match(/oo/)?s[i]="RR":s[i]=a+("]"==em?"le":"lt")+g[1]:g[1].toString().match(/oo/)?s[i]=a+("["==sm?"ge":"gt")+g[0]:s[i]=g[0]+("["==sm?"le":"lt")+a+("]"==em?"le":"lt")+g[1])}return-1!=t.indexOf("inequality")?{err:u,dispvalstr:s.join(' "or" '),submitstr:n.join(l)}:{err:u,dispvalstr:n.join(" uu "),submitstr:n.join(l)}}function processCalcNtuple(e,t){var a,r,i="",n=0,s=0,l="",c=!0;for((e=(e=e.replace(/(\s+,\s+|,\s+|\s+,)/g,",").replace(/(^,|,$)/g,"")).replace(/<<(.*?)>>/g,"<$1>")).charAt(0).match(/[\(\[\<\{]/)||(c=!1),a=0;a<e.length;a++)r=!1,0==n&&(i+=e.charAt(a),s=a+1,","==e.charAt(a)?e.substring(a+1).match(/^\s*[\(\[\<\{]/)&&e.substring(0,a).match(/[\)\]\>\}]\s*$/)||(c=!1):0<a&&","!=e.charAt(a-1)&&(c=!1)),e.charAt(a).match(/[\(\[\<\{]/)?n++:e.charAt(a).match(/[\)\]\>\}]/)&&(n--,r=!0),(0==n&&r||1==n&&","==e.charAt(a))&&(l=(l=(l+=singlevalsyntaxcheck(sub=e.substring(s,a).replace(/^\s+/,"").replace(/\s+$/,""),t))+syntaxcheckexpr(sub,t))+(r=singlevaleval(sub,t))[1],i=(i+=r[0])+e.charAt(a),s=a+1);return{err:l=0==(c=0!=n?!1:c)?_("Invalid notation")+". "+l:l,dispvalstr:i,submitstr:i}}function processCalcComplex(e,t){for(var a,r,i,n,s,l="",c=(e=-1!=t.indexOf("allowplusminus")?e.replace(/(.*?)\+\-(.*?)(,|$)/g,"$1+$2,$1-$2$3"):e).split(","),o=(a="",[]),u=0;u<c.length;u++)a=c[u].replace(/^\s+/,"").replace(/\s+$/,""),-1!=t.indexOf("allowjcomplex")&&(a=a.replace(/j/g,"i")),-1!=t.indexOf("generalcomplex")?o.push(a):(-1==t.indexOf("sloppycomplex")&&("string"==typeof(n=parsecomplex(a))?l+=n:l=(l+=singlevalsyntaxcheck(n[0],t))+singlevalsyntaxcheck(n[1],t)),l+=syntaxcheckexpr(a,t),r=scopedeval("var i=0;"+(n=prepWithMath(mathjs(a,"i")))),i=scopedeval("var i=1;"+n),s=scopedeval("var i=-1;"+n),"synerr"!=r&&"synerr"!=i||(l+=_("syntax incomplete"),r=NaN),isNaN(r)||"Infinity"==r||isNaN(i)||isNaN(s)||"Infinity"==i||(i-=r,s=Math.abs(r)<1e-16?"":r,s+=Math.abs(i)<1e-16?"":(0<i&&""!=s?"+":"")+i+"i",o.push(s)));return-1!=t.indexOf("generalcomplex")?{err:l,dispvalstr:o.join(", ")}:{err:l,dispvalstr:o.join(", "),submitstr:o.join(",")}}function processSizedMatrix(e){var t,a,r,i,n,s,l,c,o=allParams[e],u=o.matrixsize,d="";for(o.calcformat&&(d=o.calcformat),t=[],a=[],r=[],s="",l=i=0;l<u[0];l++){for(t[l]=[],a[l]=[],c=0;c<u[1];c++)""!==(n=normalizemathunicode(document.getElementById("qn"+e+"-"+i).value))&&(s=(s+=syntaxcheckexpr(n,d))+singlevalsyntaxcheck(n,d)),t[l][c]=n,s+=(res=singlevaleval(n,d))[1],a[l][c]=res[0],r.push(res[0]),i++;t[l]="("+t[l].join(",")+")",a[l]="("+a[l].join(",")+")"}return{err:s,str:"["+t.join(",")+"]",dispvalstr:"calcmatrix"==o.qtype?"["+a.join(",")+"]":"",submitstr:r.join("|")}}function processCalcMatrix(e,t){var a,r,i,n,s,l,c,o,u,d,p,h,g=!0;for(((e=(e=(e=e.replace(/\[/g,"(")).replace(/\]/g,")")).replace(/\s+/g,"")).length<2||"("!==e.charAt(0)||")"!==e.charAt(e.length-1))&&(g=!1),e=e.substring(1,e.length-1),r=a="",i=[],l=s=n=0;l<e.length;l++)"("==e.charAt(l)?s++:")"==e.charAt(l)?s--:","==e.charAt(l)&&0==s&&(i.push(e.substring(n+1,l-1)),n=l+1);for(0==n&&"("!=e.charAt(0)?i.push(e):i.push(e.substring(n+1,e.length-1)),c=-1,0!==s&&(g=!1),d=[],p=[],l=0;l<i.length;l++){for(d[l]=[],o=i[l].split(","),-1<c&&o.length!=c&&(g=!1),c=o.length,h=0;h<o.length;h++)""==(u=o[h].replace(/^\s+/,"").replace(/\s+$/,""))?(r=_("No elements of the matrix should be left blank."),d[l][h]="",p.push("")):(a=(a=(a+=syntaxcheckexpr(u,t))+singlevalsyntaxcheck(u,t))+(res=singlevaleval(u,t))[1],d[l][h]=res[0],p.push(res[0]));d[l]="("+d[l].join(",")+")"}return g||(a=_("Invalid matrix format")+". "),{err:a+=r,dispvalstr:"["+d.join(",")+"]",submitstr:p.join("|")}}function processNumfunc(e,t,a){for(var r,i,n,s,l,c,o=allParams[e],u=o.vars,d=o.fvars,p=o.domain,h=a.match(/equation/),g=a.match(/inequality/),m="",f=AMnumfuncPrepVar(e,t),v=a.match(/list/)?f[0].split(/,/):[f[0]],y=0,b=0;b<v.length;b++){if(r=(r=v[b]).replace(/,/g,"").replace(/^\s+/,"").replace(/\s+$/,"").replace(/degree/g,""),c=f[2].split("|"),r.match(/(<=|>=|<|>|!=)/)?(g?1<r.match(/(<=|>=|<|>|!=)/g).length?m+=_("syntax error: your inequality should only contain one inequality symbol")+". ":r.match(/(^(<|>|!))|(=|>|<)$/)&&(m+=_("syntax error: your inequality should have expressions on both sides")+". "):m+=h?_("syntax error: you gave an inequality, not an equation")+". ":_("syntax error: you gave an inequality, not an expression")+". ",r=r.replace(/(.*)(<=|>=|<|>|!=)(.*)/,"$1-($3)")):r.match(/=/)?(g&&!h?m+=_("syntax error: you gave an equation, not an inequality")+". ":h?1<r.match(/=/g).length?m+=_("syntax error: your equation should only contain one equal sign")+". ":r.match(/(^=)|(=$)/)&&(m+=_("syntax error: your equation should have expressions on both sides")+". "):m+=_("syntax error: you gave an equation, not an expression")+". ",r=r.replace(/(.*)=(.*)/,"$1-($2)")):h&&g?m+=_("syntax error: this is not an equation or inequality")+". ":h?m+=_("syntax error: this is not an equation")+". ":g&&(m+=_("syntax error: this is not an inequality")+". "),!a.match(/generalcomplex/)){for(0<d.length&&(reg=new RegExp("("+d.join("|")+")\\(","g"),r=(r=(r=r.replace(/\w+/g,functoindex)).replace(reg,"$1*sin($1+")).replace(/@(\d+)@/g,indextofunc)),r=prepWithMath(mathjs(r,c.join("|"))),n=y=0;n<20;n++){for(s="var DNE=1;",i=0;i<c.length-1;i++)l=p[i][2]?Math.floor(Math.random()*(p[i][0]-p[i][1]+1)+p[i][0]):Math.random()*(p[i][0]-p[i][1])+p[i][0],s+="var "+c[i]+"="+l+";";if("synerr"!==scopedeval(s+r)){y++;break}}0===y&&(m+=_("syntax error")+". ")}m+=syntaxcheckexpr(f[0],a+",isnumfunc",u.map(escapeRegExp).join("|"))}return{err:m}}function processMolecule(e){var t,a=allKekule[e].exportObjs(Kekule.Molecule)[0];void 0===a?document.getElementById("qn"+e).value="":(t=Kekule.IO.saveFormatData(a,"smi"),a=Kekule.IO.saveFormatData(a,"cml"),document.getElementById("qn"+e).value=t+"~~~"+a)}function simplifyVariable(e){return e.replace(/[^\w_\^\-+]/g,"")}function ineqtointerval(e,t){var a,r,i,n,s,l=simplifyVariable(t);if((e=e.replace(/(\d)\s*,\s*(?=\d{3}\b)/g,"$1")).match(/all\s*real/i))return["(-oo,oo)"];if(e.match(/DNE/))return["DNE"];if(i=[],1==(n=e.split(/\s*or\s*/)).length&&e.match(/!=/))return 2!=(t=e.split(/!=/)).length?["","invalid"]:simplifyVariable(t[0])!=l?["","wrongvar"]:["(-oo,"+t[1]+")U("+t[1]+",oo)"];for(s=0;s<n.length;s++){if(a=(str=n[s]).match(/^(.*?)(<=?|>=?)(.*?)(<=?|>=?)(.*?)$/)){if(simplifyVariable(a[3])!=l)return["","wrongvar"];if(a[2].charAt(0)!=a[4].charAt(0))return["","invalid"];if(""==a[1].trim()||""==a[5].trim())return["","invalid"];r="<"==a[2].charAt(0)?("<"==a[2]?"(":"[")+a[1]+","+a[5]+("<"==a[4]?")":"]"):(">"==a[4]?"(":"[")+a[5]+","+a[1]+(">"==a[2]?")":"]")}else{if(!(a=str.match(/^(.*?)(<=?|>=?)(.*?)$/)))return["","invalid"];if(simplifyVariable(a[1])==l)r="<"==a[2].charAt(0)?"(-oo,"+a[3]+("<"==a[2]?")":"]"):(">"==a[2]?"(":"[")+a[3]+",oo)";else{if(simplifyVariable(a[3])!=l)return["","wrongvar"];r="<"==a[2].charAt(0)?("<"==a[2]?"(":"[")+a[1]+",oo)":"(-oo,"+a[1]+(">"==a[2]?")":"]")}}i.push(r)}return(e=i.join("U")).match(/[\(\[],|,[\)\]]/)?["","invalid"]:[e]}function parsecomplex(e){var t,a,r,i,n,s,l,c=(e=(e=(e=(e=e.replace(/\s/,"")).replace(/\((\d+\*?i|i)\)\/(\d+)/g,"$1/$2")).replace(/sin/g,"s$n")).replace(/pi/g,"p$")).length;if(2<e.split("i").length)return _("error - more than 1 i in expression");if(-1==(n=e.indexOf("i")))t=e,a="0";else{for(i=0,l=n-1;0<l;l--)if(")"==(r=e.charAt(l)))i++;else if("("==r)i--;else if(("+"==r||"-"==r)&&0==i)break;if(l<0&&(l=0),0!=i)return _("error - invalid form");for(i=0,s=n+1;s<c;s++)if("("==(r=e.charAt(s)))i++;else if(")"==r)i--;else if(("+"==r||"-"==r)&&0==i)break;if(0!=i)return _("error - invalid form");if(0<n-l&&0<s-n&&(s==c||0==l)){if(s==c)t=e.substr(0,l),a=e.substr(l,n-l);else{if(0!=l)return _("error - invalid form");t=e.substr(s),a=e.substr(0,n)}a=(a=(a+="*"+e.substr(n+1+("*"==e.charAt(n+1)?1:0),s-n-1)).replace("-*","-1*").replace("+*","+1*")).replace(/(\+|-)1\*(.+)/g,"$1$2")}else if(1<n-l)a=e.substr(l,n-l),t=e.substr(0,l)+e.substr(n+1);else if(1<s-n)if(0<n){if("+"!=e.charAt(n-1)&&"-"!=e.charAt(n-1))return _("error - invalid form");a=e.charAt(n-1)+e.substr(n+1+("*"==e.charAt(n+1)?1:0),s-n-1),t=e.substr(0,n-1)+e.substr(s)}else a=e.substr(n+1,s-n-1),t=e.substr(0,n)+e.substr(s);else a="+"==e.charAt(l)?"1":"-"==e.charAt(l)?"-1":0==n?"1":e.charAt(l),t=(0<n?e.substr(0,l):"")+e.substr(n+1);""==t&&(t="0"),"/"==a.charAt(0)?a="1"+a:"+"!=a.charAt(0)&&"-"!=a.charAt(0)||"/"!=a.charAt(1)||(a=a.charAt(0)+"1"+a.substr(1)),"+"==(a="*"==a.charAt(a.length-1)?a.substr(0,a.length-1):a).charAt(0)&&(a=a.substr(1)),"+"==t.charAt(0)&&(t=t.substr(1))}return[t=(t=t.replace(/s\$n/g,"sin")).replace(/p\$/g,"pi"),a=(a=(a=a.replace(/s\$n/g,"sin")).replace(/p\$/g,"pi")).replace(/\*\//g,"/")]}function singlevalsyntaxcheck(e,t){if(!(e=e.replace(/(\d)\s*,\s*(?=\d{3}\b)/g,"$1")).match(/DNE/i)&&!e.match(/-?\+?oo$/)&&!e.match(/-?\+?oo\W/)){if(e.match(/,/))return _("Invalid use of a comma.");if(-1==t.indexOf("allowmixed")||!e.match(/^\s*\-?\s*\d+\s*(_|\s)\s*(\d+|\(\d+\))\s*\/\s*(\d+|\(\d+\))\s*$/))if(-1!=t.indexOf("fracordec")){if(!((e=e.replace(/([0-9])\s+([0-9])/g,"$1*$2").replace(/\s/g,"")).match(/^\(?\-?\(?\d+\)?\/\(?\d+\)?$/)||e.match(/^\(?\d+\)?\/\(?\-?\d+\)?$/)||e.match(/^\-?\d+$/)||e.match(/^\-?(\d+|\d+\.\d*|\d*\.\d+)$/)))return _(" invalid entry format")+". "}else if(-1!=t.indexOf("fraction")||-1!=t.indexOf("reducedfraction")){if(!(e=e.replace(/([0-9])\s+([0-9])/g,"$1*$2").replace(/\s/g,"")).match(/^\(?\-?\(?\d+\)?\/\(?\-?\d+\)?$/)&&!e.match(/^\s*?\-?\d+\s*$/))return _("not a valid fraction")+". "}else if(-1!=t.indexOf("mixednumber")){if(!(e.match(/^\(?\-?\s*\(?\d+\)?\/\(?\d+\)?$/)||e.match(/^\(?\d+\)?\/\(?\-?\d+\)?$/)||e.match(/^\s*\-?\s*\d+\s*(_|\s)\s*(\d+|\(\d+\))\s*\/\s*(\d+|\(\d+\))\s*$/)||e.match(/^\s*\-?\s*\d+\s*$/)))return _("not a valid mixed number")+". ";e=e.replace(/_/," ")}else if(-1!=t.indexOf("scinot")){if(!(e=(e=e.replace(/\s/g,"")).replace(/(xx|x|X|\u00D7)/,"xx")).match(/^\-?[1-9](\.\d*)?(\*|xx)10\^(\(?\(?\-?\d+\)?\)?)$/)){if(-1==t.indexOf("scinotordec"))return _("not valid scientific notation")+". ";if(!e.match(/^\-?(\d+|\d+\.\d*|\d*\.\d+)([eE]\-?\d+)?$/))return _("not valid decimal or scientific notation")+". "}}else if(-1!=t.indexOf("decimal")&&-1==t.indexOf("nodecimal")){if(!e.match(/^\-?(\d+|\d+\.\d*|\d*\.\d+)([eE]\-?\d+)?$/))return _(" not a valid integer or decimal number")+". "}else if(-1!=t.indexOf("integer")){if(!e.match(/^\s*\-?\d+(\.0*)?\s*$/))return _(" not an integer number")+". "}else if(!onlyAscii.test(e))return _("Your answer contains an unrecognized symbol")+". "}return""}function syntaxcheckexpr(e,t,a){var r,i,n,s,l,c="";for(-1!=t.indexOf("notrig")&&e.match(/(sin|cos|tan|cot|sec|csc)/i)?c+=_("no trig functions allowed")+". ":-1!=t.indexOf("nodecimal")&&-1!=e.indexOf(".")?c+=_("no decimals allowed")+". ":-1==t.indexOf("mixed")&&e.match(/\-?\s*\d+\s*(_|\s)\s*(\d+|\(\d+\))\s*\/\s*(\d+|\(\d+\))/)?c+=_("mixed numbers are not allowed")+". ":-1==t.indexOf("allowdegrees")&&e.match(/degree/)&&(c+=_("no degree symbols allowed")+". "),s=n=i=r=0;s<e.length;s++)"("==e.charAt(s)?r++:")"==e.charAt(s)?r--:"["==e.charAt(s)?i++:"]"==e.charAt(s)?i--:"|"==e.charAt(s)&&(n=1-n);if(0==r&&0==i||(c+=" ("+_("unmatched parens")+"). "),0!=n&&(c+=" ("+_("unmatched absolute value bars")+"). "),reg=a?new RegExp("(sqrt|ln|log|exp|sinh|cosh|tanh|sech|csch|coth|sin|cos|tan|sec|csc|cot|abs)s*("+a+"|\\d+)","i"):new RegExp("(sqrt|ln|log|exp|sinh|cosh|tanh|sech|csch|coth|sin|cos|tan|sec|csc|cot|abs)s*(\\d+)","i"),null!=(errstuff=e.match(reg))&&(c+="["+_("use function notation")+" - "+_("use $1 instead of $2",errstuff[1]+"("+errstuff[2]+")",errstuff[0])+"]. "),a&&((a="degree|arc|arg|ar|sqrt|root|ln|log|exp|sinh|cosh|tanh|sech|csch|coth|sin|cos|tan|sec|csc|cot|abs|pi|sign|DNE|e|oo".split("|").concat(a.split("|"))).sort(function(e,t){return t.length-e.length}),reg=new RegExp("(repvars\\d+|"+a.join("|")+")","ig"),e.replace(reg,"").match(/[a-zA-Z]/))&&(c+=_(" Check your variables - you might be using an incorrect one")+". "),2<(e.match(/\|/g)||[]).length)for(l=/\|.*?\|\s*(.|$)/g;match=l.exec(e);)if(""!=match[1]&&match[1].match(/[^+\-\*\/\^\)]/)){c+=_(" You may want to use abs(x) instead of |x| for absolute values to avoid ambiguity")+". ";break}return e.match(/%/)&&!e.match(/^\s*[+-]?\s*((\d+(\.\d*)?)|(\.\d+))\s*%\s*$/)&&(c+=_(" Do not use the percent symbol, %")+". "),e.match(/=/)&&!t.match(/isnumfunc/)&&(c+=_("You gave an equation, not an expression")+". "),c}function singlevaleval(e,t){if((e=e.replace(/(\d)\s*,\s*(?=\d{3}\b)/g,"$1")).match(/,/))return[NaN,_("syntax incomplete")+". "];e.match(/^\s*[+-]?\s*((\d+(\.\d*)?)|(\.\d+))\s*%\s*$/)&&(e=e.replace(/%/g,"")+"/100"),-1!=t.indexOf("mixed")&&(e=e.replace(/(\d+)\s+(\d+|\(\d+\))\s*\/\s*(\d+|\(\d+\))/g,"($1+$2/$3)")),-1!=t.indexOf("allowxtimes")&&(e=e.replace(/(xx|x|X|\u00D7)/,"*")),-1!=t.indexOf("scinot")&&(e=e.replace("xx","*"));try{var a=scopedmatheval(e);return""===a?[NaN,_("syntax incomplete")+". "]:[a,""]}catch(e){return[NaN,_("syntax incomplete")+". "]}}function escapeRegExp(e){return e.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&")}function scopedeval(c){try{return eval(c)}catch(e){return"synerr"}}function scopedmatheval(c){if(c.match(/^\s*[a-df-zA-Z]\s*$/))return"";try{return eval(prepWithMath(mathjs(c)))}catch(e){return""}}return allParams={},allKekule={},LivePreviews=[],MQsyntaxtimer=null,greekletters=["alpha","beta","chi","delta","epsilon","gamma","varphi","phi","psi","sigma","rho","theta","lambda","mu","nu","omega","tau"],onlyAscii=/^[\u0000-\u007f]*$/,{init:init,clearparams:clearparams,preSubmitForm:preSubmitForm,preSubmit:preSubmit,preSubmitString:preSubmitString,clearLivePreviewTimeouts:clearLivePreviewTimeouts,syntaxCheckMQ:syntaxCheckMQ,clearTips:clearTips,handleMQenter:handleMQenter}}(jQuery),seqgroupcollapsed={},AutoSuggestIdCounter=0,autoSuggestLists={},autoSuggestObjects={},document.write=function(){};
var ehcurel,ehclosetimer,ehddclosetimer,curehdd,eecurel;function showeh(e){var t,l,d;null==eecurel&&(unhideeh(0),t=document.getElementById(e),l=document.getElementById("eh"),e!=ehcurel?(ehcurel=e,d=jQuery(t).offset(),l.style.display="block",l.style.left=d.left+"px",l.style.top=d.top+t.offsetHeight+"px",document.getElementById("ehdd").style.display="none"):(l.style.display="none",ehcurel=null),(e.match(/mqinput/)?MQ(t):t).focus())}function reshrinkeh(e){null==eecurel&&e==ehcurel&&(document.getElementById("ehdd").style.display="block",document.getElementById("eh").style.display="none",ehcurel=null,curehdd=e,unhideeh(0))}function unhideeh(e){ehcancelclosetimer()}function hideeh(e){null==ehcurel?ehddclosetimer=window.setTimeout(function(){curehdd=null,document.getElementById("ehdd").style.display="none"},250):ehclosetimer=window.setTimeout(reallyhideeh,250)}function reallyhideeh(){document.getElementById("eh").style.display="none",ehcurel=null}function ehcancelclosetimer(){ehclosetimer&&(window.clearTimeout(ehclosetimer),ehclosetimer=null)}function hideAllEhTips(){ehclosetimer&&(window.clearTimeout(ehclosetimer),ehclosetimer=null),ehddclosetimer&&(window.clearTimeout(ehddclosetimer),ehddclosetimer=null),curehdd=null,document.getElementById("ehdd").style.display="none",document.getElementById("eh").style.display="none"}function showehdd(e,t,l){var d,n,o;null!=eecurel&&eecurel==e||null!=document.getElementById("tips"+l)&&(ehddclosetimer&&e!=curehdd&&(window.clearTimeout(ehddclosetimer),ehddclosetimer=null),e!=ehcurel&&(d=document.getElementById("ehdd"),n=document.getElementById(e),o=jQuery(n).offset(),document.getElementById("ehddtext").innerHTML=t,document.getElementById("eh").innerHTML=document.getElementById("tips"+l).innerHTML,d.style.display="block",d.style.left=o.left+"px",d.style.top=o.top+n.offsetHeight+"px"),curehdd=e)}function updateehpos(){var e,t,l,d;(curehdd||ehcurel)&&(e=document.getElementById("eh"),t=document.getElementById("ehdd"),l=document.getElementById(curehdd||ehcurel),d=jQuery(l).offset(),e.style.left=d.left+"px",e.style.top=d.top+l.offsetHeight+"px",t.style.left=d.left+"px",t.style.top=d.top+l.offsetHeight+"px")}ehddclosetimer=ehclosetimer=0,eecurel=curehdd=ehcurel=null;
var pi,ln,e,arcsin,arccos,arctan,sec,csc,cot,arcsec,arccsc,arccot,sinh,cosh,tanh,sech,csch,coth,arcsinh,arccosh,arctanh,arcsech,arccsch,arccoth,sign,logten,sinn,cosn,tann,cscn,secn,cotn,lnn,funcstoindexarr;function factorial(c,r){for(var n=c-(r=null==r?1:r);0<n;n-=r)c*=n;return c<0?NaN:0==c?1:c}function C(c,r){for(var n=1,t=0;t<r;t++)n*=(c-t)/(r-t);return n}function matchtolower(c){return c.toLowerCase()}function nthroot(c,r){return safepow(r,1/c)}function nthlogten(c,r){return Math.log(r)/Math.log(c)}function functoindex(c){for(var r=0;r<funcstoindexarr.length;r++)if(funcstoindexarr[r]==c)return"@"+r+"@";return c}function indextofunc(c,r){return funcstoindexarr[r]}function safepow(c,r){if(c<0&&Math.floor(r)!=r){for(var n=3;n<50;n+=2)if(Math.abs(Math.round(n*r)-n*r)<1e-6)return Math.round(n*r)%2==0?Math.pow(Math.abs(c),r):-1*Math.pow(Math.abs(c),r);return Math.sqrt(-1)}return Math.pow(c,r)}function mathjs(c,r){var t,a,n,e,o,s,h;if(c=(c=(c=(c=(c=(c=(c=(c=(c=(c=c.replace(/(\+\s*-|-\s*\+)/g,"-").replace(/-\s*-/g,"+")).replace(/\[/g,"(")).replace(/\]/g,")")).replace(/\b00+\./g,"0.")).replace(/root\s*(\d+)/,"root($1)")).replace(/\|(.*?)\|/g,"abs($1)")).replace(/arc(sin|cos|tan|sec|csc|cot|sinh|cosh|tanh|sech|csch|coth)/gi,"$1^-1")).replace(/(ar|arg)(sinh|cosh|tanh|sech|csch|coth)/gi,"$2^-1")).replace(/(Sin|Cos|Tan|Sec|Csc|Cot|Arc|Abs|Log|Exp|Ln|Sqrt)/gi,matchtolower)).replace(/(sinh|cosh|tanh|sech|csch|coth|sqrt|ln|log|exp|sin|cos|tan|sec|csc|cot|abs|root)/g,functoindex),null!=r&&""!=r){for((t=r.split("|")).push("pi"),t.sort(function(c,r){return r.length-c.length}),r=t.join("|"),a=[],n=0;n<t.length;n++)if(a[n]=!1,"E"==t[n]||"e"==t[n])a[n]=!0;else for(e=0;e<t.length;e++)if(n!=e&&t[e].toLowerCase()==t[n].toLowerCase()&&t[e]!=t[n]){a[n]=!0;break}c=c.replace(new RegExp("("+r+")","gi"),function(c,r){for(var n=0;n<t.length;n++)if(t[n]==r||!a[n]&&t[n].toLowerCase()==r.toLowerCase())return"(@v"+n+"@)";return r})}else c=c.replace(/pi/g,"(pi)");for(c=(c=(c=(c=(c=(c=(c=(c=(c=(c=(c=(c=(c=(c=(c=c.replace(/([0-9])E([\-0-9])/g,"$1(EE)$2")).replace(/\*?\s*degrees?/g,"*((pi)/180)")).replace(/e/g,"(E)")).replace(/@(\d+)@/g,indextofunc)).replace(/log_([a-zA-Z\d\.]+)\s*\(/g,"nthlog($1,")).replace(/log_\(([a-zA-Z\/\d\.]+)\)\s*\(/g,"nthlog(($1),")).replace(/log_(\(@v\d+@\))\s*\(/g,"nthlog($1,")).replace(/log/g,"logten")).replace(/(sin|cos|tan|sec|csc|cot|sinh|cosh|tanh|sech|csch|coth)\^(-1|\(-1\))/g,"arc$1")).replace(/(sin|cos|tan|sec|csc|cot|ln)\^(\d+)\s*\(/g,"$1n($2,")).replace(/(sin|cos|tan|sec|csc|cot|ln)\^\((\d+)\)\s*\(/g,"$1n($2,")).replace(/root\s*\((\d+)\)\s*\(/g,"nthroot($1,")).replace(/([0-9]\.?)\s+([0-9])/g,"$1*$2")).replace(/#/g,"")).replace(/\s/g,""),c=(c=(c=(c=(c=null!=r&&""!=r?c.replace(/@v(\d+)@/g,function(c,r){return t[r]}):c).replace(/([0-9]\.?)([\(a-zA-Z])/g,"$1*$2")).replace(/(!)([0-9\(a-zA-Z])/g,"$1*$2")).replace(/\)([\(0-9a-zA-Z]|\.\d+)/g,")*$1")).replace(/([0-9])\*\(EE\)\*?([\-0-9])/g,"$1e$2");-1!=(n=c.indexOf("!"));){if(0==n)return"Error: missing argument";if("0"<=(s=c.charAt(e=n-1))&&s<="9"||"."==s){for(e--;0<=e&&"0"<=(s=c.charAt(e))&&s<="9";)e--;if("."==s)for(e--;0<=e&&"0"<=(s=c.charAt(e))&&s<="9";)e--}else if(")"==s){for(h=1,e--;0<=e&&0<h;)"("==(s=c.charAt(e))?h--:")"==s&&h++,e--;for(;0<=e&&("a"<=(s=c.charAt(e))&&s<="z"||"A"<=s&&s<="Z");)e--}else{if(!("a"<=s&&s<="z"||"A"<=s&&s<="Z"))return"Error: incorrect syntax in "+c+" at position "+e;for(e--;0<=e&&("a"<=(s=c.charAt(e))&&s<="z"||"A"<=s&&s<="Z");)e--}c=c.slice(0,e+1)+"factorial("+c.slice(e+1,n)+")"+c.slice(n+1)}for(;-1!=(n=c.lastIndexOf("^"));){if(0==n)return"Error: missing argument";if("0"<=(s=c.charAt(e=n-1))&&s<="9"||"."==s){for(e--;0<=e&&"0"<=(s=c.charAt(e))&&s<="9";)e--;if("."==s)for(e--;0<=e&&"0"<=(s=c.charAt(e))&&s<="9";)e--}else if(")"==s){for(h=1,e--;0<=e&&0<h;)"("==(s=c.charAt(e))?h--:")"==s&&h++,e--;for(;0<=e&&("a"<=(s=c.charAt(e))&&s<="z"||"A"<=s&&s<="Z");)e--}else{if(!("a"<=s&&s<="z"||"A"<=s&&s<="Z"))return"Error: incorrect syntax in "+c+" at position "+e;for(e--;0<=e&&("a"<=(s=c.charAt(e))&&s<="z"||"A"<=s&&s<="Z");)e--}if(n==c.length-1)return"Error: missing argument";if(s=c.charAt(o=n+1),nch=c.charAt(o+1),"0"<=s&&s<="9"||"-"==s&&"("!=nch||"."==s){for(o++;o<c.length&&"0"<=(s=c.charAt(o))&&s<="9";)o++;if("."==s)for(o++;o<c.length&&"0"<=(s=c.charAt(o))&&s<="9";)o++}else if("("==s||"-"==s&&"("==nch)for("-"==s&&o++,h=1,o++;o<c.length&&0<h;)"("==(s=c.charAt(o))?h++:")"==s&&h--,o++;else{if(!("a"<=s&&s<="z"||"A"<=s&&s<="Z"))return"Error: incorrect syntax in "+c+" at position "+o;for(o++;o<c.length&&("a"<=(s=c.charAt(o))&&s<="z"||"A"<=s&&s<="Z");)o++;if("("==s&&c.slice(n+1,o).match(/^(sinn|cosn|tann|secn|cscn|cotn|sin|cos|tan|sec|csc|cot|logten|nthlogten|log|ln|exp|arcsin|arccos|arctan|arcsec|arccsc|arccot|sinh|cosh|tanh|sech|csch|coth|arcsinh|arccosh|arctanh|arcsech|arccsch|arccoth|sqrt|abs|nthroot|factorial|safepow)$/))for(h=1,o++;o<c.length&&0<h;)"("==(s=c.charAt(o))?h++:")"==s&&h--,o++}c=c.slice(0,e+1)+"safepow("+c.slice(e+1,n)+","+c.slice(n+1,o)+")"+c.slice(o)}return c}pi=Math.PI,ln=Math.log,e=Math.E,arcsin=Math.asin,arccos=Math.acos,arctan=Math.atan,sec=function(c){return 1/Math.cos(c)},csc=function(c){return 1/Math.sin(c)},cot=function(c){return 1/Math.tan(c)},arcsec=function(c){return arccos(1/c)},arccsc=function(c){return arcsin(1/c)},arccot=function(c){return arctan(1/c)},sinh=function(c){return(Math.exp(c)-Math.exp(-c))/2},cosh=function(c){return(Math.exp(c)+Math.exp(-c))/2},tanh=function(c){return(Math.exp(c)-Math.exp(-c))/(Math.exp(c)+Math.exp(-c))},sech=function(c){return 1/cosh(c)},csch=function(c){return 1/sinh(c)},coth=function(c){return 1/tanh(c)},arcsinh=function(c){return ln(c+Math.sqrt(c*c+1))},arccosh=function(c){return ln(c+Math.sqrt(c*c-1))},arctanh=function(c){return ln((1+c)/(1-c))/2},sech=function(c){return 1/cosh(c)},csch=function(c){return 1/sinh(c)},coth=function(c){return 1/tanh(c)},arcsech=function(c){return arccosh(1/c)},arccsch=function(c){return arcsinh(1/c)},arccoth=function(c){return arctanh(1/c)},sign=function(c){return 0==c?0:c<0?-1:1},logten=function(c){return Math.LOG10E*Math.log(c)},sinn=function(c,r){return Math.pow(Math.sin(r),c)},cosn=function(c,r){return Math.pow(Math.cos(r),c)},tann=function(c,r){return Math.pow(Math.tan(r),c)},cscn=function(c,r){return 1/Math.pow(Math.sin(r),c)},secn=function(c,r){return 1/Math.pow(Math.cos(r),c)},cotn=function(c,r){return 1/Math.pow(Math.tan(r),c)},lnn=function(c,r){return Math.pow(Math.log(r),c)},funcstoindexarr="sinh|cosh|tanh|sech|csch|coth|sqrt|ln|log|exp|sin|cos|tan|sec|csc|cot|abs|root|arcsin|arccos|arctan|arcsec|arccsc|arccot|arcsinh|arccosh|arctanh|arcsech|arccsch|arccoth|argsinh|argcosh|argtanh|argsech|argcsch|argcoth|arsinh|arcosh|artanh|arsech|arcsch|arcoth|pi".split("|");
var AMtoMQ=function(){var r,i,a,v,o,$,g,c,w,s,m,_,x,y;function t(t,e){return t.input>e.input?1:-1}function q(t,e){for(var u="\\"==t.charAt(e)&&"\\"!=t.charAt(e+1)&&" "!=t.charAt(e+1)?t.slice(e+1):t.slice(e),p=0;p<u.length&&u.charCodeAt(p)<=32;p+=1);return u.slice(p)}function O(t){for(var e,u,p,n=0,l="",a=!0,o=1;o<=t.length&&a;o++)u=t.slice(0,o),(n=function(t,e,u){var p,n,l;if(0==u){for(u=-1,p=t.length;u+1<p;)t[n=u+p>>1]<e?u=n:p=n;return p}for(l=u;l<t.length&&t[l]<e;l++);return l}(D,u,n))<D.length&&t.slice(0,D[n].length)==D[n]&&(o=(l=D[e=n]).length),a=n<D.length&&t.slice(0,D[n].length)>=D[n];if(x=y,""!=l)return y=z[e].ttype,z[e];for(y=r,u=t.slice(0,n=1),p=!0;"0"<=u&&u<="9"&&n<=t.length;)u=t.slice(n,n+1),n++;if(u==d&&(u=t.slice(n,n+1),n++,"0"<=u)&&u<="9")for(p=!1;"0"<=u&&u<="9"&&n<=t.length;)u=t.slice(n,n+1),n++;return p=p&&1<n||2<n?(u=t.slice(0,n-1),"mn"):(n=2,((u=t.slice(0,1))<"A"||"Z"<u)&&(u<"a"||"z"<u)?"mo":"mi"),"-"==u&&" "!==t.charAt(1)&&x==v?(y=v,{input:u,tag:p,output:u,ttype:i,func:!0,val:!0}):{input:u,tag:p,output:u,ttype:r,val:!0}}function E(t){var e,u;return"{"==t.charAt(0)&&"}"==t.charAt(t.length-1)&&(u=0,"\\left"==(e=t.substr(1,5))?"("==(e=t.charAt(6))||"["==e||"{"==e?u=7:"\\lbrace"==(e=t.substr(6,7))&&(u=13):"("!=(e=t.charAt(1))&&"["!=e||(u=2),0<u)&&("\\right)}"==(e=t.substr(t.length-8))||"\\right]}"==e||"\\right.}"==e?t=(t="{"+t.substr(u)).substr(0,t.length-8)+"}":"\\rbrace}"==e&&(t=(t="{"+t.substr(u)).substr(0,t.length-14)+"}")),t}function h(t){return pre="boolean"==typeof t.val&&t.val?"":"\\",null==t.tex?pre+t.input:pre+t.tex}function R(t){return null==t.tex?t.input:"\\"+t.tex}function f(t){var e,u,p,n,l="";if(null==(e=O(t=q(t,0)))||e.ttype==$&&0<_)return[null,t];switch((e=e.ttype==c?O(t=e.output+q(t,e.input.length)):e).ttype){case g:case r:return t=q(t,e.input.length),"\\"==(n=h(e)).charAt(0)||"mo"==e.tag?[n,t]:["{"+n+"}",t];case o:return(_++,u=b(t=q(t,e.input.length),!0),_--,u[0].match(/bmatrix/))?[u[0].substring(0,u[0].length-7),u[1]]:("\\right"==u[n=0].substr(0,6)&&(")"==(p=u[0].charAt(6))||"]"==p||"}"==p?n=6:"."==p?n=7:"\\rbrace"==(p=u[0].substr(6,7))&&(n=13)),[0<n?(u[0]=u[0].substr(n),"boolean"==typeof e.invisible&&e.invisible?"{"+u[0]+"}":"{"+R(e)+u[0]+"}"):"boolean"==typeof e.invisible&&e.invisible?"{"+u[0]+"}":"{\\left"+R(e)+u[0]+"}",u[1]]);case s:return-1==(n="{"==(t=e!=m?q(t,e.input.length):t).charAt(0)?t.indexOf("}"):"("==t.charAt(0)?t.indexOf(")"):"["==t.charAt(0)?t.indexOf("]"):e==m?t.slice(1).indexOf('"')+1:0)&&(n=t.length),[l+="\\text{"+(p=t.slice(1,n))+"}",t=q(t,n+1)];case i:return null==(u=f(t=q(t,e.input.length)))[0]?["{"+h(e)+"}",t]:"boolean"==typeof e.func&&e.func?"^"==(p=t.charAt(0))||"_"==p||"/"==p||"|"==p||","==p||1==e.input.length&&e.input.match(/\w/)&&"("!=p?["{"+h(e)+"}",t]:["{"+h(e)+"{"+u[0]+"}}",u[1]]:(u[0]=E(u[0]),"sqrt"==e.input?["\\sqrt{"+u[0]+"}",u[1]]:"abs"==e.input?["\\left|{"+u[0]+"}\\right|",u[1]]:"cancel"==e.input?["\\cancel{"+u[0]+"}",u[1]]:void 0!==e.rewriteleftright?["{\\left"+e.rewriteleftright[0]+u[0]+"\\right"+e.rewriteleftright[1]+"}",u[1]]:"boolean"==typeof e.acc&&e.acc?[h(e)+"{"+u[0]+"}",u[1]]:["{"+h(e)+"{"+u[0]+"}}",u[1]]);case a:return null==(u=f(t=q(t,e.input.length)))[0]?["{"+h(e)+"}",t]:(u[0]=E(u[0]),null==(n=f(u[1]))[0]?["{"+h(e)+"}",t]:(n[0]=E(n[0]),[l="color"==e.input?"{\\color{"+u[0].replace(/[\{\}]/g,"")+"}"+n[0]+"}":"root"==e.input?"{\\sqrt["+u[0]+"]{"+n[0]+"}}":"{"+h(e)+"{"+u[0]+"}{"+n[0]+"}}",n[1]]));case v:return t=q(t,e.input.length),[e.output,t];case A:return t=q(t,e.input.length),["{\\quad\\text{"+e.input+"}\\quad}",t];case w:return _++,u=b(t=q(t,e.input.length),!1),_--,p="","|"==(p=u[0].charAt(u[0].length-1))?["{\\left|"+u[0]+"}",u[1]]:["{\\mid}",t];default:return t=q(t,e.input.length),["{"+h(e)+"}",t]}}function S(t){var e,u,p,n=O(t=q(t,0)),l=(u=f(t))[0];return(p=O(t=u[1])).ttype==v&&"/"!=p.input&&(null==(u=f(t=q(t,p.input.length)))[0]?u[0]="{}":u[0]=E(u[0]),t=u[1],"_"==p.input?"^"==(e=O(t)).input?((p=f(t=q(t,e.input.length)))[0]=E(p[0]),t=p[1],l="{"+l,l=(l+="_{"+u[0]+"}")+"^{"+p[0]+"}}"):l+="_{"+u[0]+"}":l=l+"^{"+u[0]+"}",void 0!==n.func)&&n.func&&(e=O(t)).ttype!=v&&e.ttype!=$&&(l="{"+l+(u=S(t))[0]+"}",t=u[1]),[l,t]}function b(t,e){for(var u,p,n,l,a,o,r,i,g,c,s,m,x,y,h,f,b,d="",A=!1;p=(n=S(t=q(t,0)))[0],(u=O(t=n[1])).ttype==v&&"/"==u.input?(null==(n=S(t=q(t,u.input.length)))[0]?n[0]="{}":n[0]=E(n[0]),t=n[1],p="\\frac{"+(p=E(p))+"}",d+=p+="{"+n[0]+"}",u=O(t)):null!=p&&(d+=p),(u.ttype!=$&&(u.ttype!=w||e)||0==_)&&null!=u&&""!=u.output;);if(u.ttype==$||u.ttype==w){if(a=d.length,I&&2<a&&"{"==d.charAt(0)&&0<d.indexOf(",")&&(")"==(o=d.charAt(a-2))||"]"==o)&&("("==(r=d.charAt(6))&&")"==o&&"}"!=u.output||"["==r&&"]"==o)){for(i="\\begin{bmatrix}",(g=new Array).push(0),c=!0,(m=[])[s=0]=[0],y=x=0,l=1;l<a-1;l++)d.charAt(l)==r&&s++,d.charAt(l)==o&&0==--s&&","==d.charAt(l+2)&&"{"==d.charAt(l+3)&&(g.push(l+2),m[x=l+2]=[l+2]),"["!=d.charAt(l)&&"("!=d.charAt(l)&&"{"!=d.charAt(l)||y++,"]"!=d.charAt(l)&&")"!=d.charAt(l)&&"}"!=d.charAt(l)||y--,","==d.charAt(l)&&1==y&&m[x].push(l);if(g.push(a),h=-1,0==s&&0<g.length)for(l=0;l<g.length-1;l++){if(0<l&&(i+="\\\\"),0==l)if(1==m[g[l]].length)f=[d.substr(g[l]+7,g[l+1]-g[l]-15)];else{for(f=[d.substring(g[l]+7,m[g[l]][1])],b=2;b<m[g[l]].length;b++)f.push(d.substring(m[g[l]][b-1]+1,m[g[l]][b]));f.push(d.substring(m[g[l]][m[g[l]].length-1]+1,g[l+1]-8))}else if(1==m[g[l]].length)f=[d.substr(g[l]+8,g[l+1]-g[l]-16)];else{for(f=[d.substring(g[l]+8,m[g[l]][1])],b=2;b<m[g[l]].length;b++)f.push(d.substring(m[g[l]][b-1]+1,m[g[l]][b]));f.push(d.substring(m[g[l]][m[g[l]].length-1]+1,g[l+1]-8))}0<h&&f.length!=h?c=!1:-1==h&&(h=f.length),i+=f.join("&")}i+="\\end{bmatrix}",c&&(d=i)}t=q(t,u.input.length),A=("boolean"==typeof u.invisible&&u.invisible||(d+=p="\\right"+R(u)),!0)}return 0<_&&!A&&(d+="\\right)"),[d,t]}for(var d=".",A=6,z=[{input:"alpha",tag:"mi",output:"α",tex:null,ttype:r=0},{input:"beta",tag:"mi",output:"β",tex:null,ttype:r},{input:"chi",tag:"mi",output:"χ",tex:null,ttype:r},{input:"delta",tag:"mi",output:"δ",tex:null,ttype:r},{input:"Delta",tag:"mo",output:"Δ",tex:null,ttype:r},{input:"epsi",tag:"mi",output:"ε",tex:"epsilon",ttype:r},{input:"varepsilon",tag:"mi",output:"ɛ",tex:null,ttype:r},{input:"eta",tag:"mi",output:"η",tex:null,ttype:r},{input:"gamma",tag:"mi",output:"γ",tex:null,ttype:r},{input:"Gamma",tag:"mo",output:"Γ",tex:null,ttype:r},{input:"iota",tag:"mi",output:"ι",tex:null,ttype:r},{input:"kappa",tag:"mi",output:"κ",tex:null,ttype:r},{input:"lambda",tag:"mi",output:"λ",tex:null,ttype:r},{input:"Lambda",tag:"mo",output:"Λ",tex:null,ttype:r},{input:"mu",tag:"mi",output:"μ",tex:null,ttype:r},{input:"nu",tag:"mi",output:"ν",tex:null,ttype:r},{input:"omega",tag:"mi",output:"ω",tex:null,ttype:r},{input:"Omega",tag:"mo",output:"Ω",tex:null,ttype:r},{input:"phi",tag:"mi",output:"φ",tex:null,ttype:r},{input:"varphi",tag:"mi",output:"ϕ",tex:null,ttype:r},{input:"Phi",tag:"mo",output:"Φ",tex:null,ttype:r},{input:"pi",tag:"mi",output:"π",tex:null,ttype:r},{input:"Pi",tag:"mo",output:"Π",tex:null,ttype:r},{input:"psi",tag:"mi",output:"ψ",tex:null,ttype:r},{input:"Psi",tag:"mi",output:"Ψ",tex:null,ttype:r},{input:"rho",tag:"mi",output:"ρ",tex:null,ttype:r},{input:"sigma",tag:"mi",output:"σ",tex:null,ttype:r},{input:"Sigma",tag:"mo",output:"Σ",tex:null,ttype:r},{input:"tau",tag:"mi",output:"τ",tex:null,ttype:r},{input:"theta",tag:"mi",output:"θ",tex:null,ttype:r},{input:"vartheta",tag:"mi",output:"ϑ",tex:null,ttype:r},{input:"Theta",tag:"mo",output:"Θ",tex:null,ttype:r},{input:"upsilon",tag:"mi",output:"υ",tex:null,ttype:r},{input:"xi",tag:"mi",output:"ξ",tex:null,ttype:r},{input:"Xi",tag:"mo",output:"Ξ",tex:null,ttype:r},{input:"zeta",tag:"mi",output:"ζ",tex:null,ttype:r},{input:"*",tag:"mo",output:"⋅",tex:"cdot",ttype:r},{input:"-:",tag:"mo",output:"÷",tex:"div",ttype:r},{input:"sum",tag:"mo",output:"∑",tex:null,ttype:g=7},{input:"^^",tag:"mo",output:"∧",tex:"wedge",ttype:r},{input:"xor",tag:"mo",output:"⊕",tex:"oplus",ttype:r},{input:"oplus",tag:"mo",output:"⊕",tex:"oplus",ttype:r},{input:"ominus",tag:"mo",output:"⊖",tex:"ominus",ttype:r},{input:"neg",tag:"mo",output:"¬",tex:"neg",ttype:r},{input:"vv",tag:"mo",output:"∨",tex:"vee",ttype:r},{input:"nn",tag:"mo",output:"∩",tex:"cap",ttype:r},{input:"uu",tag:"mo",output:"∪",tex:"cup",ttype:r},{input:"xx",tex:"times",ttype:r},{input:"!=",tag:"mo",output:"≠",tex:"ne",ttype:r},{input:"<=",tag:"mo",output:"≤",tex:"le",ttype:r},{input:">=",tag:"mo",output:"≥",tex:"ge",ttype:r},{input:"geq",tag:"mo",output:"≥",tex:null,ttype:r},{input:"in",tag:"mo",output:"∈",tex:null,ttype:r},{input:"sub",tag:"mo",output:"⊂",tex:"subset",ttype:r},{input:"sube",tag:"mo",output:"⊆",tex:"subseteq",ttype:r},{input:"(",tag:"mo",output:"(",tex:null,ttype:o=4},{input:")",tag:"mo",output:")",tex:null,ttype:$=5},{input:"[",tag:"mo",output:"[",tex:null,ttype:o},{input:"]",tag:"mo",output:"]",tex:null,ttype:$},{input:"{",tag:"mo",output:"{",tex:"{",ttype:o,notexcopy:!0},{input:"}",tag:"mo",output:"}",tex:"}",ttype:$,notexcopy:!0},{input:"|",tag:"mo",output:"|",tex:null,ttype:w=9},{input:"(:",tag:"mo",output:"〈",tex:"langle",ttype:o},{input:":)",tag:"mo",output:"〉",tex:"rangle",ttype:$},{input:"<<",tag:"mo",output:"〈",tex:"langle",ttype:o},{input:">>",tag:"mo",output:"〉",tex:"rangle",ttype:$},{input:"{:",tag:"mo",output:"{:",tex:null,ttype:o,invisible:!0},{input:":}",tag:"mo",output:":}",tex:null,ttype:$,invisible:!0},{input:"int",tag:"mo",output:"∫",tex:null,ttype:r},{input:"+-",tag:"mo",output:"±",tex:"pm",ttype:r},{input:"O/",tag:"mo",output:"∅",tex:"emptyset",ttype:r},{input:"oo",tag:"mo",output:"∞",tex:"infty",ttype:r},{input:"rarr",tag:"mo",output:"→",tex:"rightarrow",ttype:r},{input:"->",tag:"mo",output:"→",tex:"to",ttype:r},{input:"=>",tag:"mo",output:"⇒",tex:"implies",ttype:r},{input:"<=>",tag:"mo",output:"⇔",tex:"iff",ttype:r},{input:"rightleftharpoons",tag:"mo",output:"⇌",tex:null,ttype:r},{input:"RR",tag:"mo",output:"ℝ",tex:"mathbb{R}",ttype:r,notexcopy:!0},{input:"f",tag:"mi",output:"f",tex:null,ttype:i=1,func:!0,val:!0},{input:"degree",tag:"mo",tex:null,ttype:r},{input:"degrees",output:"degree",ttype:c=8},{input:"sin",tag:"mo",output:"sin",tex:null,ttype:i,func:!0},{input:"cos",tag:"mo",output:"cos",tex:null,ttype:i,func:!0},{input:"tan",tag:"mo",output:"tan",tex:null,ttype:i,func:!0},{input:"arcsin",tag:"mo",output:"arcsin",tex:null,ttype:i,func:!0},{input:"arccos",tag:"mo",output:"arccos",tex:null,ttype:i,func:!0},{input:"arctan",tag:"mo",output:"arctan",tex:null,ttype:i,func:!0},{input:"arcsec",tag:"mo",output:"arcsec",tex:null,ttype:i,func:!0},{input:"arccsc",tag:"mo",output:"arccsc",tex:null,ttype:i,func:!0},{input:"arccot",tag:"mo",output:"arccot",tex:null,ttype:i,func:!0},{input:"sinh",tag:"mo",output:"sinh",tex:null,ttype:i,func:!0},{input:"cosh",tag:"mo",output:"cosh",tex:null,ttype:i,func:!0},{input:"tanh",tag:"mo",output:"tanh",tex:null,ttype:i,func:!0},{input:"cot",tag:"mo",output:"cot",tex:null,ttype:i,func:!0},{input:"coth",tag:"mo",output:"coth",tex:null,ttype:i,func:!0},{input:"sech",tag:"mo",output:"sech",tex:null,ttype:i,func:!0},{input:"csch",tag:"mo",output:"csch",tex:null,ttype:i,func:!0},{input:"sec",tag:"mo",output:"sec",tex:null,ttype:i,func:!0},{input:"csc",tag:"mo",output:"csc",tex:null,ttype:i,func:!0},{input:"log",tag:"mo",output:"log",tex:null,ttype:i,func:!0},{input:"ln",tag:"mo",output:"ln",tex:null,ttype:i,func:!0},{input:"abs",tag:"mo",output:"abs",tex:null,ttype:i},{input:"Sin",tag:"mo",output:"sin",tex:null,ttype:i,func:!0},{input:"Cos",tag:"mo",output:"cos",tex:null,ttype:i,func:!0},{input:"Tan",tag:"mo",output:"tan",tex:null,ttype:i,func:!0},{input:"Arcsin",tag:"mo",output:"arcsin",tex:null,ttype:i,func:!0},{input:"Arccos",tag:"mo",output:"arccos",tex:null,ttype:i,func:!0},{input:"Arctan",tag:"mo",output:"arctan",tex:null,ttype:i,func:!0},{input:"Sinh",tag:"mo",output:"sinh",tex:null,ttype:i,func:!0},{input:"Sosh",tag:"mo",output:"cosh",tex:null,ttype:i,func:!0},{input:"Tanh",tag:"mo",output:"tanh",tex:null,ttype:i,func:!0},{input:"Cot",tag:"mo",output:"cot",tex:null,ttype:i,func:!0},{input:"Sec",tag:"mo",output:"sec",tex:null,ttype:i,func:!0},{input:"Csc",tag:"mo",output:"csc",tex:null,ttype:i,func:!0},{input:"Log",tag:"mo",output:"log",tex:null,ttype:i,func:!0},{input:"Ln",tag:"mo",output:"ln",tex:null,ttype:i,func:!0},{input:"Abs",tag:"mo",output:"abs",tex:null,ttype:i,func:!0},{input:"sqrt",tag:"msqrt",output:"sqrt",tex:null,ttype:i},{input:"root",tag:"mroot",output:"root",tex:null,ttype:a=2},{input:"frac",tag:"mfrac",output:"/",tex:null,ttype:a},{input:"/",tag:"mfrac",output:"/",tex:null,ttype:v=3},{input:"stackrel",tag:"mover",output:"stackrel",tex:null,ttype:a},{input:"_",tag:"msub",output:"_",tex:null,ttype:v},{input:"^",tag:"msup",output:"^",tex:null,ttype:v},{input:"Sqrt",tag:"msqrt",output:"sqrt",tex:null,ttype:i},{input:"hat",tag:"mover",output:"^",tex:null,ttype:i,acc:!0},{input:"bar",tag:"mover",output:"¯",tex:"overline",ttype:i,acc:!0},{input:"vec",tag:"mover",output:"→",tex:null,ttype:i,acc:!0},{input:"text",tag:"mtext",output:"text",tex:null,ttype:s=10},{input:"mbox",tag:"mtext",output:"mbox",tex:null,ttype:s},m={input:'"',tag:"mtext",output:"mbox",tex:null,ttype:s}],D=[],I=!0,e=[],u=0;u<z.length;u++)!z[u].tex||"boolean"==typeof z[u].notexcopy&&z[u].notexcopy||(e[e.length]={input:z[u].tex,tag:z[u].tag,output:z[u].output,ttype:z[u].ttype,acc:z[u].acc||!1});for((z=z.concat(e)).sort(t),u=0;u<z.length;u++)D[u]=z[u].input;return function(t,e,u){return!(_=0)===u&&(I=!1),t=t.replace(/(&nbsp;|\u00a0|&#160;|{::})/g,""),t=(t=(t=(t=(t=(t=(t=document.getElementById(e)&&document.getElementById(e).getAttribute("data-mq").match(/(ntuple|string)/)?t.replace(/<([^<].*?,.*?[^>])>/g,"<<$1>>"):t).replace(/&gt;/g,">")).replace(/&lt;/g,"<")).replace(/\s*\bor\b\s*/g,'" or "')).replace(/all\s+real\s+numbers/g,'"all real numbers"')).replace(/(\)|\])\s*u\s*(\(|\[)/g,"$1U$2")).replace(/\bDNE\b/gi,'"DNE"'),null==(t=document.getElementById(e)&&document.getElementById(e).getAttribute("data-mq").match(/interval/)?t.replace(/\bU\b/g,"cup"):t).match(/\S/)?"":b(t.replace(/^\s+/g,""),!1)[0]}}();function MQtoAM(t,e){var u,p,n,l,a,o;if(t=(t=t.replace(/\\:/g," ")).replace(/\\operatorname{(\w+)}/g," $1"),e)t=t.replace(/\\Re/g,"RR");else{for(;-1!=(o=t.lastIndexOf("\\left|"));)t=-1!=(p=t.indexOf("\\right|",o+1))?(n=t.substring(0,o).match(/(arcsinh|arccosh|arctanh|arcsech|arccsch|arccoth|arcsin|arccos|arctan|arcsec|arccsc|arccot|sinh|cosh|tanh|sech|csch|coth|ln|log|exp|sin|cos|tan|sec|csc|cot)(\^\d+)?$/),(t=t.substring(0,p)+")"+(n?")":"")+t.substring(p+7)).substring(0,o)+(n?"(":"")+"abs("+t.substring(o+6)):t.substring(0,o)+"|"+t.substring(o+6);t=(t=(t=(t=(t=t.replace(/\\text{\s*or\s*}/g," or ")).replace(/\\text{all\s+real\s+numbers}/g,"all real numbers")).replace(/\\text{DNE}/g,"DNE")).replace(/\\varnothing/g,"DNE")).replace(/\\Re/g,"all real numbers")}for(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/\\begin{.?matrix}(.*?)\\end{.?matrix}/g,function(t,e){return"[("+e.replace(/\\\\/g,"),(").replace(/&/g,",")+")]"})).replace(/\\le(?=(\b|\d))/g,"<=")).replace(/\\ge(?=(\b|\d))/g,">=")).replace(/\\ne(?=(\b|\d))/g,"!=")).replace(/\+\-/g,"+ -")).replace(/\\pm/g,"+-")).replace(/\\approx/g,"~~")).replace(/(\\arrow|\\rightarrow)/g,"rarr")).replace(/\\rightleftharpoons/g,"rightleftharpoons")).replace(/\\sim/g,"~")).replace(/\\vee/g,"vv").replace(/\\wedge/g," ^^ ")).replace(/\\Rightarrow/g,"=>").replace(/\\Leftrightarrow/g,"<=>")).replace(/\\times/g,"xx")).replace(/\\left\\{/g,"lbrace").replace(/\\right\\}/g,"rbrace")).replace(/\\left/g,"")).replace(/\\right/g,"")).replace(/\\langle/g,"<<")).replace(/\\rangle/g,">>")).replace(/\\cdot/g,"*")).replace(/\\infty/g,"oo")).replace(/\\nthroot/g,"root")).replace(/\\mid/g,"|")).replace(/\\/g,"")).replace(/sqrt\[(.*?)\]/g,"root($1)")).replace(/(\d)frac/g,"$1 frac")).replace(/degree/g,"degree ");-1!=(o=t.indexOf("frac{"));){for(u=1,l=o+5;0<u&&l<t.length-1;)l++,"{"==(a=t.charAt(l))?u++:"}"==a&&u--;t=0==u?t.substring(0,o)+"("+t.substring(o+5,l)+")/"+t.substring(l+1):t.substring(0,o)+t.substring(o+4)}return(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/_(\w)(\w)/g,"_$1 $2")).replace(/(\^|_)([+\-])([^\^])/g,"$1$2 $3")).replace(/\^(\w)(\w)/g,"^$1 $2")).replace(/_{([\d\.]+)}\^/g,"_$1^")).replace(/_{([\d\.]+)}([^\^])/g,"_$1 $2")).replace(/_{([\d\.]+)}$/g,"_$1")).replace(/_{(\w+)}$/g,"_($1)")).replace(/{/g,"(").replace(/}/g,")")).replace(/lbrace/g,"{").replace(/rbrace/g,"}")).replace(/\(([\d\.]+)\)\/\(([\d\.]+)\)/g,"$1/$2 ")).replace(/\/\(([\d\.]+)\)/g,"/$1")).replace(/\(([\d\.]+)\)\//g,"$1/")).replace(/\/\(([a-zA-Z])\)/g,"/$1")).replace(/\(([a-zA-Z])\)\//g,"$1/")).replace(/\^\((-?[\d\.]+)\)(\d)/g,"^$1 $2")).replace(/\^\(-1\)/g,"^-1")).replace(/\^\((-?[\d\.]+)\)/g,"^$1")).replace(/\/\(([a-zA-Z])\^([\d\.]+)\)/g,"/$1^$2 ")).replace(/\(([a-zA-Z])\^([\d\.]+)\)\//g,"$1^$2/")).replace(/text\(([^)]*)\)/g,"$1")).replace(/\(\s*(\w)/g,"($1").replace(/(\w)\s*\)/g,"$1)")).replace(/^\s+|\s+$/g,"")}
var MQeditor=function(h){var p,f,u,y,g,q,b,w;function v(){try{return window.self!==window.top}catch(t){return 1}}function s(a,t,e){var s,o,n,r,l,i,c,d,m,u;if("string"==typeof a&&(a=document.getElementById(a)),t="boolean"==typeof t?t:"hidden"!=a.type,s=a.id,o=a.getAttribute("data-mq")||"",!0===t){if(t=h(a).attr("type","hidden").val(),p.hasOwnProperty("toMQ")&&(t=p.toMQ(t,s)),0==(n=h("#mqinput-"+s)).length){if(r=h("<span/>",{id:"mqinput-"+s,class:"mathquill-math-field",text:t,"aria-label":a.getAttribute("aria-label")}),null!==(l=a.className.match(/(ansred|ansyel|ansgrn|ansorg)/))&&r.addClass(l[0]),o.match(/chem/)&&r.addClass("mq-chem"),l=a.hasAttribute("size")?3<a.size?a.size/1.8:a.size:10,r.css("min-width",l+"em"),r.insertAfter(a),i={handlers:{edit:O,enter:x}},p.hasOwnProperty("getLayoutstyle")?p.curlayoutstyle=p.getLayoutstyle():"auto"==p.layoutstyle?p.curlayoutstyle=E():p.curlayoutstyle=p.layoutstyle,"OSK"==p.curlayoutstyle&&(i.substituteTextarea=function(){var t=document.createElement("span");return t.setAttribute("tabindex",0),t},i.keyboardPassthrough=!0),o.match(/chem/)&&(i.charsThatBreakOutOfSupSubVar="",i.charsThatBreakOutOfSupSubOp="",i.autoSubscriptNumerals=!0),o.match(/list/)&&(i.charsThatBreakOutOfSupSub="=<>,"),o.match(/allowplusminus/)&&(i.quickplusminus=!0),i.autoOperatorNames=i.autoParenOperators="ln log abs exp sin cos tan arcsinh arccosh arctanh arcsech arccsch arccoth argsinh argcosh argtanh argsech argcsch argcoth arsinh arcosh artanh arsech arcsch arcoth arcsin arccos arctan sec csc cot arcsec arccsc arccot sinh cosh sech csch tanh coth",i.autoCommands="pi theta root sqrt ^oo degree",o.match(/logic/)&&(i.autoCommands+=" neg xor or and implies iff"),o.match(/setexp/)&&(i.autoCommands+=" nn xor uu ominus cap cup oplus"),""!=(c=a.getAttribute("data-mq-vars")||""))for(c=""==c?[]:c.split(/,/),m=0;m<c.length;m++)for(d=c[m].split(/_/),u=0;u<d.length;u++)1<d[u].length&&d[u].match(/^[a-zA-Z]+$/)&&(-1!=w.indexOf(d[u].toLowerCase())?i.autoCommands+=" "+d[u]:i.autoOperatorNames+=" "+d[u]);a.disabled?(n=b.StaticMath(r[0]),r.addClass("disabled")):(n=b.MathField(r[0],i).config(f),C(r),h(a).on("change.mqed",function(t,e){e||(e=a.value,p.hasOwnProperty("toMQ")&&(e=p.toMQ(e,a.id)),n.latex(e))}))}else n.show(),n=b(n[0]).latex(t);!0!==e&&n.focus()}else h(a).attr("type","text").off("change.mqed"),!0!==e&&h(a).focus(),h("#mqinput-"+s).hide()}function C(t){h(t).find(".mq-textarea > *").on("focus.mqeditor",e).on("blur.mqeditor",function(){g=setTimeout(a,100),p.hasOwnProperty("onBlur")&&p.onBlur()}),h(t).on("click.mqeditor",function(t){var e=h(t.target).closest("label");if(0<e.length)return"undefined"!==e.attr("for")&&h("#"+e.attr("for")).prop("checked",!0),t.stopPropagation(),!1})}function e(t){var a,e;if(clearTimeout(g),a=h(t.target).closest(".mathquill-math-field"),!1===u&&(h("body").append(h("<div/>",{id:"mqeditor",class:"mqeditor"})),h("#mqeditor").on("mousedown touchstart",function(t){t.preventDefault()}),u=!0),t=p.curlayoutstyle,p.hasOwnProperty("getLayoutstyle")?p.curlayoutstyle=p.getLayoutstyle():"auto"==p.layoutstyle?p.curlayoutstyle=E():p.curlayoutstyle=p.layoutstyle,"OSK"===p.curlayoutstyle?(v()?h("#mqeditor").addClass("iframeosk").removeClass("fixedbottom"):h("#mqeditor").addClass("fixedbottom").removeClass("iframeosk"),document.getElementById("mqe-fb-spacer")||((e=document.createElement("div")).style.height="200px",e.id="mqe-fb-spacer",h("body").append(e))):h("#mqeditor").removeClass("fixedbottom iframeosk"),h("#mqeditor").toggleClass("mq-chem",h(a).hasClass("mq-chem")),e=!1,null===y||a[0]!=y.el()||t!==p.curlayoutstyle){if(e=!0,null!==y&&h("#"+y.el().id.substring(8)).trigger("change",!0),p.hasOwnProperty("getLayout")&&(p.layout=p.getLayout(a[0],p.curlayoutstyle)),h("#mqeditor").empty().show(),p.layout.tabs){var s,o,n,r,l,i,t=document.getElementById("mqeditor"),c=p.layout,d="mqeditor";for((s=document.createElement("div")).className="mqed-row mqed-tabrow",o=document.createElement("div"),0,t.appendChild(s),t.appendChild(o),l=0;l<c.tabs.length;l++)if(!0===c.tabs[l].enabled)for(P(s,c.tabs[l],d+"-"+l),(r=document.createElement("div")).className="mqed-row mqed-tabpanel",r.id=d+"-"+l+"-tabpanel",o.appendChild(r),i=0;i<c.tabs[l].tabcontent.length;i++)(n=c.tabs[l].tabcontent[i]).hasOwnProperty("flow")&&0==n.contents.length||(n.hasOwnProperty("flow")?T:P)(r,n,d+"-"+l+"-"+i);P(s,{s:1}),P(s,{p:"&times;",c:"close",lb:"close"}),h(t).find(".mqed-tab").first().addClass("mqed-activetab")}else T(document.getElementById("mqeditor"),p.layout,"mqeditor");h("#mqeditor .mqed-btn.rend").each(function(){b.StaticMath(this,{mouseEvents:!1})}),0<h("#mqeditor .mqed-tabrow").length&&(h("#mqeditor .mqed-tabpanel").hide().first().show(),(t=h("#mqeditor .mqed-tabrow + div")).css("height",t.height()))}"OSK"!==p.curlayoutstyle||v()?h("#mqeditor").show():h("#mqeditor").slideDown(50,function(){var t=h("#mqeditor").height()+5,e=h(window).height()-(a.offset().top+a.outerHeight()-h(window).scrollTop());e<t&&h(window).scrollTop(h(window).scrollTop()+(t-e))}),k(a),y=b.MathField(a[0]),h("#"+a[0].id.substring(8)).triggerHandler("focus"),p.hasOwnProperty("onShow")&&p.onShow(a[0],p.curlayoutstyle,e),h(document).trigger("mqeditor:show")}function a(t){y&&(h(document).trigger("mqeditor:hide"),"OSK"!==p.curlayoutstyle||v()?h("#mqeditor").hide():h("#mqeditor").slideUp(50),h("#"+y.el().id.substring(8)).trigger("change",!0),y=null)}function k(t){var e,a,s;"under"==p.curlayoutstyle||v()?(e=(t=h(t).closest(".mathquill-math-field")).offset(),t=t.outerHeight(),a=e.left,document.getElementById("mqeditor")&&a+(s=document.getElementById("mqeditor").offsetWidth)>document.documentElement.clientWidth&&(a=document.documentElement.clientWidth-s-5),v()?h("#mqeditor").css("top",e.top+t+3).css("left",0):h("#mqeditor").css("top",e.top+t+3).css("left",a)):h("#mqeditor").css("top","auto").css("left",0)}function O(t){var e=t.el();k(e),p.hasOwnProperty("onResize")&&p.onResize(e,p.curlayoutstyle),e.id.match(/mqinput/)&&(t=t.latex(),p.hasOwnProperty("fromMQ")&&(t=p.fromMQ(t,e.id)),h("#"+e.id.substring(8)).val(t).trigger("input"),""!=t&&h("#"+e.id.substring(8)).siblings("input[id^=qs][value=spec]").prop("checked",!0),p.hasOwnProperty("onEdit"))&&p.onEdit(e.id,t)}function x(t){p.hasOwnProperty("onEnter")&&p.onEnter(t.el().id)}function E(){var t=document.documentElement.clientWidth;return navigator.userAgent.match(/Android/)||navigator.userAgent.match(/iPhone/)||navigator.userAgent.match(/iPad/)||t<500?"OSK":"under"}function T(t,e,a){var s,o,n,r,l,i,c=e.flow,d=100;for(e.hasOwnProperty("s")&&"row"==c&&(d=e.s),s=document.createElement("div"),e.hasOwnProperty("s")&&(s.style.flexGrow=e.s),e.hasOwnProperty("class")&&(s.className=e.class),e.hasOwnProperty("tabpanel")&&(s.id=e.tabpanel.id,s.style.display=e.tabpanel.hidden?"none":""),(o=document.createElement("div")).className="mqed-"+c,i=l=n=0;i<e.contents.length;i++)(r=e.contents[i]).hasOwnProperty("flow")&&0==r.contents.length||(d<n+(l=r.hasOwnProperty("s")?r.s:1)&&(s.appendChild(o),n=0,(o=document.createElement("div")).className="mqed-"+c),(r.hasOwnProperty("flow")?T:P)(o,r,a+"-"+i),n+=l);s.appendChild(o),t.appendChild(s)}function P(t,e,a){var s,o,n,r,l=document.createElement("div");l.className="mqed-btn-cont",e.s&&(l.style.flexGrow=e.s),e.contid&&(l.id=e.contid),e.contclass&&h(l).addClass(e.contclass),t.appendChild(l),(e.l||e.b||e.p)&&((t=document.createElement("span")).tabIndex=0,e.l?(e.op?(t.className="mqed-btn mq-math-mode",t.innerHTML='<span class="mq-root-block"><var class="mq-operator-name">'+e.l.substring(1)+"</var></span>"):e.pr?(t.className="mqed-btn mq-math-mode",t.innerHTML='<span class="mq-root-block">'+e.pr+"</span>"):e.l.match(/\\left(.)\\right(.)/)?(o=e.l.match(/\\left(.)\\right(.)/),t.className="mqed-btn mq-math-mode",t.innerHTML='<span class="mq-non-leaf"><span class="mq-scaled mq-paren" style="transform: scale(1, 1.2);">'+o[1]+'</span><span class="mq-non-leaf mq-empty"></span><span class="mq-scaled mq-paren" style="transform: scale(1, 1.2);">'+o[2]+"</span></span>"):(t.className="mqed-btn rend",t.innerText=e.l),o="c",s=e.l.substring(1)):e.b?(e.r?(t.className="mqed-btn rend",t.innerHTML=e.b):(t.className="mqed-btn mq-math-mode",e.v?t.innerHTML='<span class="mq-root-block"><var>'+e.b+"</var></span>":t.innerHTML='<span class="mq-root-block"><span>'+e.b+"</span></span>"),o="t",!(s=e.b).match(/^\d$/)&&"."!=s||h(t).addClass("mqed-digitkey")):(t.className="mqed-btn",t.innerHTML=e.p,o="t",s=e.p),e.c&&("shift"==(o=e.c)?h(t).addClass("mqed-shift"):"k"==o?h(t).addClass("mqed-navkey"):"close"==o&&h(t).addClass("mqed-closebtn")),e.lb&&t.setAttribute("aria-label",e.lb),e.sm&&(t.style.fontSize=100-10*e.sm+"%"),e.w&&(s=e.w),e.tabcontent&&(h(t).addClass("mqed-tab"),o="showtabpanel",s=a+"-tabpanel"),h(t).data("cmdtype",o).data("cmdval",s),h(t).on("click mousedown touchstart keydown",(n=o,r=s,function(t){!function t(e,a,s){var o,n,r,l,i,c,d;{if("mousedown"==e.type&&"Backspace"!==s)return;if("click"==e.type&&"Backspace"===s)return}if("keydown"==e.type&&"Enter"!==e.key)return;"touchstart"==e.type&&(e.preventDefault(),h(e.currentTarget).addClass("mactive"));if("t"==a)s.match(/^[a-zA-Z]$/)&&h(e.target).closest(".mqed-tabpanel").find(".mqed-shift").hasClass("active")&&(s=s.toUpperCase()),y.typedText(s);else if("c"==a)y.cmd(s);else if("l"==a)y.latex(s);else if("w"==a){if(y.write(s),m=s.match(/bmatrix}(.*?)(\\\\|\\end{bm)/))for(o=m[1].split(/&/).length,n=0;n<o;n++)y.keystroke("Left")}else"k"==a?(y.keystroke(s),"Backspace"===s&&(q=setTimeout(function(){t(e,a,s)},null===q?600:70))):"m"==a?y.matrixCmd(s):"f"==a?(r=y.getSelection())?(y.write(s+"\\left("+r+"\\right)"),y.keystroke("Left")):s.match(/{}$/)?y.typedText(s.replace(/{}$/,"")):y.write(s):"sf"==a?((r=y.getSelection())?y.write(s+"{"+r+"}"):y.cmd(s),y.keystroke("Left")):"i"==a?(r=(r=y.getSelection())||"","string"==typeof s?(c=s.charAt(0),l=s.charAt(1),y.write("\\left"+c+r+"\\right"+l)):y.write(s[0]+r+s[1]),""==r&&y.keystroke("Left")):"showtabpanel"==a?((i=h(e.target).closest(".mqed-btn")).closest(".mqeditor").find(".mqed-tabpanel").hide(),i.closest(".mqeditor").find(".mqed-btn.mqed-activetab").removeClass("mqed-activetab"),h("#"+s).show(),i.addClass("mqed-activetab"),p.hasOwnProperty("onTab")&&p.onTab(i[0],p.curlayoutstyle,s)):"shift"==a?(i=h(e.target).closest(".mqed-btn"),c=h(e.target).closest(".mqed-tabpanel"),d=!i.hasClass("active"),d?i.addClass("active"):i.removeClass("active"),c.find(".mqed-btn").each(function(t,e){var a=e.textContent;a.match(/^[a-zA-Z]$/)&&(e.textContent=d?e.textContent.toUpperCase():e.textContent.toLowerCase())})):"close"==a&&y.blur()}(t,n,r)})).on("touchend",function(t){setTimeout(function(){h(t.currentTarget).removeClass("mactive")},50)}).on("touchend mouseup",function(){clearTimeout(q),q=null}),l.appendChild(t))}return p={layoutstyle:"auto",layout:[]},u=!(f={}),q=g=y=null,b=MathQuill.getInterface(MathQuill.getInterface.MAX),w=["alpha","beta","chi","delta","epsilon","gamma","varphi","phi","psi","sigma","rho","theta","lambda","mu","nu","omega","tau"],{setConfig:function(t){for(var e in t)p[e]=t[e]},setMQconfig:function(t){f=t},toggleMQ:s,toggleMQAll:function(t,e){var a=e||null;h(t).each(function(t,e){s(e,a,!0)})},attachEditor:C,getLayoutstyle:E,resetEditor:function(){clearTimeout(g),h("#mqeditor").hide(),y=null}}}(jQuery);
var MQ,myMQeditor=function(m){var e,l;return l={tabs:[{p:"Basic",enabled:!0,tabcontent:[{flow:"row",s:5,contents:[{l:"\\frac{}{}",c:"t",w:"/",pr:'<span class="mq-fraction mq-non-leaf"><span class="mq-numerator mq-empty"></span><span class="mq-denominator mq-empty"></span><span style="display:inline-block;width:0">&#8203;</span></span>'},{l:"x^{}",c:"t",w:"^",nb:1,pr:'<var>x</var><span class="mq-supsub mq-non-leaf mq-sup-only"><span class="mq-sup mq-empty"></span></span>'},{l:"x_{}",c:"t",w:"_",nb:1,pr:'<var>x</var><span class="mq-supsub mq-non-leaf"><span class="mq-sub mq-empty"></span></span>'},{l:"\\sqrt{}",c:"c",w:"sqrt",nb:1,pr:'<span class="mq-non-leaf"><span class="mq-scaled mq-sqrt-prefix" style="transform: scale(1, 0.955556);">√</span><span class="mq-non-leaf mq-sqrt-stem mq-empty"></span></span>'},{l:"\\sqrt[n]{}",c:"c",w:"nthroot",nb:1,pr:'<sup class="mq-nthroot mq-non-leaf"><var>n</var></sup><span class="mq-scaled"><span class="mq-sqrt-prefix mq-scaled" style="transform: scale(1, 0.955556);">√</span><span class="mq-sqrt-stem mq-non-leaf mq-empty"></span></span>'},{l:"\\left(\\right)",c:"i",w:"()"},{l:"\\left|\\right|",c:"i",w:"||"},{l:"\\pi",nb:1,pr:'<span class="mq-nonSymbola">π</span>'},{l:"\\infty",pr:"<span>∞</span>"},{p:"DNE",sm:2}]},{s:.1},{flow:"row",s:2,contents:[{b:"&uarr;",c:"k",w:"Up"},{b:"&darr;",c:"k",w:"Down"},{b:"&larr;",c:"k",w:"Left"},{b:"&rarr;",c:"k",w:"Right"},{b:"&#x232B;",s:2,c:"k",w:"Backspace"}]}]},{p:"Funcs",enabled:!(e={tabs:[{p:"Basic",enabled:!0,tabcontent:[{flow:"row",s:2,contents:[{l:"\\left(\\right)",c:"i",w:"()",pr:'<span class="mq-non-leaf"><span class="mq-scaled mq-paren" style="transform: scale(1, 1.2);">(</span><span class="mq-non-leaf mq-empty"></span><span class="mq-scaled mq-paren" style="transform: scale(1, 1.2);">)</span></span>'},{l:"x^{}",c:"t",w:"^",nb:1,pr:'<var>x</var><span class="mq-supsub mq-non-leaf mq-sup-only"><span class="mq-sup mq-empty"></span></span>'},{l:"\\pi",nb:1,pr:'<span class="mq-nonSymbola">π</span>'},{l:"\\sqrt{}",c:"c",w:"sqrt",nb:1,pr:'<span class="mq-non-leaf"><span class="mq-scaled mq-sqrt-prefix" style="transform: scale(1, 0.955556);">√</span><span class="mq-non-leaf mq-sqrt-stem mq-empty"></span></span>'},{l:"x_{}",c:"t",w:"_",nb:1,pr:'<var>x</var><span class="mq-supsub mq-non-leaf"><span class="mq-sub mq-empty"></span></span>'},{l:"\\sqrt[n]{}",c:"c",w:"nthroot",nb:1,pr:'<sup class="mq-nthroot mq-non-leaf"><var>n</var></sup><span class="mq-scaled"><span class="mq-sqrt-prefix mq-scaled" style="transform: scale(1, 0.955556);">√</span><span class="mq-sqrt-stem mq-non-leaf mq-empty"></span></span>'},{p:"DNE",sm:2},{l:"\\left|\\right|",c:"i",w:"||"}]},{s:.1},{flow:"row",s:4,contents:[{b:"7"},{b:"8"},{b:"9"},{l:"\\frac{}{}",c:"t",w:"/",pr:'<span class="mq-fraction mq-non-leaf"><span class="mq-numerator mq-empty"></span><span class="mq-denominator mq-empty"></span><span style="display:inline-block;width:0">&#8203;</span></span>'},{b:"4"},{b:"5"},{b:"6"},{b:"*"},{b:"1"},{b:"2"},{b:"3"},{b:"-"},{b:"0"},{b:"."},{s:1},{b:"+"}]},{s:.1},{flow:"row",s:2,contents:[{s:.5},{b:"&uarr;",c:"k",w:"Up"},{s:.5},{b:"&larr;",c:"k",w:"Left"},{b:"&rarr;",c:"k",w:"Right"},{s:.5},{b:"&darr;",c:"k",w:"Down"},{s:.5},{b:"&#x232B;",s:2,c:"k",w:"Backspace"}]}]},{p:"Funcs",enabled:!1,tabcontent:[{flow:"row",s:4,contents:[{l:"\\log",c:"f",op:1},{l:"\\ln",c:"f",op:1},{l:"\\log_{}",c:"f",pr:'<var class="mq-operator-name">log</var><span class="mq-supsub mq-non-leaf"><span class="mq-sub mq-empty"></span></span>'},{l:"e^{}",c:"t",w:"e^",pr:'<var>e</var><span class="mq-supsub mq-non-leaf mq-sup-only"><span class="mq-sup mq-empty"></span></span>'}]}]},{p:"Trig",enabled:!1,tabcontent:[{flow:"row",s:6,contents:[{l:"\\sin",c:"f",op:1},{l:"\\cos",c:"f",op:1},{l:"\\tan",c:"f",op:1},{l:"\\sec",c:"f",op:1},{l:"\\csc",c:"f",op:1},{l:"\\cot",c:"f",op:1},{l:"\\sin^{-1}",c:"f",pr:'<var class="mq-operator-name">sin</var><span class="mq-supsub mq-non-leaf mq-sup-only"><span class="mq-sup">−1</span></span>'},{l:"\\cos^{-1}",c:"f",pr:'<var class="mq-operator-name">cos</var><span class="mq-supsub mq-non-leaf mq-sup-only"><span class="mq-sup">−1</span></span>'},{l:"\\tan^{-1}",c:"f",pr:'<var class="mq-operator-name">tan</var><span class="mq-supsub mq-non-leaf mq-sup-only"><span class="mq-sup">−1</span></span>'},{l:"\\sinh",c:"f",op:1},{l:"\\cosh",c:"f",op:1},{l:"\\tanh",c:"f",op:1},{l:"\\pi",nb:1,pr:'<span class="mq-nonSymbola">π</span>'},{s:1},{s:4}]}]},{p:"Inequality",enabled:!1,tabcontent:[{flow:"row",s:4,contents:[{l:"\\lt",pr:'<span class="mq-binary-operator">&lt;</span>'},{l:"\\gt",pr:'<span class="mq-binary-operator">&gt;</span>'},{l:"\\le",pr:'<span class="mq-binary-operator">&le;</span>'},{l:"\\ge",pr:'<span class="mq-binary-operator">&ge;</span>'},{l:"\\ne",pr:'<span class="mq-binary-operator">&ne;</span>'},{p:"or",c:"w",w:"\\text{ or }"},{p:"DNE",sm:2},{p:"all reals",c:"w",w:"\\text{all reals}",sm:2}]}]},{p:"Interval",enabled:!1,tabcontent:[{flow:"row",s:4,contents:[{l:"\\left(\\right)",c:"i",w:"()"},{l:"\\left[\\right]",c:"i",w:"[]"},{l:"\\left(\\right]",c:"i",w:"(]"},{l:"\\left[\\right)",c:"i",w:"[)"},{l:"\\infty",pr:"<span>∞</span>"},{l:"-\\infty",c:"w",w:"-\\infty",pr:"<span>−∞</span>"},{l:"\\cup",pr:'<span class="mq-binary-operator">∪</span>'},{s:1}]}]},{p:"Matrix",sm:1,enabled:!1,tabcontent:[{flow:"row",s:4,contents:[{p:"2×2",c:"w",w:"\\begin{bmatrix}&\\\\&\\end{bmatrix}"},{p:"2×3",c:"w",w:"\\begin{bmatrix}&&\\\\&&\\end{bmatrix}"},{p:"3×3",c:"w",w:"\\begin{bmatrix}&&\\\\&&\\\\&&\\end{bmatrix}"},{p:"3×4",c:"w",w:"\\begin{bmatrix}&&&\\\\&&&\\\\&&&\\end{bmatrix}"},{p:"+Col",c:"m",w:"addColumn"},{p:"-Col",c:"m",w:"deleteColumn"},{p:"+Row",c:"m",w:"addRow"},{p:"-Row",c:"m",w:"deleteRow"}]}]},{p:"=<%",enabled:!0,tabcontent:[{flow:"row",s:5,contents:[{p:"[",s:.5},{p:"]",s:.5},{p:"{",s:.5},{p:"}",s:.5},{p:"(",s:.5},{p:")",s:.5},{l:"\\left\\langle\\right\\rangle",c:"i",w:["\\left\\langle","\\right\\rangle"]},{l:"\\left|\\right|",c:"i",w:"||"},{p:"="},{l:"\\lt",pr:'<span class="mq-binary-operator">&lt;</span>'},{l:"\\gt",pr:'<span class="mq-binary-operator">&gt;</span>'},{l:"\\le",pr:'<span class="mq-binary-operator">&le;</span>'},{l:"\\ge",pr:'<span class="mq-binary-operator">&ge;</span>'},{p:"%"},{p:","},{l:"\\infty",pr:"<span>∞</span>"},{p:"!"},{p:"?"}]}]},{p:"ABC",enabled:!0,tabcontent:[{flow:"row",s:10,contents:[{p:"q"},{p:"w"},{p:"e"},{p:"r"},{p:"t"},{p:"y"},{p:"u"},{p:"i"},{p:"o"},{p:"p"},{s:.5},{p:"a"},{p:"s"},{p:"d"},{p:"f"},{p:"g"},{p:"h"},{p:"j"},{p:"k"},{p:"l"},{s:.5},{b:"&#8679;",c:"shift",s:1.5},{p:"z"},{p:"x"},{p:"c"},{p:"v"},{p:"b"},{p:"n"},{p:"m"},{b:"&#x232B;",c:"k",w:"Backspace",s:1.5},{p:"%"},{p:","},{p:"Space",s:5,c:"t",w:" "},{p:"."},{b:"&larr;",c:"k",w:"Left"},{b:"&rarr;",c:"k",w:"Right"}]}]}]}),tabcontent:[{flow:"row",s:4,contents:[{l:"\\log",c:"f",op:1},{l:"\\ln",c:"f",op:1},{l:"\\log_{}",c:"f",pr:'<var class="mq-operator-name">log</var><span class="mq-supsub mq-non-leaf"><span class="mq-sub mq-empty"></span></span>'},{l:"e^{}",c:"t",w:"e^",pr:'<var>e</var><span class="mq-supsub mq-non-leaf mq-sup-only"><span class="mq-sup mq-empty"></span></span>'}]}]},{p:"Trig",enabled:!1,tabcontent:[{flow:"row",s:6,contents:[{l:"\\sin",c:"f",op:1},{l:"\\cos",c:"f",op:1},{l:"\\tan",c:"f",op:1},{l:"\\sec",c:"f",op:1},{l:"\\csc",c:"f",op:1},{l:"\\cot",c:"f",op:1},{l:"\\sin^{-1}",c:"f",pr:'<var class="mq-operator-name">sin</var><span class="mq-supsub mq-non-leaf mq-sup-only"><span class="mq-sup">−1</span></span>'},{l:"\\cos^{-1}",c:"f",pr:'<var class="mq-operator-name">cos</var><span class="mq-supsub mq-non-leaf mq-sup-only"><span class="mq-sup">−1</span></span>'},{l:"\\tan^{-1}",c:"f",pr:'<var class="mq-operator-name">tan</var><span class="mq-supsub mq-non-leaf mq-sup-only"><span class="mq-sup">−1</span></span>'},{l:"\\sinh",c:"f",op:1},{l:"\\cosh",c:"f",op:1},{l:"\\tanh",c:"f",op:1},{l:"\\pi",nb:1,pr:'<span class="mq-nonSymbola">π</span>'},{s:1},{s:4}]}]},{p:"Inequality",enabled:!1,tabcontent:[{flow:"row",s:4,contents:[{l:"\\lt",pr:'<span class="mq-binary-operator">&lt;</span>'},{l:"\\gt",pr:'<span class="mq-binary-operator">&gt;</span>'},{l:"\\le",pr:'<span class="mq-binary-operator">&le;</span>'},{l:"\\ge",pr:'<span class="mq-binary-operator">&ge;</span>'},{l:"\\ne",pr:'<span class="mq-binary-operator">&ne;</span>'},{p:"or",c:"w",w:"\\text{ or }"},{p:"DNE",sm:2},{p:"all reals",c:"w",w:"\\text{all reals}",sm:2}]}]},{p:"Interval",enabled:!1,tabcontent:[{flow:"row",s:4,contents:[{l:"\\left(\\right)",c:"i",w:"()"},{l:"\\left[\\right]",c:"i",w:"[]"},{l:"\\left(\\right]",c:"i",w:"(]"},{l:"\\left[\\right)",c:"i",w:"[)"},{l:"\\infty",pr:"<span>∞</span>"},{l:"-\\infty",c:"w",w:"-\\infty",pr:"<span>−∞</span>"},{l:"\\cup",pr:'<span class="mq-binary-operator">∪</span>'},{s:1}]}]},{p:"Matrix",sm:1,enabled:!1,tabcontent:[{flow:"row",s:4,contents:[{p:"2×2",c:"w",w:"\\begin{bmatrix}&\\\\&\\end{bmatrix}"},{p:"2×3",c:"w",w:"\\begin{bmatrix}&&\\\\&&\\end{bmatrix}"},{p:"3×3",c:"w",w:"\\begin{bmatrix}&&\\\\&&\\\\&&\\end{bmatrix}"},{p:"3×4",c:"w",w:"\\begin{bmatrix}&&&\\\\&&&\\\\&&&\\end{bmatrix}"},{p:"+Col",c:"m",w:"addColumn"},{p:"-Col",c:"m",w:"deleteColumn"},{p:"+Row",c:"m",w:"addRow"},{p:"-Row",c:"m",w:"deleteRow"}]}]}]},{getLayout:function(a,s){var n,t,a=a.id.substring(8),p=(a=m("#"+a)).attr("data-mq-vars")||"";return p=""==p?[]:p.split(/,/),n=(a=a.attr("data-mq")).split(/,/)[0],t=[],"OSK"===s?(t=m.extend(!0,[],e),a.match(/\bdecimal/)&&"numfunc"!=n?(t.tabs[0].tabcontent[0].s=1,t.tabs[0].tabcontent[0].contents=[{l:"\\infty",pr:"<span>∞</span>"},{p:"DNE",sm:2}],t.tabs[0].tabcontent[2]={flow:"row",s:4,contents:[{b:"7"},{b:"8"},{b:"9"},{s:1},{b:"4"},{b:"5"},{b:"6"},{s:1},{b:"1"},{b:"2"},{b:"3"},{b:"-"},{b:"0"},{b:"."},a.match(/(list|set\b)/)||n.match(/(ntuple|interval)/)?{b:","}:{s:1},"calcntuple"===n&&!a.match(/vector/)||a.match(/point/)?{l:"\\left(\\right)",c:"t",w:"("}:{s:1}]}):a.match(/(fraction|mixednumber|fracordec)/)&&"numfunc"!=n?(t.tabs[0].tabcontent[0].s=1,t.tabs[0].tabcontent[0].contents=[{l:"\\frac{n}{}",c:"t",w:"/",pr:'<span class="mq-fraction mq-non-leaf"><span class="mq-numerator"><var>n</var></span><span class="mq-denominator mq-empty"></span><span style="display:inline-block;width:0">&#8203;</span></span>'},{l:"\\frac{}{}",c:"c",w:"\\frac",pr:'<span class="mq-fraction mq-non-leaf"><span class="mq-numerator mq-empty"></span><span class="mq-denominator mq-empty"></span><span style="display:inline-block;width:0">&#8203;</span></span>'},{l:"\\infty",pr:"<span>∞</span>"},{p:"DNE",sm:2}],t.tabs[0].tabcontent[2]={flow:"row",s:4,contents:[{b:"7"},{b:"8"},{b:"9"},{s:1},{b:"4"},{b:"5"},{b:"6"},{s:1},{b:"1"},{b:"2"},{b:"3"},{b:"-"},{b:"0"},a.match(/fracordec/)?{b:"."}:{s:1},a.match(/(list|set\b)/)||n.match(/(ntuple|interval)/)?{b:","}:{s:1},"calcntuple"===n&&!a.match(/vector/)||a.match(/point/)?{l:"\\left(\\right)",c:"t",w:"("}:n.match(/complex/)?{b:"+"}:{s:1}]}):(a.match(/(list|set\b)/)||n.match(/(interval|string|ntuple)/)?t.tabs[0].tabcontent[2].contents[14]={b:","}:a.match(/equation/)&&(t.tabs[0].tabcontent[2].contents[14]={b:"="}),a.match(/nodecimal/)&&(t.tabs[0].tabcontent[2].contents[13]={s:1})),a.match(/allowplusminus/)&&(t.tabs[6].tabcontent[0].contents[17]={l:"\\pm",pr:'<span class="mq-binary-operator">&plusmn;</span>'}),a.match(/inequality/)&&(t.tabs[3].p="Ineq")):(t=m.extend(!0,[],l),a.match(/\bdecimal/)?(t.tabs[0].tabcontent[0].s=3,t.tabs[0].tabcontent[0].contents=[{l:"\\infty",pr:"<span>∞</span>"},{p:"DNE",sm:2},"calcntuple"===n&&!a.match(/vector/)||a.match(/point/)?{l:"\\left(\\right)",c:"t",w:"("}:{s:1}]):a.match(/(fraction|mixednumber|fracordec)/)&&(t.tabs[0].tabcontent[0].s=4,t.tabs[0].tabcontent[0].contents=[{l:"\\frac{n}{}",c:"t",w:"/",pr:'<span class="mq-fraction mq-non-leaf"><span class="mq-numerator"><var>n</var></span><span class="mq-denominator mq-empty"></span><span style="display:inline-block;width:0">&#8203;</span></span>'},{l:"\\frac{}{}",c:"c",w:"\\frac",pr:'<span class="mq-fraction mq-non-leaf"><span class="mq-numerator mq-empty"></span><span class="mq-denominator mq-empty"></span><span style="display:inline-block;width:0">&#8203;</span></span>'},{l:"\\infty",pr:"<span>∞</span>"},{p:"DNE",sm:2}],"calcntuple"===n&&!a.match(/vector/)||a.match(/point/))&&t.tabs[0].tabcontent[0].contents.push({l:"\\left(\\right)",c:"t",w:"("},{s:3})),"numfunc"==n&&a.match(/inequality/)&&(t.tabs[3].enabled=!0,t.tabs[3].tabcontent[0].contents.splice(5,3),t.tabs[3].tabcontent[0].s=5),a.match(/(fraction|mixednumber|fracordec|\bdecimal|logic|setexp|chemeqn)/)||(t.tabs[1].enabled=!0,a.match(/notrig/))||(t.tabs[2].enabled=!0,a.match(/allowdegrees/)&&(t.tabs[2].tabcontent[0].contents[13]={l:"\\degree"})),n.match(/interval/)?a.match(/inequality/)?t.tabs[3].enabled=!0:t.tabs[4].enabled=!0:!n.match(/matrix/)&&!a.match(/matrix/)||a.match(/matrixsized/)?a.match(/set\b/)?t.tabs[0].tabcontent.unshift({flow:"row",s:1,contents:[{l:"\\lbrace{\\rbrace}",c:"i",w:["\\left\\{","\\right\\}"]}]},{s:.1}):n.match(/complex/)?t.tabs[0].tabcontent.unshift({flow:"row",s:1,contents:[{b:a.match(/allowjcomplex/)?"j":"i",v:1}]},{s:.1}):a.match(/vector/)&&t.tabs[0].tabcontent.unshift({flow:"row",s:1,contents:[{l:"\\left\\langle\\right\\rangle",c:"i",w:["\\left\\langle","\\right\\rangle"]}]},{s:.1}):t.tabs[5].enabled=!0,a.match(/logic/)&&(t.tabs[0].p="Logic",t.tabs[0].tabcontent[0].contents=[{l:"\\vee",pr:'<span class="mq-binary-operator">∨</span>'},{l:"\\wedge",pr:'<span class="mq-binary-operator">∧</span>'},{l:"\\oplus",pr:'<span class="mq-binary-operator">⊕</span>'},{l:"\\left(\\right)",c:"i",w:"()",pr:'<span class="mq-non-leaf"><span class="mq-scaled mq-paren" style="transform: scale(1, 1.2);">(</span><span class="mq-non-leaf mq-empty"></span><span class="mq-scaled mq-paren" style="transform: scale(1, 1.2);">)</span></span>'},{l:"\\neg",pr:"¬"},{b:"~"},{l:"\\implies",pr:'<span class="mq-binary-operator">⇒</span>'},{l:"\\iff",pr:'<span class="mq-binary-operator">⇔</span>'}],"OSK"!==s)&&(t.tabs[0].tabcontent[0].s=4),a.match(/setexp/)&&(t.tabs[0].p="Set Exp",t.tabs[0].tabcontent[0].contents=[{l:"\\cup",pr:'<span class="mq-binary-operator">∪</span>'},{l:"\\cap",pr:'<span class="mq-binary-operator">∩</span>'},{l:"\\^c",c:"w",pr:'<span class="mq-non-leaf mq-empty"></span><sup class="mq-binary-operator">c</sup>'},{l:"\\ominus",pr:'<span class="mq-binary-operator">⊖</span>'},{l:"\\left(\\right)",c:"i",w:"()",pr:'<span class="mq-non-leaf"><span class="mq-scaled mq-paren" style="transform: scale(1, 1.2);">(</span><span class="mq-non-leaf mq-empty"></span><span class="mq-scaled mq-paren" style="transform: scale(1, 1.2);">)</span></span>'}],"OSK"!==s)&&(t.tabs[0].tabcontent[0].s=3),"chemeqn"==n&&(t.tabs[0].tabcontent[0].contents=[{l:"x_{}",c:"t",w:"_",nb:1,pr:'<var>x</var><span class="mq-supsub mq-non-leaf"><span class="mq-sub mq-empty"></span></span>'},{l:"x^{}",c:"t",w:"^",nb:1,pr:'<var>x</var><span class="mq-supsub mq-non-leaf mq-sup-only"><span class="mq-sup mq-empty"></span></span>'},{l:"\\left(\\right)",c:"i",w:"()",pr:'<span class="mq-non-leaf"><span class="mq-scaled mq-paren" style="transform: scale(1, 1.2);">(</span><span class="mq-non-leaf mq-empty"></span><span class="mq-scaled mq-paren" style="transform: scale(1, 1.2);">)</span></span>'}],a.match(/reaction/)&&t.tabs[0].tabcontent[0].contents.push({l:"\\to",pr:'<span class="mq-binary-operator">→</span>'},{l:"\\rightleftharpoons",pr:'<span class="mq-binary-operator">⇌</span>'}),"OSK"!==s)&&(t.tabs[0].tabcontent[0].s=3),0<p.length&&("basic"==(a=function(a,s){var n,t,p,e,l,r;for(n=1,t=[],s="OSK"==s?4:2,e=0;e<a.length;e++){for(p=a[e].split(/_/),l=0;l<p.length;l++)p[l]=p[l].replace(/\b(alpha|beta|chi|delta|epsilon|gamma|varphi|phi|psi|sigma|rho|theta|lambda|mu|nu|omega|tau)\b/i,"\\$&");a[e]=p.join("_"),("\\"!=a[e].charAt(0)||1<p.length)&&a[e].length>n&&(n=a[e].length),a[e]=a[e].replace(/_(\w{2,})/,"_{$1}"),1==a[e].length?t.push({b:a[e],c:"w",v:1}):t.push({l:a[e].replace(/(\\)?([a-zA-Z0-9]{2,})/g,function(a,s,n){return s?a:"\\text{"+n+"}"}),w:a[e],c:"w",r:1})}r=Math.min(8,Math.max(4,Math.ceil(a.length/4)));a.length%r!=0&&t.push({s:r-a.length%r});return{format:a.length<=s&&n<4?"basic":"tab",btns:t,perrow:r}}(p,s)).format?t.tabs[0].tabcontent.unshift({flow:"row",s:1,contents:a.btns},{s:.1}):t.tabs.splice(1,0,{p:"chemeqn"==n?"Atoms":"Vars",enabled:!0,tabcontent:[{flow:"row",s:a.perrow,contents:a.btns}]})),t},onShow:function(a,s,n){var t,p,e,l,r,c,o;n&&"under"===s?(t=a.id.substring(8),(p=m("#"+t))[0].hasAttribute("data-tip")&&(l=(e=m("#mqeditor .mqed-tabpanel").first()).children("div").last().position().left-12,o=p.attr("data-tip"),r=document.createElement("div"),m(r).html(o),p[0].hasAttribute("aria-describedby")&&(c=p[0].getAttribute("aria-describedby"),document.getElementById(c).textContent!=o)&&(o=m("<a>",{href:"#",text:_("[more..]")}).on("click",function(a){return a.preventDefault(),m(a.target).parent().html(m("#"+c).html()),!1}),m(r).append(" ").append(o)),e.parent().css("height","auto").append(m("<div>",{width:l,class:"mqed-tipholder"}).append(r)))):n&&"OSK"===s&&(t=a.id.substring(8),(p=m("#"+t))[0].hasAttribute("data-tip"))&&(o=t.substr(2).split(/-/)[0],reshrinkeh(a.id),showehdd(a.id,p[0].getAttribute("data-tip"),o))},onBlur:function(){hideeh()},onResize:function(a,s){"OSK"===s&&updateehpos()},onTab:function(a,s,n){"under"===s&&(n.match(/mqeditor-0-tabpanel/)?m(".mqed-tipholder").show():m(".mqed-tipholder").hide())}}}(jQuery);MQeditor.setConfig({getLayout:myMQeditor.getLayout,onShow:myMQeditor.onShow,onBlur:myMQeditor.onBlur,onResize:myMQeditor.onResize,onTab:myMQeditor.onTab,toMQ:AMtoMQ,fromMQ:MQtoAM,onEdit:imathasAssess.syntaxCheckMQ,onEnter:imathasAssess.handleMQenter}),(MQ=MathQuill.getInterface(MathQuill.getInterface.MAX)).config({spaceBehavesLikeTab:!0,leftRightIntoCmdGoes:"up",supSubsRequireOperand:!0,charsThatBreakOutOfSupSub:"=<>",charsThatBreakOutOfSupSubVar:"+-(",charsThatBreakOutOfSupSubOp:"+-(",restrictMismatchedBrackets:!0,autoCommands:"pi theta root sqrt ^oo degree",autoParenOperators:!0,addCommands:{oo:["VanillaSymbol","\\infty ","&infin;"],xor:["VanillaSymbol","\\oplus ","&oplus;"],uu:["VanillaSymbol","\\cup ","&cup;"],nn:["VanillaSymbol","\\cap ","&cap;"],rightleftharpoons:["BinaryOperator","\\rightleftharpoons ","&rlhar;"]}});
