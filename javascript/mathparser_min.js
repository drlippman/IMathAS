"use strict";function makeMathFunction(t,r,e,a,n){if(r=r||"",e=e||[],a=a||"",n=void 0!==n&&n,""===t.trim())return!1;try{var o=new MathParser(r,e,a,n);return o.parse(t),function(t){try{return o.evaluate(t)}catch(t){return Math.sqrt(-1)}}}catch(r){return console.error("Parse error on: "+t+". Error: "+r.message),!1}}function evalMathParser(t,r){if(r=void 0!==r&&r,""===t.trim())return Math.sqrt(-1);try{var e=new MathParser("",[],"",r);return e.parse(t),e.evaluate()}catch(r){return console.error("Parse error on: "+t+". Error: "+r.message),Math.sqrt(-1)}}function MathParser(t,r,e,a){this.functions=[],this.variables=[],this.funcvariables=[],this.operators={},this.tokens=[],this.operatorStack=[],this.operandStack=[],this.AST=[],this.regex="",this.funcregex="",this.numvarregex="",this.variableValues={},this.origstr="",this.docomplex=a,this.allowEscinot=!0,""!==t&&(this.variables=t.split("|").map((function(t){return t.trim()})).filter((function(t){return t.length>0}))),""!==e&&(this.funcvariables=e.split("|").map((function(t){return t.trim()})).filter((function(t){return t.length>0}))),this.variables.push("pi","e"),a&&(this.docomplex=!0,this.variables.push("i")),this.variables.sort((function(t,r){return r.length-t.length})),this.allowEscinot=-1===this.variables.indexOf("E"),r.length>0?this.functions=r:this.functions="funcvar,arcsinh,arccosh,arctanh,arcsech,arccsch,arccoth,arcsin,arccos,arctan,arcsec,arccsc,arccot,root,sqrt,sign,sinh,cosh,tanh,sech,csch,coth,abs,sin,cos,tan,sec,csc,cot,exp,log,div,ln".split(",");var n=this.functions.concat(this.variables,["degree","degrees"]);n.sort((function(t,r){return r.length-t.length})),this.regex=new RegExp("^("+n.map((function(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})).join("|")+")"),this.funcregex=new RegExp("("+this.functions.map((function(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})).join("|")+")","i"),this.numvarregex=new RegExp("^(\\d+\\.?\\d*|"+this.variables.map((function(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})).join("|")+")"),this.initializeOperators()}function factorial(t){if(t<0)return!1;if(0===t)return 1;for(let r=t-1;r>0;r--)t*=r;return t}function nthroot(t,r){if(0===t)return 0;if(Math.floor(r)!==r)return safepow(t,1/r);if(r%2==0&&t<0)throw new Error("Can't take even root of negative value");if(0===r)throw new Error("Can't take 0th root");return t<0?-1*Math.exp(1/r*Math.log(Math.abs(t))):Math.exp(1/r*Math.log(Math.abs(t)))}function funcvar(t,r){return r*Math.sin(r+t)}function safepow(t,r){if(0===t)return 0===r?(console.error("0^0 is undefined"),NaN):0;if("number"!=typeof t||"number"!=typeof r)return console.error("cannot evaluate powers with nonnumeric values"),NaN;if(t<0&&Math.floor(r)!==r){for(let e=3;e<50;e+=2)if(Math.abs(Math.round(e*r)-e*r)<1e-6)return Math.round(e*r)%2==0?Math.exp(r*Math.log(Math.abs(t))):-1*Math.exp(r*Math.log(Math.abs(t)));return console.error("invalid power for negative base"),NaN}return Math.pow(t,r)}function sec(t){var r=Math.cos(t);return Math.abs(r)<1e-16?NaN:1/r}function csc(t){var r=Math.sin(t);return Math.abs(r)<1e-16?NaN:1/r}function cot(t){var r=Math.tan(t);return Math.abs(r)<1e-16?NaN:1/r}function sech(t){var r=Math.cosh(t);return Math.abs(r)<1e-16?NaN:1/r}function csch(t){var r=Math.sinh(t);return Math.abs(r)<1e-16?NaN:1/r}function coth(t){var r=Math.tanh(t);return Math.abs(r)<1e-16?NaN:1/r}function asec(t){if(Math.abs(t)<1e-16)return NaN;var r=Math.round(1/t*1e12)/1e12;return Math.acos(r)}function acsc(t){if(Math.abs(t)<1e-16)return NaN;var r=Math.round(1/t*1e12)/1e12;return Math.asin(r)}function acot(t){return Math.abs(t)<1e-16?NaN:Math.atan(1/t)}function asech(t){if(Math.abs(t)<1e-16)return NaN;var r=Math.round(1/t*1e12)/1e12;return Math.acosh(r)}function acsch(t){if(Math.abs(t)<1e-16)return NaN;var r=Math.round(1/t*1e12)/1e12;return Math.asinh(r)}function acoth(t){if(Math.abs(t)<1e-16)return NaN;var r=Math.round(1/t*1e12)/1e12;return Math.atanh(r)}function cplx_subt(t,r){return[t[0]-r[0],t[1]-r[1]]}function cplx_mult(t,r){return[t[0]*r[0]-t[1]*r[1],t[0]*r[1]+t[1]*r[0]]}function cplx_div(t,r){var e=r[0]*r[0]+r[1]*r[1];if(0===e)throw new Error("Cannot divide by zero in complex division");return[(t[0]*r[0]+t[1]*r[1])/e,(t[1]*r[0]-t[0]*r[1])/e]}function cplx_sqrt(t){return cplx_nthroot(t,2)}function cplx_nthroot(t,r){var e=safepow(t[0]*t[0]+t[1]*t[1],r/(2*r)),a=Math.atan2(t[1],t[0]);return[e*Math.cos(a/r),e*Math.sin(a/r)]}function cplx_log(t,r=Math.E){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]),a=Math.atan2(t[1],t[0]);return[Math.log(e)/Math.log(r),a/Math.log(r)]}function cplx_exp(t){var r=Math.exp(t[0]);return[r*Math.cos(t[1]),r*Math.sin(t[1])]}function cplx_abs(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function cplx_sin(t){return[Math.sin(t[0])*Math.cosh(t[1]),Math.cos(t[0])*Math.sinh(t[1])]}function cplx_cos(t){return[Math.cos(t[0])*Math.cosh(t[1]),-1*Math.sin(t[0])*Math.sinh(t[1])]}function cplx_tan(t){return cplx_div(cplx_sin(t),cplx_cos(t))}function cplx_sec(t){return cplx_div([1,0],cplx_cos(t))}function cplx_csc(t){return cplx_div([1,0],cplx_sin(t))}function cplx_cot(t){return cplx_div(cplx_cos(t),cplx_sin(t))}function cplx_sinh(t){return[Math.sinh(t[0])*Math.cos(t[1]),Math.cosh(t[0])*Math.sin(t[1])]}function cplx_cosh(t){return[Math.cosh(t[0])*Math.cos(t[1]),Math.sinh(t[0])*Math.sin(t[1])]}function cplx_tanh(t){return cplx_div(cplx_sinh(t),cplx_cosh(t))}function cplx_sech(t){return cplx_div([1,0],cplx_cosh(t))}function cplx_csch(t){return cplx_div([1,0],cplx_sinh(t))}function cplx_coth(t){return cplx_div(cplx_cosh(t),cplx_sinh(t))}function cplx_asin(t){var r=[t[0]*t[0]-t[1]*t[1],2*t[0]*t[1]],e=cplx_nthroot([1-r[0],-1*r[1]],2),a=cplx_log([e[0]-t[1],e[1]+t[0]]);return[a[1],-1*a[0]]}function cplx_acos(t){var r=[t[0]*t[0]-t[1]*t[1],2*t[0]*t[1]],e=cplx_nthroot([r[0]-1,r[1]],2),a=cplx_log([e[0]+t[0],e[1]+t[1]]);return[a[1],-1*a[0]]}function cplx_atan(t){var r=cplx_log(cplx_div([-1*t[0],1-t[1]],[t[0],1+t[1]]));return[2*r[1],-2*r[0]]}function cplx_asinh(t){var r=cplx_sqrt([t[0]*t[0]-t[1]*t[1]+1,2*t[0]*t[1]]);return cplx_log([t[0]+r[0],t[1]+r[1]])}function cplx_acosh(t){var r=cplx_sqrt([t[0]*t[0]-t[1]*t[1]-1,2*t[0]*t[1]]);return cplx_log([t[0]+r[0],t[1]+r[1]])}function cplx_atanh(t){return cplx_mult([.5,1],cplx_log(cplx_div([1+t[0],t[1]],[1-t[0],-1*t[1]])))}function cplx_asec(t){var r=[t[0]*t[0]-t[1]*t[1],2*t[0]*t[1]],e=cplx_nthroot([1-r[0],-1*r[1]],2),a=cplx_log(cplx_div([1+e[0],e[1]],t));return[a[1],-1*a[0]]}function cplx_acsc(t){var r=[t[0]*t[0]-t[1]*t[1],2*t[0]*t[1]],e=cplx_nthroot([r[0]-1,r[1]],2),a=cplx_log(cplx_div([e[0],1+e[1]],t));return[a[1],-1*a[0]]}function cplx_acot(t){var r=cplx_log(cplx_div([t[0],t[1]+1],[t[0],t[1]-1]));return[2*r[1],-2*r[0]]}function cplx_asech(t){return cplx_acosh(cplx_div([1,0],t))}function cplx_acsch(t){return cplx_asinh(cplx_div([1,0],t))}function cplx_acoth(t){return cplx_mult([.5,1],cplx_log(cplx_div([t[0]+1,t[1]],[t[0]-1,t[1]])))}function cplx_factorial(t){if(0===t[1])return[factorial(t[0]),0];throw new Error("Complex factorial not fully implemented")}function cplx_funcvar(t,r){return Array.isArray(t)||(t=[t,0]),Array.isArray(r)||(r=[r,0]),cplx_mult(r,cplx_sin([r[0]+t[0],r[1]+t[1]]))}MathParser.prototype.initializeOperators=function(){var t=this;this.operators={"+":{precedence:11,assoc:"left",evalfunc:function(r,e){return t.docomplex?[r[0]+e[0],r[1]+e[1]]:r+e}},"-":{precedence:11,assoc:"left",evalfunc:function(r,e){return t.docomplex?[r[0]-e[0],r[1]-e[1]]:r-e}},"*":{precedence:12,assoc:"left",evalfunc:function(r,e){return t.docomplex?[r[0]*e[0]-r[1]*e[1],r[0]*e[1]+r[1]*e[0]]:r*e}},"/":{precedence:12,assoc:"left",evalfunc:function(r,e){if(t.docomplex){if(Math.abs(e[0])<1e-50&&Math.abs(e[1])<1e-50)throw new Error("Division by zero");var a=e[0]*e[0]+e[1]*e[1];return[(r[0]*e[0]+r[1]*e[1])/a,(r[1]*e[0]-r[0]*e[1])/a]}if(Math.abs(e)<1e-50)throw new Error("Division by zero");return r/e}},"^":{precedence:18,assoc:"right",evalfunc:function(r,e){if(t.docomplex){if(0===e[1]){var a=safepow(r[0]*r[0]+r[1]*r[1],e[0]/2),n=Math.atan2(r[1],r[0]);return[a*Math.cos(n*e[0]),a*Math.sin(n*e[0])]}var o=Math.atan2(r[1],r[0]),s=(a=safepow(r[0]*r[0]+r[1]*r[1],e[0]/2)*Math.exp(-e[1]*o),e[0]*o+.5*e[1]*Math.log(r[0]*r[0]+r[1]*r[1]));return[a*Math.cos(s),a*Math.sin(s)]}return safepow(r,e)}},"!":{precedence:20,assoc:"right"},"~":{precedence:16,assoc:"left"},not:{precedence:16,assoc:"right"},"&&":{precedence:8,assoc:"left",evalfunc:function(t,r){return t&&r}},"||":{precedence:7,assoc:"left",evalfunc:function(t,r){return t||r}},"#a":{precedence:8,assoc:"right",evalfunc:function(t,r){return t&&r}},"#x":{precedence:7,assoc:"right",evalfunc:function(t,r){return!!(t^r)}},"#o":{precedence:7,assoc:"right",evalfunc:function(t,r){return t||r}},"#m":{precedence:7,assoc:"right",evalfunc:function(t,r){return t&&!r}},"#i":{precedence:6,assoc:"right",evalfunc:function(t,r){return!t||r}},"#b":{precedence:6,assoc:"right",evalfunc:function(t,r){return t&&r||!t&&!r}},"<":{precedence:6,assoc:"left",evalfunc:function(t,r){return t<r?1:0}},">":{precedence:6,assoc:"left",evalfunc:function(t,r){return t>r?1:0}},"<=":{precedence:6,assoc:"left",evalfunc:function(t,r){return t<=r?1:0}},">=":{precedence:6,assoc:"left",evalfunc:function(t,r){return t>=r?1:0}},"(":!0,")":!0}},MathParser.prototype.parse=function(t){return this.origstr=t,t=(t=(t=(t=t.replace(/Math\./g,"")).replace(/(ar|arg)(sinh|cosh|tanh|sech|csch|coth)/g,"arc$2")).replace(/[\\[\]`]/g,"").replace(/[\[\]]/g,"()")).replace(/(?<!\|)\|([^|]+?)\|(?!\|)/g,"abs($1)"),this.tokenize(t),this.handleImplicit(),this.buildTree(),this.AST},MathParser.prototype.evaluate=function(t){void 0===t&&(t={});for(var r=0;r<this.variables.length;r++){var e=this.variables[r];if(!("pi"===e||"e"===e||this.docomplex&&"i"===e)){if(!(e in t))throw new Error("Missing value for variable "+e);if("number"!=typeof t[e])throw new Error("Invalid input value for variable "+e)}}if(this.variableValues=t,0===this.AST.length)return"";let a=this.evalNode(this.AST);return this.docomplex&&!Array.isArray(a)&&(a=[a,0]),a},MathParser.prototype.evaluateQuiet=function(t){try{return this.evaluate(t)}catch(t){return Math.sqrt(-1)}},MathParser.prototype.tokenize=function(t){var r=[],e=(t=t.replace(this.funcregex,(function(t){return t.toLowerCase()}))).length;let a="";for(let h=0;h<e;h++){var n=t[h];if(!/\s/.test(n))if(/[\d.]/.test(n)){let e;if(e=this.allowEscinot?/^(\d*\.?\d*(E[+-]?\d+(?!\.))?)/:/^(\d*\.?\d*)/,"."===(o=t.substr(h).match(e))[1])continue;r.push({type:"number",symbol:parseFloat(o[1])}),a="number",h+=o[1].length-1}else if(-1!==["|","&","#","<",">"].indexOf(n)&&this.operators[t.substr(h,2)])r.push({type:"operator",symbol:t.substr(h,2)}),h++,a="operator";else if(this.operators[n])r.push({type:"operator",symbol:n}),a="operator";else{var o;if(!(o=t.substr(h).match(this.regex)))throw new Error("Don't know how to handle symbol: "+n);var s=o[1];if(-1!==this.funcvariables.indexOf(s)&&h+s.length<t.length&&"("===t[h+s.length]?(r.push({type:"function",symbol:"funcvar",input:null,index:{type:"variable",symbol:s}}),a="function"):-1!==this.variables.indexOf(s)?(r.push({type:"variable",symbol:s}),a="variable"):"div"===s?(r.push({type:"operator",symbol:"/"}),a="operator"):("log"===s?r.push({type:"function",symbol:"log",input:null,index:{type:"number",symbol:10}}):"ln"===s?r.push({type:"function",symbol:"log",input:null,index:{type:"number",symbol:Math.E}}):"degree"===s||"degrees"===s?r.push({type:"number",symbol:Math.PI/180}):r.push({type:"function",symbol:s,input:null}),a="function"),h+=s.length-1,"function"===a&&h<e-2){var c=t[h+1];if("log"===s&&"_"===c)(i=t.substr(h+2).match(this.numvarregex))?(r[r.length-1].index={type:isNaN(i[1])?"variable":"number",symbol:i[1]},h+=i[1].length+1):"("===t[h+2]&&(r[r.length-1].symbol+="_",h+=1);else if("^"===c){(i=t.substr(h+2).match(/^(-?\d+|\((-?\d+)\))/))&&(r[r.length-1].symbol+="^"+(i[2]||i[1]),h+=i[1].length+1)}else if("root"===s)if("("===c)r[r.length-1].symbol+="(";else{var i;if(!(i=t.substr(h+1).match(/^[\(\[]*(-?\d+)[\)\]]*/)))throw new Error("Invalid root index");r[r.length-1]={type:"function",symbol:"nthroot",input:null,index:{type:"number",symbol:parseInt(i[1])}},h+=i[0].length}}}}return this.tokens=r,r},MathParser.prototype.handleImplicit=function(){var t=[];let r={type:"",symbol:""};for(var e=0;e<this.tokens.length;e++){var a=this.tokens[e];"number"!==r.type&&"variable"!==r.type&&"!"!==r.symbol&&")"!==r.symbol||"number"!==a.type&&"variable"!==a.type&&"function"!==a.type&&"("!==a.symbol?"function"===r.type&&"("!==a.symbol?(t.push({type:"operator",symbol:"("}),t.push(a),t.push({type:"operator",symbol:")"})):t.push(a):(t.push({type:"operator",symbol:"*"}),t.push(a)),r=a}this.tokens=t},MathParser.prototype.buildTree=function(){this.operatorStack=[],this.operandStack=[];let t=null;for(let i=0;i<this.tokens.length;i++){var r=this.tokens[i];if(")"===r.symbol)this.handleSubExpression(i);else if("number"===r.type||"variable"===r.type)this.operandStack.push(r);else if("function"===r.type)this.operatorStack.push(r);else if("("===r.symbol)this.operatorStack.push(r);else if("!"===r.symbol){if(this.isUnary(r,t))r.symbol="not",this.operatorStack.push(r),i+1<this.tokens.length&&"*"===this.tokens[i+1].symbol&&this.tokens.splice(i+1,1);else{if(0===this.operandStack.length)throw new Error("Syntax error: ! without something to apply it to");var e=this.operandStack.pop();this.operandStack.push({type:"function",symbol:"factorial",input:e})}}else if("operator"===r.type){if(this.isUnary(r,t))"+"===r.symbol?(r.type="",r.symbol=""):"-"===r.symbol&&(r.symbol="~");else for(;this.operatorStack.length>0;){var a=this.operatorStack[this.operatorStack.length-1],n=this.operators[a.symbol],o=this.operators[r.symbol];if("boolean"==typeof n||"boolean"==typeof o)break;if(!(o.precedence<n.precedence||o.precedence===n.precedence&&"left"===o.assoc))break;var s=this.operatorStack.pop(),c=this.handleExpression(s);this.operandStack.push(c)}""!==r.symbol&&this.operatorStack.push(r)}""!==r.symbol&&(t=r)}for(;this.operatorStack.length>0;){s=this.operatorStack.pop(),c=this.handleExpression(s);this.operandStack.push(c)}if(this.operandStack.length>1)throw new Error("Syntax error - expression didn't terminate");this.AST=this.operandStack.pop()},MathParser.prototype.isUnary=function(t,r){return-1!==["-","+","!"].indexOf(t.symbol)&&(0===this.operandStack.length&&0===this.operatorStack.length||"operator"===r.type&&")"!==r.symbol&&"!"!==r.symbol)},MathParser.prototype.handleExpression=function(t){if("function"===t.type||"("===t.symbol)throw new Error("Syntax error - parentheses mismatch");if("~"===t.symbol||"not"===t.symbol){if(void 0===(r=this.operandStack.pop()))throw new Error("Syntax error - unary negative with nothing following");return t.left=r,t}var r,e=this.operandStack.pop();if(void 0===(r=this.operandStack.pop())||void 0===e)throw new Error("Syntax error");return t.left=r,t.right=e,t},MathParser.prototype.handleSubExpression=function(t){let r,e=!1;for(;r=this.operatorStack.pop();){if("("===r.symbol){e=!0;break}var a=this.handleExpression(r);this.operandStack.push(a)}if(!e)throw new Error("Syntax error - parentheses mismatch");if(this.operatorStack.length>0&&"function"===this.operatorStack[this.operatorStack.length-1].type){a=this.operatorStack.pop();var n=this.operandStack.pop();if("log_"===a.symbol){if(void 0===n)throw new Error("Syntax error - missing index");return a.symbol="log",a.index=n,this.operatorStack.push(a),void(t+1<this.tokens.length&&"*"===this.tokens[t+1].symbol&&this.tokens.splice(t+1,1))}if("root("===a.symbol){if(void 0===n)throw new Error("Syntax error - missing index");return a.symbol="nthroot",a.index=n,this.operatorStack.push(a),void(t+1<this.tokens.length&&"*"===this.tokens[t+1].symbol&&this.tokens.splice(t+1,1))}if(void 0===n)throw new Error("Syntax error - missing function input");if(a.input=n,-1!==a.symbol.indexOf("^")){var o=a.symbol.split("^"),s=o[0],c=o[1];if("-1"!==c||!window["a"+s]&&!Math["a"+s]){a.symbol=s;var i={type:"operator",symbol:"^",left:a,right:{type:"number",symbol:parseInt(c)}};return void this.operandStack.push(i)}a.symbol="arc"+s}this.operandStack.push(a)}},MathParser.prototype.evalNode=function(t){if(!t)throw new Error("Cannot evaluate an empty expression");if("number"===t.type)return this.docomplex?Array.isArray(t.symbol)?[parseFloat(t.symbol[0]),parseFloat(t.symbol[1])]:[parseFloat(t.symbol),0]:parseFloat(t.symbol);if("variable"===t.type){if(t.symbol in this.variableValues)return this.docomplex&&"number"==typeof this.variableValues[t.symbol]?[parseFloat(this.variableValues[t.symbol]),0]:this.variableValues[t.symbol];if("pi"===t.symbol)return this.docomplex?[Math.PI,0]:Math.PI;if("e"===t.symbol)return this.docomplex?[Math.E,0]:Math.E;if(this.docomplex&&"i"===t.symbol)return[0,1];throw new Error("Variable found without a provided value")}if("function"===t.type){var r=this.evalNode(t.input);let a;t.index&&(a=this.evalNode(t.index));let n=t.symbol;if(!this.docomplex)switch(n){case"sqrt":if(r<0)throw new Error("Invalid input to "+n);break;case"log":if(r<=0)throw new Error("Invalid input to "+n);if(a<=0)throw new Error("Invalid base to "+n);break;case"arcsin":case"arccos":var e=Math.round(1e12*r)/1e12;if(e<-1||e>1)throw new Error("Invalid input to "+n);break;case"factorial":if(Math.round(r)!==Math.floor(r)||r<0)throw new Error("invalid factorial input "+r);if(r>150)throw new Error("too big of factorial input "+r)}return n=n.replace("arc","a"),this.docomplex&&(n="cplx_"+n,Array.isArray(r)||(r=[r,0])),t.index?this.callFunction(n,r,a):this.callFunction(n,r)}if("~"===t.symbol){if(this.docomplex){var a=this.evalNode(t.left);return Array.isArray(a)?[-1*a[0],-1*a[1]]:-1*a}return-1*this.evalNode(t.left)}if("not"===t.symbol)return!this.evalNode(t.left);if(this.operators[t.symbol])return(0,this.operators[t.symbol].evalfunc)(this.evalNode(t.left),this.evalNode(t.right));throw new Error("Syntax error")},MathParser.prototype.callFunction=function(t){var r=null;if(-1!==["sqrt","sin","cos","tan","asin","acos","atan","sinh","cosh","tanh","asinh","acosh","atanh","exp","abs","sign"].indexOf(t)?r=Math[t]:-1!==["factorial","nthroot","sec","csc","cot","asec","acsc","acot","sech","csch","coth","asech","acsch","acoth","funcvar","cplx_sqrt","cplx_sin","cplx_cos","cplx_tan","cplx_log","cplx_exp","cplx_abs","cplx_asin","cplx_acos","cplx_atan","cplx_sinh","cplx_cosh","cplx_tanh","cplx_asinh","cplx_acosh","cplx_atanh","cplx_sec","cplx_csc","cplx_cot","cplx_sech","cplx_csch","cplx_coth","cplx_asec","cplx_acsc","cplx_acot","cplx_asech","cplx_acsch","cplx_acoth","cplx_nthroot","cplx_factorial","cplx_funcvar"].indexOf(t)?r=window[t]:"log"===t?r=function(t,r){return r=void 0===r?Math.E:r,Math.log(t)/Math.log(r)}:"ln"===t&&(r=Math.log),null!==r){let t=[];return arguments.length>1&&(t=Array.prototype.slice.call(arguments,1)),r.apply(null,t)}throw new Error("Unknown function: "+t)},MathParser.prototype.isMultiple=function(t,r){if(0===r)return!1;var e=Math.abs(t)/Math.abs(r);return Math.abs(Math.floor(e+1e-10)-e)<1e-8},Math.sinh||(Math.sinh=function(t){return(Math.exp(t)-Math.exp(-t))/2}),Math.cosh||(Math.cosh=function(t){return(Math.exp(t)+Math.exp(-t))/2}),Math.tanh||(Math.tanh=function(t){if(t===1/0)return 1;if(t===-1/0)return-1;var r=Math.exp(t),e=Math.exp(-t);return(r-e)/(r+e)}),Math.asinh||(Math.asinh=function(t){return Math.log(t+Math.sqrt(t*t+1))}),Math.acosh||(Math.acosh=function(t){return t<1?NaN:Math.log(t+Math.sqrt(t*t-1))}),Math.atanh||(Math.atanh=function(t){return t<=-1||t>=1?NaN:.5*Math.log((1+t)/(1-t))});var pi=Math.PI,ln=Math.log,e=Math.E,arcsin=Math.asin,arccos=Math.acos,arctan=Math.atan,funcstoindexarr="sinh|cosh|tanh|sech|csch|coth|sqrt|ln|log|exp|sin|cos|tan|sec|csc|cot|abs|root|arcsin|arccos|arctan|arcsec|arccsc|arccot|arcsinh|arccosh|arctanh|arcsech|arccsch|arccoth|argsinh|argcosh|argtanh|argsech|argcsch|argcoth|arsinh|arcosh|artanh|arsech|arcsch|arcoth|pi".split("|");function functoindex(t){for(var r=0;r<funcstoindexarr.length;r++)if(funcstoindexarr[r]==t)return"@"+r+"@";return t}function indextofunc(t,r){return funcstoindexarr[r]}function matchtolower(t){return t.toLowerCase()}function mathjs(t){var r,e,a,n,o,s;for(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/(\+\s*-|-\s*\+)/g,"-").replace(/-\s*-/g,"+")).replace(/\[/g,"(").replace(/\]/g,")")).replace(/\b00+\./g,"0.")).replace(/root\s*(\d+)/,"root($1)")).replace(/\|(.*?)\|/g,"abs($1)")).replace(/(Sin|Cos|Tan|Sec|Csc|Cot|Arc|Abs|Log|Exp|Ln|Sqrt)/gi,matchtolower)).replace(/pi/g,"(pi)")).replace(/([0-9])E([\-0-9])/g,"$1(EE)$2")).replace(/\*?\s*degrees?/g,"*((pi)/180)")).replace(/div/,"/")).replace(/e/g,"(E)")).replace(/log_([a-zA-Z\d\.]+|\(([a-zA-Z\/\d\.]+)\))\s*\(/g,"nthlog($1,")).replace(/log/g,"logten")).replace(/(sin|cos|tan|sec|csc|cot|sinh|cosh|tanh|sech|csch|coth)\^(-1|\(-1\))/g,"arc$1")).replace(/(sin|cos|tan|sec|csc|cot|ln)\^(\d+|\(\d+\))\s*\(/g,"$1n($2,")).replace(/root\s*\(([a-zA-Z\/\d\.]+)\)\s*\(/g,"nthroot(($1),")).replace(/([0-9]\.?)\s+([0-9])/g,"$1*$2")).replace(/#/g,"")).replace(/\s/g,"")).replace(/([0-9]\.?)([\(a-zA-Z])/g,"$1*$2")).replace(/(!)([0-9\(a-zA-Z])/g,"$1*$2")).replace(/\)([\(0-9a-zA-Z]|\.\d+)/g,")*$1")).replace(/([0-9])\*\(EE\)\*?([\-0-9])/g,"$1e$2");-1!=(r=t.lastIndexOf("^"));){if(0==r)return"Error: missing argument";if(e=r-1,(n=t.charAt(e))>="0"&&n<="9"||"."==n){for(e--;e>=0&&(n=t.charAt(e))>="0"&&n<="9";)e--;if("."==n)for(e--;e>=0&&(n=t.charAt(e))>="0"&&n<="9";)e--}else if(")"==n){for(s=1,e--;e>=0&&s>0;)"("==(n=t.charAt(e))?s--:")"==n&&s++,e--;for(;e>=0&&((n=t.charAt(e))>="a"&&n<="z"||n>="A"&&n<="Z");)e--}else{if(!(n>="a"&&n<="z"||n>="A"&&n<="Z"))return"Error: incorrect syntax in "+t+" at position "+e;for(e--;e>=0&&((n=t.charAt(e))>="a"&&n<="z"||n>="A"&&n<="Z");)e--}if(r==t.length-1)return"Error: missing argument";if(a=r+1,n=t.charAt(a),o=t.charAt(a+1),n>="0"&&n<="9"||"-"==n&&"("!=o||"."==n){for(a++;a<t.length&&(n=t.charAt(a))>="0"&&n<="9";)a++;if("."==n)for(a++;a<t.length&&(n=t.charAt(a))>="0"&&n<="9";)a++}else if("("==n||"-"==n&&"("==o)for("-"==n&&a++,s=1,a++;a<t.length&&s>0;)"("==(n=t.charAt(a))?s++:")"==n&&s--,a++;else{if(!(n>="a"&&n<="z"||n>="A"&&n<="Z"))return"Error: incorrect syntax in "+t+" at position "+a;for(a++;a<t.length&&((n=t.charAt(a))>="a"&&n<="z"||n>="A"&&n<="Z");)a++;if("("==n&&t.slice(r+1,a).match(/^(sinn|cosn|tann|secn|cscn|cotn|sin|cos|tan|sec|csc|cot|logten|nthlogten|log|ln|exp|arcsin|arccos|arctan|arcsec|arccsc|arccot|sinh|cosh|tanh|sech|csch|coth|arcsinh|arccosh|arctanh|arcsech|arccsch|arccoth|sqrt|abs|nthroot|factorial|safepow)$/))for(s=1,a++;a<t.length&&s>0;)"("==(n=t.charAt(a))?s++:")"==n&&s--,a++}t=t.slice(0,e+1)+"safepow("+t.slice(e+1,r)+","+t.slice(r+1,a)+")"+t.slice(a)}return t}